<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="zh" >
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Teamcenter学习" />
<meta property="og:locale" content="zh" />
<meta name="description" content="Teamcenter笔记 概述 客户端定制 服务端定制 第一章 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item Item Revision 动态类型 Relations 修改Item/Item Recision 属性及属性分类 Dataset Model Form Model 第三章 3.1客户端开发技术 3.11AWT &amp; Java Swing RCP的概念 透视图 perspective 视图 View 3.2Teamcenter插件开发 对插件程序的注册方法: . 3.3TC开发环境搭建 创建TC插件项目 配置反编译环境 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp com.teamcenter.rac .common com.teamcenter.rac.external com.teamcenter.rac .kernal com.teamcenter.rac.tcapps 任务要求: 3.5TCSession的使用 获取TCSession的三种办法 从当前应用程序直接获取TC Session 从TCComponent对象上获取TC Session 通过ISessionService获取到TCSession 获取当前TC信息 设置当前用户 DBA用户旁路功能打开 获取Type 获取Service服务 3.6创建TC对象 TCAPI接口 Folder Form的创建: Item的创建: item _ID和item Revision获取方法: Item单位获取方法 Item创建方法 Dataset的创建方法 查询构建器的调用 Teamcenter中BOM结构的构建 获取版本规则 创建BOMWi ndow 获取BOMLine的两种方法 添加对象到BOMLine Java调用c的方法 第四章 菜单定制 Teamcenter主菜单 上下文菜单 视图/编辑器菜单 工具栏按钮 菜单扩展点 菜单项扩展点 locationURI语法规则 主菜单定义 上下文菜单 菜单显示/隐藏控制方法 实践练习一： 实践练习二： 实例 工具栏toolbar 菜单栏中添加一个新的菜单 在右键上添加 视图 退出 综合 第五章 5.1.1无代码化定制 5.2 无代码化定制应用 5.2.2 首选项 5.2.3访问权限管理 第六章 6.1.3 为什么需要报表开发 6.1.4 TC报表生成方式 Teamcenter笔记 概述 Teamcenter的标准功能基本可以供用户使用，但是基于每家公司业务问题以及使用习惯，还有一些特殊的应用与数据整合，所以会产生不同的业务需求，这个时候我们就需要通过客户化定制的方式去满足用户的应用。通过对TC系统的二次开发来实现客户化。 客户端定制 通过个性化定制让用户操作更加方便，提高用户的操作效率。比如一些对话框、操作界面等的定制，数据显示与表单定制，可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 数据显示与表单定制：可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 服务端定制 应用集成： 使用集成工具包（ITK）或服务（Teamcenter Service）进行定制，改变Teamcenter与外部应用集成时行为（behavior）。比如前处理，后处理，SOA接口，ITK函数，Handler等。 数据共享 通过定制开发可以使Teamcenter系统中的一些数据与别的系统共享，或者Teamcenter共享别的系统中数据，比较典型的有报表、CAD集成ERP集成、CAPP集成等。 第一章 1）查看\设置 TC命令行 1 2 3 set TC_ROOT=D:\Siemens\Teamcenter10 set TC_Data=D:\Siemens\tcdata call D:\Siemens\tcdata\tc_profilevars.bat 2）运行TC命令： 清除TC死进程 clearlocks -verbose 列出所有登录到TC的用户 list_users –u=infodba –p=infodba 获取TC版本信息 install -ask_version 导出某个Item到本地文件夹中 tcxml_export -u=infodba -p=infodba -file=D:\output.xml -item=000034 -rev=A -floder=Home 文件卷信息备份 backup_xmlinfo -u=infodba -p=infodba -g=dba 3）查看TC环境变量 ： set TC 实践练习2： 1）运行TC命令： （1）导出原始或旧的CAD属性映射文件 export_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt （2）导入原始或旧的CAD属性映射文件 import_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt 实践练习3： 1）运行TC命令： （1）游离数据收集命令： collect_garbage -u=infodba -p=infodba -g=dba -item -dataset -floder -report （2）删除WASTE BASKET文件夹下所有没有引用的对象 collect_garbage -u=infodba -p=infodba -g=dba -all –delete 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item |tem Revision 动态类型 Relation 属性及属性分类 Teamcenter对象模型由管理数据的类组成 模型可描述成两个基本关系集图 继承关系 关联关系 对象模型原理 Item and Item Revision Model Dataset Model Form Model System Administration Model Product structure object Model Access control Model Application encapsulation M lodel POM persistent Object Manager POM是Teamcenter的核心模块，是应用模块与系统模块的接口，是一个提供内部程序员、第三方以及客户定义他们自己业务对象(business object) 的工具。 系统模块通常是用0DBC访问0racle关系数据库或MS SQL Server POM提供应用程序与系统模块比关系数据库表更高层次的抽象(如创建文件夹)，可以创建、存取他们自己的数据以及存取简单的TC数据 可以通过BMIDE (Bus iness Modeler IDE) 创建业务对象，而不是直接编辑表或写代码，提供了数据的面向对象浏览器，而不是SQL 表达式。 Item Item是TC中管理信息的最基本的对象，提供了用于组织信息、审计/变更控制的物理或概念上的实体。表示真实世界中的一个产品、部件或零件对象等，例如发动机总成、支架等。 ltem有以下基本信息: Item ID (必须唯一,可以是流水码) |tem Name Item type Unitof Measure (Optional) 。 Description 最多240个字符 其中Bus inessOb ject是所有类的基类，再往下是两个分支: POM_ object带有存储类的业务类 Runt imeBusinessOb ect动态类型 Item类型是选择客户化继承类的首选基类。在Item这个视图下，有:存储类、父类、版本类、表单这四项。这里主要解释的是存储类。规则为:每个业务对象，都有一个存储类与之对应。另外同时注意:不同的业务对象可以共同对应于一个存储类。 Item Revision Item Revision用于记录Item的历史 |tem Revision信息 ID Item的唯一 标识 Revision Name . 动态类型 例如: BOML ine它实际是从种存储类.上获取属性从而计算得到的。其中包括PSOccur rence,Note，Item，ItemRev等等 属性可以加载到结构管理器。 Relations TC用Re | at i on来关联数据的Item和Item Revision ReIation描述了数据是怎样与Item和Ite Revision关联的 例:一个Dataset包含了CAD模型，这个模型由某个ItemRevisi on说明 例:一个标准文档描述了一个Item所需要特定草图的填充表单和功能 Item和ltem Revis ion可以与其他一些对象有关，包括Datasets，Forms， Fo Iders以及其他的Item和Item Revision . 每个与Item关联的对象表示了该ltem的各个方面信息 TC提供了基本的关系集，对象与Item、Item Revision之间的关系取决于所执行的规则 master_ Form 关联Form与Item或Item Revision Form是Item或Item Revis ion的属性(Attr ibutes) 集合 关系规则 Item或Item Revis ion必须要有对Form添加、删除master_ Form关系的权限 一个Form与一个Item或Item Revision只能有一个master_ Form关系 一个Form的master_ Form关系只能对应一个Item或Item Revision TC提供了基本的关系集，对象与ltem、Item Revision之间的关系取决于所执行的规则 requirement 关联data与Item或Item Revision (如:草图的标准、Part的技术需求) 关系规则 Item或Item Revis ion必须要有对一个对象添加、删除requirement关系的权限 Form与Item或Item Revis ion可以有一个requi rement关系 只有Dataset的0版本可以与Item或Item Revis i on有requi rement关系 Folder、 enve | ope、 BOM vi ew或BOM Revis i on不能与Item或ItemRevision有requirement关系 一个Item不能另外的Item或Item Revis ion有requi rement关系 一个Item Revis i on可以与另外的Item或Item Revis ion有requirement关系 一个Item Revision不能与另外的同- -个Item的Item Revision有requi rement关系 manifestation关联与Item或Item Revis ion相关其他数据 specification关联定义Item Revis ion的数据 reference关联数据与Item或Item Revision Revision关联Item Revis ion与相应的Item BOMView关联产品结构与Item BOMView Revision关联产品结构Revision与Item Revision 修改Item/Item Recision 当Item被创建时就有了ID 只有对Item添加了数据，Item才有意义 数据集(Dataset)用于其他应用中创建的信息，这些数据可以与Item和Item Revision关联 在TC中，ItemRevision和Datasetversion都可以表示修改信息 Item Revis ion表示Item的明显变化 Dataset vers ion表示每天的变化 修改Item、 Item Revis i on的方法 通过cut、paste方法添加或移除Item与Item Revision的关系 修改与Item和ItemRevision相关的对象的内容 属性及属性分类 类定义了对象的类型(type of object) 、属性(Attr ibutes)和方法(methods) 在TC中，Attr ibute可以是: Integer， Float，Boolean， String,Date，Tag,Array Tag唯一标识Reference和Relation Attribute具有以下特性: Unique Protected:属性只能由创建该对象的应用修改 NULLallowed：如果这个特性不为true的话，对象不能保存 Upper bound (.上边界) Lower bound (下边界) Default value (默认值) 永久 该类型的属性会在数据库中对应一条记录上的一个字段，从而得以保存 运行时 一顾名思义，只是运行时动态的属性，需要配合程序计算获得。 复合 复合属性，如不清楚可以 查看BMI DE使用帮助 关系 从TC8开始关系首先需要定义为属性。 TC2007是不需要的，只用首选项配置。 其他对象模型 Dataset Model 每个产品对象均有一些具体的数据文件来描述其不同方面的详细信息，如设计模型、计算说明、设计要求等。这些数据文件是由不同的应用软件产生的( 如CAD软件、0ffice软件等)，具有不同的表现形式(如Text文件、图形文件等)。 Teamcenter的Dataset (数据集)提供了管理各类应用软件所产生的文件的手段。不管是技术说明文件或CAD / CAM / CAE系统产生的图形数据文件，都可以用原来的形式或点阵形式或其它任何计算机形式的文件存放在Teamcenter系统中。 Dataset是用来管理(存放)应用软件生成的数据(文件)的-种对象。对应于不同类型(格式)的数据(文件)，Teamcenter 提供Dataset Type与之对应。 业务对象是用于详细说明TC对象的行为的 Dataset业务对象用于对Dataset分类 例:当Document Dataset数据打开时， 与该对象关联的WORD处理程序打开 当创建数据集时，会创建0和1两个版本，Revision 0总是指向最新的版本，所以最初时它指向Revision 1。如果创建了Revision 2,Revision 0就指向2。在编程时，如果希望获得最新的版本，就用Revision 0。 所有Dataset的版本都有相同的所有者(owning user)、组(group) 和保护(protect ion)机制。 ITK functions use this convention with R evisions asfollows: 1 AE_ask_dataset Given any dataset, returns Revision 0. AE_ask_dataset_first_rev Given any dataset, returns the oldest Revision. 1 AE_ask_dataset_latest_rev Given any dataset, returns the most recent Revision (nothe Revision 0 copy). Given any dataset, returns the most recent evision (nothe Revision 0 copy). 1 AE_ask_dataset_next_rev Given any dataset, returns the next Revision 1n the sequence. 1 AE_ask_dataset_prev_rev Given any dataset, returns the previous Revision in the sequence 1 AE_find_dataset (&quot;name&quot;, &amp;Dataset) Finds Revision 0 of the Dataset. 1 AOM_refresh(dataset, true) Loads the given Dataset version for modification. 1 AOM_save(dataset) Creates a new, later version of the Dataset and saves a copy to Revision 0. Form Model Form能存储用户定义的属性(Attr ibute), TC提供了标准Form模型。Form是POM对象，可以使用Form |TK函数存取Attr ibute 所有的POM_ appl icat ion_ _ob ject类和它的子类都有所有者和保护机制，只能被系统管理员修改 ACL (Access control | ist)实体由对组和/或用户以及子对象授权的引用组成。 子对象是TC中可以被授权的对象。 Teamcenter软件系统版本历史如下: Teamcenter Enterprise 4.0 Teamcenter Enterprise 5.0 Teamcenter Engineering 9.0 2005年: Teamcenter Engineering 2005 2007年: Teamcenter 2007 2009年:Teamcenter 8 2012年: Teamcenter 9 201 3年: Teamcenter10 201 6年:Teamcenter11 201 8年:Teamcenter1 2 第三章 3.1客户端开发技术 Teamcenter 胖客户端基于客户端-服务器架构模式，客户端和服务器层均可以定制开发。胖客户端具有UI界面，使用Java语言进行构建与定制。服务器端使用Integration Toolkit (ITK) 和 C/C++ 编程语言进行开发。 因为胖客户端基于Eclipse平台，开发时可以获取所有扩展点，作为Teamcenter 开发定制技术，可以使用如下三种方式定制客户端： 1 2 3 Base Eclipse extension points and services (使用org.eclipse.ui.menus extension point). Teamcenter extension points and services (使用application extension points). Teamcenter customization mechanisms (使用style sheets). 基础定制技术用于在客户端创建具有用户界面的插件，并加以显示，需要熟练掌握Eclipse。 Teamcenter 提供几种界面，包括： 胖客户端界面； 基于Web的瘦客户端界面； 业务建模器； Teamcenter集成Microsoft Office； Teamcenter集成CAX，ERP等 因为胖客户端与瘦客户端接口开放了定制方法，仅提供此两种开发方式。 随着Teamcenter软件的发展和进步，利用新技术，尽可能灵活和简单化Teamcenter扩展和定制的能力。 Back and Forward buttons Application banner Search box Navigation pane Application pane Getting Started application button. Primary applications Secondary applications Clipboard button 3.11AWT &amp; Java Swing Abstract Windows Toolkit（AWT）是最原始的、具有有限 GUI 组件、布局管理和函数功能的工具包。AWT的主要优点是，它在 Java 技术的每个版本上都成为了一种标准配置，包括早期的 Web 浏览器中的 Java 实现。另外它也非常稳定，可以在任何一个以Java为基础的环境中运行使用。 AWT中包含了许多类和接口，用于Java Application的GUI编程。通过图形用户界面用户和程序之间可以方便地进行交互。 ava的抽象窗口工具包AWT由Java的java.awt包提供，该包中有许多用来设计GUI的组件类，如：按钮、菜单、列表、文本框等组件类，同事它还包含窗口、面板等容器类。 ava Swing是Java Foundation Classes（JFC）的一部分，它是在 AWT 组件基础上构建的，所有 Swing组件实际上也是 AWT 的一部分。在Swing 中，Sun 开发了一个经过仔细设计的、灵活而强大的 GUI工具包。 Swing 具有内嵌于Java 技术的优点，可完全移植的。Swing 也具有高级图形应用程序所需要的优点。SWT 具有可以作为本地应用程序实现的优点，这可以提高性能，并利用基于SWT 的GUI 来实现本地兼容性。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing与结合了JFace的SWT一起构建GUI。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing 与结合了JFace 的SWT 一起构建GUI。 Standard Widget Toolkit (SWT)，即标准部件工具包。它是一个Java平台下开放源码的Native GUI组件库，也是Eclipse平台的UI组件之一。如果只为一种平台来开发系统，那么SWT 就具有主机兼容性方面的优点，包括与主机特性的集成，例如在Windows 上对ActiveX控件的使用。 Teamcenter2007以上都是采用SWT与Swing结合进行客户端构建的。 与 AWT 的概念相比，SWT 是一个低级的 GUI 工具包。JFace是一组用来简化使用SWT构建GUI的增强组件和工具服务。SWT的创建者为了建立一个只有两者的有点而没有缺点的系统，从AWT和Swing的实践中吸取了大量的经验。从很多方面来说，他们已经成功了。SWT 的 GUI 既具有主机外观，又具有主机的性能。这样就避免了使用 AWT 和 Swing 而引起的大部分问题。特定的主机具有一些低级功能控件，因此 SWT 提供了扩充版本，从而可以产生更一致的行为。 RCP的概念 RCP是Rich Client Platform的缩写，利用Eclipse核心平台和一些有用的插件，进行应用系统的构建。只要新的代码符合插件的代码结构，将代码放入工作空间后，Eclipse平台会自动加载新代码，构成新的Eclipse平台。 Eclipse RCP 提供了标准化的组件模型，包括菜单，工具栏，以及可叠加的窗口组件(编辑器和视图)、按钮、表格、树形结构的支持。 Eclipse RCP的优点 组件化：基于Eclipse的系统设计由被称为plug-ins的插件构成，可以通过扩展点进行配置，也可以被不同应用程序共享。 便利性:Eclipse RCP对各个平台下的产品包装提供了强有力的支持，其开发的RCP甚至可以在嵌入式设备、掌上电脑上运行。Sun公司对Java的口号是write once，run everywhere，Eclipse也可以说是RCP run everywhere。 智能安装和升级：Eclipse提供了专门的Update组件，可以实现通过HTTP、Web站点、复制等多种方式进行安装和更新，避免了早期胖客户端应用、部署升级的麻烦。 可扩展性：Eclipse基于插件进行扩展的思想使得用户可以方便地搭建各种规模、类型和用途的应用程序。按照Eclipse官方的说法，Eclipse RCP一开始就被设计为可扩展的。 使用体验：Eclipse为各种操作系统提供了本地图形接口包。当RCP运行时，Eclipse首先直接调用本机窗口组件，只有没有本机所需组件时才进行模拟。无论RCP在哪种操作系统上运行，都可以保持与本机一致的外观和行为。一个设计优良的富客户端，可以提供诸如拖曳操作、剪切板、导航等 UI元素。UI设计者也可以利用各种界面工具，轻松设计出完美的用户界面。 CP中的每个视图都对应程序中的UI界面。每个透视图对应一个应用组合，如在Teamcenter中 ：我的Teamcenter、结构管理器、分类管理等。下图是以Teamcenter系统为例展示RCP应用程序运行的界面： 透视图 perspective 一个客户端可以运行多个透视图，但每次在界面中只显示一个透视图；在一个透视图中可以添加和重新排列视图，以在透视图中同时显示多个信息集；可以保存重排的透视图，并使用当前名字，也可以为新的排列创建一个新名字。系统管理员可以使用 HiddenPerspectives 首选项来显示/隐藏各个透视图功能。 视图 View 视图中相关工作改变通常会对其他视图中的选项更改；视图中数据的更改会立即保存；视图在透视图中可以便捷的加载，当前透视图中的视图排列可以存储到本透视图，或者新创建的透视图中。 3.2Teamcenter插件开发 Eclipse的设计思想是:一切皆插件。Eclipse核心很小，其它所有功能都以插件的形式附加于Eclipse核心之上。Eclipse基 本内核包括:图形API (SWT/Jface)，Java开 发环境插件(JDT ),插件开发环境(PDE), JDT与PDE构成了Platform run-time。 Teamcenter胖客户端宿主于Eclipse胖客户端平台框架。RCP是一个通用的应用程序框架，通过使用插件，提供了模块化和基于可扩展的组件开发的支持。 PDE和Java Deve lopment Tooling (JDT) IDE 是Eclipse的标准扩展。PDE提供了一些向导以帮助创建插件。 Workbench和Workspace是 Eclipse平台的两个必备的插件它们. 提供了大多数插件使用的扩展点。插件需要添加到扩展点才可以运行。Workbench组件包含了一些扩展点，允许插件扩展Eclipse 用户界面，使这些用户界面带有菜单选择和工具栏按钮;请求不同类型事件的通知;以及创 建新视图。Workspace 组件包含了可以与资源(包括项目和文件)交互的扩展点。 除了Workbench和Workspace，其它插件也可以扩展Eclipse组件。Debug组件可以让插件启动程序、与正在运行的程序交互，以及处理错误Team组件允许Eclipse 资源与版本控制系统(VCS) 交互，构建VCS的Eclipse客户机时，Team 组件就象Debug组件一样，会扩展或增强Eclipse的功能。Help组件可以提供应用程序的联机文档和与上下文的帮助。 一个插件(p lug- in)是Ec lipse平台中的最小功能单元，可以进行独立的开发和发布。 插件是用Java编写的。插件由以下内容组成: JAR中的Java代码 一些只读文件和其它资源(例如图片、web模板、消息资源文件、本地类库等)。 一个插件清单，用于声明它与其它插件之间的连接关系，一个插件的清单由几个文件表示: manifest,mf文件是一个OSGI bundle清单， 它描述了插件间运行时的依赖关系; plugin.xml是一 -个XML文件，它描述了扩展和扩展点的信息 插件目录 标签的结解释，各个标签页的作用 扩展与扩展点 Plugin. xmI中扩展点(extens ion point) 解释 org.eclipse.ui.perspectives：定义新透视图。 org.eclipse. ui.views ::为工作台定义额外的视图。 org.eclipse.ui.commands:命令定义，定义命令、命令目录以及默认快捷键。 org.eclipse.ui.perspectiveExtensions :扩展其他插件定义的透视图。允许添加菜单、工具栏项目、快捷键、视图等等。 org.eclipse.ui.menus :将命令与界面菜单或工具栏绑定。确定菜单创建的区域。用来对菜单进行扩展，可以对主菜单，工具栏，上下文菜单进行扩展。 org.eclipse.ui.handlers:命令实现，(command的具体行为，定义command对应的c lass。 org. eclipse. ui. command Images: comand的图片。 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、启动图标、本地化文本、搜索顺序和外观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter 的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。 在进行TC客户化时主要的配置文件可以通过修改registry完成。例如修改aif. properties文件中的修改显示信息 flashScreen. ICON=images/FlashScreen. jpg执行%TC_ _ROOT%\portal \registry\genregxml. bat文件，如果修改了. properties文件需要执行此程序。执行这个文件的作用是，将所有jar包中的. properties文件中的配置信息写入到RegistryLoader. xml. gz文件及其多国语言文件中。Teamcenter中的Regisity类，从这些文件中预先读取配置信 息。 也支持基本类型的注册，支持以下类型: color、 font、integer、float、 double、 char、 boolean、 string、 string array 和images。有些类型使用特殊的格式，如下所示: Color 1 2 red, green, blue 255,255,255 Font 1 2 font-name,. font-style,font-size &quot;Times Roman, Font.ITALIC, 12” String array 1 one,two,three 快捷启动eclipse 1 2 3 4 5 6 7 8 9 10 11 12 @echo off rem setlocal title Teamcenter Rich Client set TC_JRE_HOME=C:\Program Files\Java\jdk1.8.0_201\jre set TPR=D:\Siemens\Teamcenter10\portal set FMS_HOME=D:\Siemens\Teamcenter10\tccs set PATH=%SYSTEMROOT%\system32;%FMS_HOME%\bin;%FMS_HOME%\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\Siemens\Teamcenter10\iiopservers\start_imr.bat&quot; start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; 对插件程序的注册方法: . 将jar格式的文件复制到TC的plugins文件夹中:D:\Siemens\Teamcenter 10\portal\plugins; 打开D:\Siemens\Teamcenter10\portal中 的register文件夹，浏览到注册文件程序genregxml.bat; 双击注册文件程序genregxml.bat，开始进行注册，等待注册文件程序genregxml.bat自动关闭; 清理TC缓存;C:\Users\Administrator\Teamcenter 打开TC，验证程序功能，查看注册文件。关于–&gt;安装详细信息 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、 启动图标、本地化文本、搜索顺序和外:观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。. 1）、将Jar文件com. newProcess. rac_ 1. 0. jar复制到TC Plugins文件夹;D:\Siemens\Teamcenter10\portal\plugins 2）、修改genregxml.bat，start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; 3）、双击注册文件 4）、清理TC缓存 5）、打开TC验证程序功能 3.3TC开发环境搭建 配置tcEc lipse集成文件 Teamcenter胖客户端本质是建立在Eclipse框架之上的应用程序，因此通过改造启动Teamcenter的启动脚本portal.bat，可以快速方便的构建一个可以直接启动Teamcenter的调试环境。 1）、复制%TC_ ROOT%\portal\portal.bat 2)、将脚本最后启动Teamcenter部分，修改为启动Eclipse程序。原始脚本: 1 2 @echo Starting Teamcenter Rich Client. ···start Teamcenter.exe %* -vm &quot;%JRE_ HOME%\bin\javaw.exe&quot; -Vmargs -Xmx%VM XMX% -XX:MaxPermSize=128m -Xbootclasspath/a:&quot;%JRE_ HOME%lib\plugin.jar&quot;;&quot;%JRE_ HOME%\lib\deploy.jar&quot;;&quot;%JRE_ HOME%\lib\javaws.jar&quot; 修改后脚本: 1 @echo Starting Teamcenter Rich Client..start cmd /c &quot;D: leclipseleclipse.exe&quot; -vm &quot;C:\ProgramFiles\Java\jdk1.8.0_ 201\bin\javaw&quot; 双击该脚本，启动Eclipse， 那么就具备了调试Teamcenter系统的基础环境。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 @echo off rem setlocal rem TPR is short for TC_PORTAL_ROOT to reduce command line length title Teamcenter Rich Client call &quot;D:\Siemens\Teamcenter10\install\tem_init.bat&quot; set TPR=D:\Siemens\Teamcenter10\portal if not defined FMS_HOME set FMS_HOME=D:\Siemens\Teamcenter10\tccs rem use AUX_PATH env var for any additional required paths rem save original path for external applications set ORIGINAL_PATH=%PATH% rem for optimal startup performance, keep the PATH length at a minimum set PATH=%SYSTEMROOT%\system32;%FMS_HOME%\bin;%FMS_HOME%\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\Siemens\Teamcenter10\iiopservers\start_imr.bat&quot; :start_portal cd /d %TPR% set CLASSPATH=.; set VM_XMX=1024m rem Set DJIPJL_VMARG environment variable IF EXIST &quot;%TPR%\DJIPJL\setenv.cmd&quot; call &quot;%TPR%\DJIPJL\setenv.cmd&quot; @echo Starting Teamcenter Rich Client... start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; i、配置Eclipse JRE的首选项 1)、使用tcEclipse快捷方式启动Eclipse。 2）、单击菜单:窗口→首选项 3）、打开“安装JRE”窗口。自Preferences ii、添加JRE位置和系统库 1）、单击添加。 2）、在Add JRE对话框中，选择Standard VM，然后单击下一步。 3）、单击目录…导航到JAVA_HOME，然后单击确定。 4）、等待作为Eclipse中填入的JRE系统库。 ii、更改Preference以使用新安装的JRE 1）、在Preferences对话框，请确认所安装的JRE被选中。 2）、取消选择默认安装的JRE。 3）、选择添加的jdk1.8.0 45的JRE。 4）、保持Preferences窗口打开。 iii、设置Eclipse优先目标平台Teamcenter 由于当前针对Teamcenter平台使用Eclipse进行开发，因此需要将Eclipse开发平台设置为Teamcenter。 1）、单击菜单:窗口- &gt;首选项。 2）、双击Plug-in Development树将其展开，选择Target Platform。 3）、在Target Platform对话框中，单击Add… ，打开“New Target Definition”窗口 4）、初始化目标定义为: Nothing: Start with an empty target definition，点击下一步。 5）、在位置选项卡上，单击“添加”，并使用目录选项，浏览到胖客户端位于:%TC_ ROOT%\portal。 6）、单击Finish。 7）、更改名称: Tc10 Rich Client, 然后单击Finish。 8）、设置“TC10 Rich client”为激活状态。 iiii、设置Teamcenter调试环境参数 1）、单击Run-→Run Configuration…. 2）、双击Eclipse Application。 3）、名称输入“Tc10.1 Rich Client”。 4）、选择Arguments选项卡，在VM参数区域中，输入-Xms256m -Xmx1024m,设置JVM最大内存参数为1024m。 5）、保留值的其余部分保持不变。 创建TC插件项目 i、创建新项目 (1)、单击文件- +新建→项目 (2)、从项目列表中选择Plug-in Project。 (3) 、单击下一步。 ii、输入项目信息 (1)、对于项目名称，键入c9.mycustom (2)、清除源文件夹框。 (3)、保留值的其余部分保持不变。 (4)、单击下一步。 iii、添加插件信息 (1)、在Plug-in Content对话框中，在Vendor框 中输入training Class。 (2）、该值的其余部分应默认 iiii、完成创建 (1)、选择创建检查插件使用的模板“hello， world command”。 (2)、单击Finish。 iiiii、检查调试配置项 (1)、单击Run-→Run Configuration….，查看各项参数设置。 调试测试 (1)单击Eclipse的运行菜单run，运行程序; 调试测试 (2)、在TC登录界面输入账号和密码，登录TC系统; (3)、单击TC中的菜单:帮助一-&gt;关于，弹出TC10的关于对话框; (4)、在“安装详细信息”中可以检索到自定义的插件。 (5)、在TC中可以查看程序功能。 项目打包与部署 (1)、单击文件“导出”，弹出到处对话框，选择“导出”，选择“Deployment plug-in and fragments” ; (2)、选择要导出的插件项目及路径，默认设置在%TC_ ROOT %/Portal文件夹中单击完成按钮，执行导出任务; (3)、在TC的插件文件夹中查看导出的插件包; (4)、执行插件包的注册; (5)、打开TC，从“安装详细信息”中检索插件包。 配置反编译环境 点击Eclipse中菜单windows- &gt; preference。 选中导航树上的Java &gt;JadClipse 编辑Path to decompiler, 内容为刚刚下载的jadnet158.zip所解压缩后路径,如右图所示,路径是软件环境中的具体路径。 设置Class文件默认查看器选中导航树上的General &gt;Editors→File Associations， 在右边列表里,选中*.class确保”JadClipse Class FileViewer”是默认(default) 这样反编译工具JAD就和Eclipse集成到一-起了,只要在Eclipse中双击Class文件就能自动进行编译并显示源代 码。不过有时候反编译会不完全。 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 2 3 4 5 6 7 AbstractAIFApplication AbstractAIFSession AbstractAIFDialog AbstractAIFOperation AlFDesktop AIFPortal AbstractAI FA ction Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAI FApplication 用于创建Application Integration Frame(AIF )应用程序的基本AIFApplication类。该类包含AbstractAIFApplication的定义。它被用作所有AIF应用程序都要继承的基类。 1 2 3 4 getSession() initialize(java.util.Map parameters) open(InterfaceAIFComponent[] components ) refresh() Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAIFSession 这个类表示抽象的AIF会话对象，应用程序集成框架要求它的注册应用程序实现这个对象。子类包括TCSession。 1 2 3 getUserName() login() refresh() com.teamcenter.rac .common Teamcenter的一- 些动作和菜单都在该插件包中进行了定义和注册，如菜单栏，工具栏，以及右键菜单等。一般的菜单动作都在com.teamcenter.rac.common.actions中进行了定义，如新建Item，Dataset, folder. 1.在该包中建LNewltemAction类,并继承AbstractAIFAction类，实现public void run(方法。 2.在action.properties文件中进行了注册，如下所示: File-&gt; New -&gt; Item 1 2 3 4 5 newItemAction=com. teamcenter.rac.common. actions. NewItemAction newItemAction.ICON=images/newitem_ 1 6.png newItemAction.COMM AND=newItem( Command newItem Action.ACCELERATOR=ctrl pressed T newItemC ommand=com.teamcenter.rac.commands. newitem.N ewItemCommand 3.相应的，在该插件中对应一一个com.teamcenter.rac.commands.newitem包，创建Item 的业务逻辑都在该包中进行了实现。 com.teamcenter.rac.external Teamcenter插件中引用到的第三方类大部分都在该插件中进行了继承，可以说该插件为资源性插件 com.teamcenter.rac .kernal 对于客户端开发，都是基于Kernel API组件的，通过Kernel API，可以调用服务器端的功能，实际上Kernel API用 于Rich Client的ITK界面。进程(Session)对象是Kernel API的核心，通过-一个组件或者应用程序的getSession( )方法可以获取该对象的引用，AIFComponentManager是一个当前Session中所存组件的缓存器。二次开发工作所涉及的对象是:进程(Session)、 类型(Type)、服务( Service)、组件(Component)，在做二次开发的时候，如果要从当前的组件转到其他的组件，一般通过Session来进行。 Type组件存在于Teamcenter的每一类对象类型中，主要用来执行如:创建这样的任务，就面向对象来说，当一个对象还没有示例化的时候，无法调用其create方法，所以必须首先获得-一个指向Session的引用，这样即可从Session中获得Type组件。例如:创建-一个Folder的代码如下(假设当前已经获得了一个Session): 1 2 3 4 TCComponentFolderType foldertype= ( TCComponentFolderType).getTypeComponent(&quot;Folder&quot;); TCComponentFolder folder= foldertypecreate(&quot;Folder Name&quot;, &quot;Folder Description&quot;, &quot;Folder Type&quot; ); . Kernel API面向对象的本质是通过应用程序接口(API)来满足用户的需求，整个Kernel的方法模式是创建对象、查找对应的 Type组件和对对象执行操作，组件类中的方法和服务是定义好的就Kernel而言，另外一个需要注意的问题是: Rich Client中所有的组件都是基于属性(property)的，即当要获取-一个对象名称的时候不能用getName( )方法(实际上也没有这个方法)，而是通过getProperty(object_ name; )的方法来完成这个功能。 这主要是因为整个的Kernel是建立在属性(property)层之上的，所以组件类具备获取属性信息的能力，而新建的类是继 承自TC Component组件类的，显然具备获取属性(property)信息的能力。比如当获取-一个BOMLine的数量属性的时候，通过BOMLine.getProperty( bl_ _quantity )即可得到。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 TCSession session = RACUIUtil.getTCSession0; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication0; AIFComponentContext[] selectedContexts = app.getTargetContexts(); InterfaceAIFComponent component = context.getComponent(; TCComponentItem targetItem = (TCComponentItem)component; TCComponentItemRevision rev = targetItem.getLatestItemRevision(; TCComponentForm form = (TCComponentForm )rev.getRelatedComponent(&quot;IMAN_ master_ form_ rev&quot;); if(form.getProperty(&quot;user_ _data_ 1&quot;)== =&quot;&quot; || form.getProperty(&quot;user_ _data_ 2&quot;)=&quot;&quot;) { MessageBox.post(&quot;ITEM无法取到用户数据属性! &quot;, &quot;提示&quot;, MessageBox.INFORMATION); } 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象,该对象对应的系统类是: 1)、TCComponentFolder 该类继承了TCComponent类。扩展定义了Folder的获取以及和属性的修改方法。基本上所有的业务对象都继承于TCComponent类。相应的我们可以联想到，Item对 应的组件类为TCComponentItem; Dataset对 应的组件类为TCComponentDataset。 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象，该对象对应的系统类是: 2）、一个业务类对应的组件类相应的也会对应-一个业务类型类,如Folder对应的业务类型组件类为TCComponentFolderType。该类继承于TCComponentType类。相应的我们可以联想到，Item对应的组件类型类为TCComponentItemType; Dataset对应的组件类型类为TCComponentDatasetType。该类主要扩展定义了相应的业务对象的创建以及另存为等方法。 通过业务对象对应的类型组件类去创建业务对象，还是以Folder对象为例: 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= t.create(&quot;My Folder Name&quot;,&quot;My Folder Description&quot;, &quot;My Folder Type&quot;); com.teamcenter.rac.tcapps Teamcenter中部分应用的基础实现和业务逻辑都在该类中进行了实现，该类也定义了–些公共组件等。 该插件是Teamcenter对大部分Swing组件进行了继承与重写。如: iTextField继承 于JTextField; iComboBox类为 Teamcenter自己定义的组件。 该插件中还定义了一些公共工具类，如: TcLogger日志控制类，Registry注册控制类等 。 1 2 3 4 com.teamcenter.rac.cme.mpp 对MSE应用进行了实现 com.teamcenter.rac.pse 对结构管理器进行了实现 com.teamcenter.rac.query builder 对查询构建器进行了实现 com.teamcenter.rac.explorer 对浏览器进行了实现 任务要求: 1)、掌握jar的解压方式; 2)、掌握使用Common包中的类，构建Jar包，实现快捷菜单添加新建零组件新建数据集的功能。 在EcIipse中创建一个新的插件项目，命名为com.newCreate，不使用模板; 新建plugin. xml文件，调用Common包中的newltem，newDataset类， 实现右键新建Item,新建数据集的功能。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt;; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 修改p lugin.xmI文件，调用Common包中的newltem，newDataset类， 实现右键新建Item，新建数据集的功能。 思考:此处设置的p lugin. xmI脚本文件中，和com. newProcess. rac_1.0解压之后的p lugin.xm |做个比较。 在runtime选项卡中添加导出包。 在Build选项卡中，勾选.上plugin. xml文件，确保生成jar包时，plugin. xml也在包中。 修改Minifest清单文件如下。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Manifest-Version: 1.0 Bundle-ManifestVersion: 2 Bundle-Name: NewCreate Bundle-SymbolicName: com.newCreate;singleton:=true Bundle-Version: 1.0.0.qualifier Bundle-Activator: com.newcreate.Activator Bundle-Vendor: Mycom Require-Bundle: org.eclipse.core.runtime, com.teamcenter.rac.common;bundle-version=&quot;10000.1.0&quot;, org.eclipse.core.runtime.compatibility;bundle-version=&quot;3.2.200&quot;, com.teamcenter.rac.kernel;bundle-version=&quot;10000.1.0&quot;, com.teamcenter.rac.aifrcp;bundle-version=&quot;10000.1.0&quot;, org.eclipse.ui;bundle-version=&quot;3.8.0&quot;, com.teamcenter.rac.external;bundle-version=&quot;10000.1.0&quot; Import-Package: com.teamcenter.rac.commands.newitem Import-Package: com.teamcenter.rac.commands.newdataset Bundle-RequiredExecutionEnvironment: JavaSE-1.7 Bundle-ActivationPolicy: lazy Export-Package: com.newcreate 生成结束后，打包jar包，放到p lugin文件夹中，并通过genr egxml. bat注册，清除缓存后登录TC查看功能结果。 3.5TCSession的使用 在进行Teamcenter客户化(二次开发)前，我们首先要了解哪些是核心API。只有掌握了核心API的使用，才能游刃有余的进行定制开发。下图展示了Teamcenter的核心API。从图中可以看到TC Session是核心API的核 心，通过TC Session沟通了应用程序AbstractAIFUIApplication、业务对象TCComponent、缓存AIFComponentManager、数据类型Type、业务服务Service。其中Type和Services是 各种相关类的集合。 TcSession类在com.teamcenter.rac.kernel包中，是com.teamcenter.rac.aif.kernel.AbstractAIFSession的子类。TC会话负责登录到TC，并记录会话信息。它扩i展了AbstractAIFSession类的功能，使用AIF会话管理器管理会话。AIF : Application Integration Framework 获取TCSession的三种办法 从当前应用程序直接获取TC Session 1 2 AbstractAIFUIApplication app =AIFUtility.getCurrentApplication(); TCSession tcSession = (TCSession) app.getSession(); AbstractAIFUIApplication类在com.teamcenter.rac.aif包中，是com.teamcenter.rac.aif.AbstractAIFApplication的子类。 从TCComponent对象上获取TC Session 1 2 3 4 5 6 7 8 TCSession tcSession = null; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication(); //获取选择的目标对象 InterfaceAIFComponent target = app.getTargetComponent(); if(target != null){ TCComponent tcComp = (TCComponent)target; tcSession = target.getSession(; } 通过ISessionService获取到TCSession 在启动Teamcenter后，TCSession缓存到 了AIFSessionManager中,而AIFSessionManager实现了ISessionService接口。 1 2 3 4 5 6 7 ISessionService iss = AifrcpPlugin. getSessionService(); TCSession tcSession = null; try { tcSession =(TCSession)iss.getSession( &quot;com.teamcenter.rac.kernel.TCSession&quot;); } catch (Exceptione) { e.printStackTrace(); } 获取当前TC信息 1 2 3 4 5 6 7 8 9 tcSession.getUser(); //获取用户 tcSession. getCurrentGroup(); //获取组信息 tcSession.getGroup(); tcSession.getCurrentOrganization(); tcSession.getLoginGroupOrganization(); tcSession.getCurrentRole); // 获取角色. tcSession.getRole(); 设置当前用户 1 2 3 tcSession.setCurrentGroupMember(TCComponentGroup,TCComponentRole); tcSession.setCurrentOrganization(TCComponentGroup); tcSession.setCurrentProject(TCComponentProject); DBA用户旁路功能打开 首选要判断是否为DBA角色。注意:实际上，非BA用户也是可以开通旁路功能的，但是实现的方式稍微复杂些。在某些业务场景下，可能存在这个超越权限的特殊处理，一般是通过代码的方式，使用完后，及时关闭。 1 tcSession.enableBypass(true); 获取Type 函数: 1 TCComponentType type =tcSession.getTypeComponent(&quot;XXXType&quot;) Type组件，存在于Teamcenter的所有数据类型对象中，比如Item、Dataset、 Folder、 Revision等。 这种Type组件主要用于执行一些.如对象的创建、对象的查找等功能。因此，当需要创建对象的时候，首先应该想到通过Type实现。 以下是一些常用的Type: 表单: TCComponentFormType Item对象: TCComponentItemType 版本对象: TCComponentItemRevisionType 数据集: TTCComponentDatasetType 文件夹: CComponentFolderType 分类对象: TCComponentICOType 项目: TCComponentProjectType 查询: TCComponentQueryType 流程: TCComponentProcessType 时间表: TCComponentScheduleType BOM行: TCComponentBOMLineType BOM: TCComponentBOM WindowType 工艺对象: TCComponentMEProcessType 例如创建文件夹功能代码如下: 1 2 3 TCComponentFolderType type = (TCComponentFolderType) tcSession.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= type.create(&quot;My Folder Name&quot;, &quot;MyFolder Description&quot;，&quot;My Folder Type&quot;); getTypeComponent函数中传递的参数，多数情况下， 就是TCComponentXXXType中的XXX。但是也有特列。更准确的说这个参数应该与对象的存储类名–致。例如: 1 2 3 TCComponentQueryType queryType = (TCComponentQueryType)tcSession.getTypeComponent(&quot;ImanQuery&quot;); TCComponentProjectType tcComponentProjectType =(TCComponentProjectType)tcSession.getTypeComponent(&quot;TC_ Project&quot;); TCComponentProcessType processType =(TCComponentProcessType) tcSession.getTypeComponent(&quot;Job&quot;); 对于自定义的对象类型N4MTMOPTrackingRevision，获取参数的 代码如下: 1 TCComponentType tcComptype =tcSession.getTypeComponent(&quot;N4MTMOPTrackingRevision&quot;); 获取Service服务 以下是在二次开发过程中常用的几个服务: (1)首选项服务，可以操作与首选项相关的大部分操作。 1 TCPreferenceService preferenceService =tcSession. getPreferenceService(); (2)分类管理服务，可以完成大部分分类管理操作，包括创建 分类对象、查找分类对象、获取分类结构信息等。 1 TCClassificationService classi ficationService =tcSession. getClassificationService(); 3.6创建TC对象 TCAPI接口 TCComponent TCComponentItem TCComponentI temRevision . TCComponent ItemType . TCComponentFolderType TCComponentUser TCComponentPerson TCComponentGroup TCComponentRole TCComponentForm TCComponentBOMW indow TCComponentRevi si onRule . TCComponentiTextField JCheckBox JFi 1 eChooser JButton JPanel JLabel JTextArea LOVComboBox，LOVUIComponent,TCComponentListOfValues Jtable JDialog DateButton Teamcenter中对象的创建一般都是通过会话获取要创建 对象的类型，然后再根据类型去创建具体的数据对象。每种 对象的创建用的函数方法都不一样。下面将根据不同对象的 创建方式进行说明: 1. Folder 的创建。 2. Form的创建。 3. Item的创建。 4. Dataset 的创建。 Folder 文件夹的创建需要对三个参数赋值，即文件夹名称、文件夹描述、文件夹的类型，以下是系统中创建文件夹的代码。 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session. getTypeComponent (&quot;Folder&quot;) ; TCComponentFolder f=t. create(&quot; My Folder Name ”，” MyFolder Description&quot;, &quot;My Folder Type&quot;) ; Form的创建: Form的创建和Folder的创建类似，需要对三个参数赋值。Form名称、Form描述，以及Form类型。 1 2 TCComponentFormType tccomponentFormType = (TCComponentFormType)session. getTypeComponent (&#39; MyForm&#39; ) ; TCComponentForm tccomponentForm =tccomponentFormType.create (&#39; MyForm&#39;, &quot;MyFormDescription&quot;,&quot;MyForm&quot;) ; Item的创建: Item的创建相对来说比前两个都复杂点，具体原理就是先根据系统类型从系统中获取编码和版本编码，然后进行创建。 item _ID和item Revision获取方法: java TCComponentItemType tccomponentitemtype =(TCComponentItemType)session.getTypeComponent(itemType) ; String itemId = tccomponentitemtype.getNewID(); String itemRev = tccomponentitemtype.getNewRev(); Item单位获取方法 1 2 TCComponentType uom=session.getTypeComponent(UnitOfMeasure); TCComponent[] uoms = uom.extent() ; Item创建方法 1 2 3 TCComponentItem item =tccomponent i temtype. create (i temId, i temRev, itemType, itemName, i temD escription, uoms[0]); ((TCComponentFolder)target).add(contents,item) ; Dataset的创建方法 数据集的创建涉及到命名引用，创建过程:先创建某一一个类型的数据集，然后把命名引用添加上去。代码如下: 1 2 3 4 5 6 7 String as1[] = {url}; String as2[] = {&quot;Text&quot;}; String as3[] = {&quot;Text&quot;}; String as4[] = {&quot;P1ain&quot;}; TCComponentDatasetType tccomponentDatasetType =(TCComponentDatasetType)session. getTypeComponent(&quot;Text&quot;) ; TCComponentDataset tccomponentDataset =tccomponentDatasetType.create(dataFileName,&quot;Text&quot;,&quot;Text&quot;) ; tccomponentDataset.setFiles (as1,as2,as3,as4,); 查询构建器的调用 Teamcenter中有专门的查询构建器模块，我们可以通过配置查询构建器，然后通过代码对系统中的对象进行搜索，以下是调用代码: 1 2 3 4 TCTextService tcTextService = session.getTextService() ; String asKey[] = tcTextService.getTextValue(item_id) ; String asValues[] =00001; InterfaceAIFComponent interfaceAifComponent [] =session.search(ItemId...,asKey,asValues) ; Teamcenter中BOM结构的构建 Teamcenter中的BOM结构建立，具体方法是先在系统中创建B0MWindow对象，然后再得到B0MLine对象，分别在BOMLine.上进行添加即可，实现代码如下: 获取版本规则 1 2 TCComponentRevisionRuleType tcComponentRevisionRuleType =(TCComponentRevisionRuleType)session. getTypeComponent (&quot;RevisionRule&quot;) ; TCComponentRevisionRule tcComponentRevisionRule =tcComponentRevisionRuleType. getDefaultRule() ; 创建BOMWi ndow 1 2 TCComponentBOMWindowType tcComponentBomWindowType =(TCComponentBOMWindowType) session.getTypeComponent (&quot;BOMWindow&quot;) ; TCComponentBOMWi ndow tcComponentBomWindow =tcComponentBomWindowType. create(tcComponentRevisionRule) ; 获取BOMLine的两种方法 1 TCComponentB0MLine line= ((AbstractPSEApplication)app).getTopBOMLine() ; 1 TCComponentBOMLine []Lines= ( (AbstractPSEApplication) app).getSelectedBOMLines() ; 添加对象到BOMLine 1 TCComponentBOMLine tcComponentBomLine1 =tcomponentBomWindow.setWindowTopLine (tcComponentItem,tcComponentI temRevision1，tcComponent,tcComponent1) ; Java调用c的方法 有时候某些功能需要Java程序和C语言程序同时去处理，以下是Java程序调用C语言程序的方法，以调用C语言程序来创建I tem为例: 1 2 3 4 5 6 7 8 9 TCUserService userServ = sessionObj.getUserService() ; Object objs = new Object[3]; String itemId = new String( &quot;1234&quot;); String itemRev = new String (&quot;A&quot;); String itemName = new String (&quot;Nameof1234&quot; ); objs[0] = itemId; objs[1] = itemRev; objs[2] = itemName; TCComponent itemComp = (TCComponent) userServ.call ( &quot;createItem&quot;,objs) ; 通过以下的方式，可以取得目前的session user所属的newstuff folder, 并将objects贴附在这个folder下 1 2 TCComponentFolder newStuffFolder=tcfolder. getNewStuffFolder (session) ; newStuffFolder.add (&quot;contents&quot;,tcComponentItem) ; 通过以下的方式，建立一个已经存在的workflow template, 并将i tem贴附到target中: 1 2 3 4 5 TCComponentProcessType tcComponentProcessType= (TCComponentProcessType) session. getTypeComponent(&quot;Job&#39; ) ; TCComponentProcess newProcess:s= (TCComponentProcess) tcComponentProcessType.create (PROCESS NAME， PROCESS DESC ，WORKFLOW TEMPLATE NAME，TCComponent[], Target : 1) ; TCComponentTaskTemplateType tcComponentTaskTemplateType =(TCComponentTaskTemplateType) session. getTypeComponent ( &quot;EPMTaskTemplate&quot;); tcComponentTaskTemplate=tcComponentTaskTemplateType.extentReadyTemplates (true) ; 第四章 菜单定制是各种软件及其开发平台都会提供的必备功能。Teamcenter平台继承自Eclipse平台，其菜单功能与Eclipse平台是一脉相承的，因此Teamcenter平 台也提供了丰富的菜单功能项。如何实现Teamcenter的菜单功能，是Teamcenter二次 开发者必须掌握的重要技能。本章节将重点介绍Teamcenter中菜单的定制方法，并且以示例的方式引导读者深入了解Teamcenter的菜单定制功能。 菜单定制 Teamcenter Rich Client客户端本身是一个RCP程序，Teamcenter菜单的扩展遵循Ecl ipse菜单扩展的规则，给开发 人员提供了很好的用户体验。 Teamcenter菜单种类包括: 主菜单. 上下文菜单 视图/编辑器菜单 工具栏按钮 发送到菜单 切换菜单项Toggle menu Item Teamcenter主菜单 主菜单一般位于软件的最顶层。下 图中的Sample Menu， 就是二次开发定制的主菜单，我们称这类菜单为一级主菜单。点开一-级主菜单“编辑”后，展开的一般是二级主菜单。Teamcenter平台即支持定制一 级菜单，也支持在OOTB平台.上定制二级菜单。主菜单在哪些应用程序显示，在什么情况下显示，也是可以定制的。 上下文菜单 上下文菜单(Context Menu)，也称为快捷菜单(Shortcut Menu) ,右键点击时才会出现，出现频率较高的菜单项才会出现在上下文菜单中。上下文菜单具有很强的灵活项，随着点击对象的不同，弹出的菜单也会有相应的变化。 视图/编辑器菜单 视图/编辑器菜单(ViewPart/EditorPartMenu)，最右侧弹出的就是“详细信息”视图的菜单。这部分区域的菜单，也是可定制的。 工具栏按钮 工具栏(Toolbar) 是显示位图式按钮行的控制条，使用位图式按钮用来执行命令。按工具栏按钮相当于选择菜单项;如果某个菜单项具有和工具栏按钮相同的ID，那么使用工具栏按钮将会调用映射到该菜单项的同一个处理程序。可以配置按钮，使其在外观和行为上表现为普通按钮、单选按钮或复选框。 菜单扩展点 按照RCP开发方式，菜单配置信息位于plugin. xml文件中,Teamcenter提供了两种扩展点供用户添加菜单到相应的位置: org.eclipse.ui.actionSets,简称为Actions方式; org.eclipse.ui.commands，简称为Commands方式。 Actions,方式为界面上不同区域的表现方式提供了相应的扩展点，并且没有分离其界面表现和内在实现。主要在Teamcenter2007及以前的版本使用，后续版本使用Commands方式扩展。因此，课程仅讲解Commands方式的菜单项扩展。 Commands;方式通过三步设置，有效的达到界面表现和内部实现的分离: 通过org. eclipse. ui. commands 扩展点创建命令和类别(Category)，并且可以把某些命令放在- 一个类别(Category) 中; 通过org. eclipse. ui. menus指定命令出现在界面的哪个区域(视图菜单/主菜单/上下文菜单) ; 通过org. eclipse. ui. handlers指定命令的实现。 针对上下文菜单，除了Actions方式和Comnands方式均可创建外，Eclipse还提供了另外一●种创建上下文菜单的扩展点 org. ecl ipse. ui. popupMenus,简称为popupMenus方 式。 采用Commands方 式创建视图菜单，需要引入org. ecl ipse. ui. menus扩展点、org. eclipse. ui. handlers扩 展点和org. eclipse. ui. bindings扩展点。相关知识点包括: 菜单项扩展点 locationURI语法规则 菜单显示/隐藏控制方法 菜单项扩展点 在具体介绍各菜单扩展点时，我们使用3.3节“hello,world command” 工程中自动创建的菜单，这份配置主要包括 四个扩展点: 第一个扩展点，定义了命令ID: 1 com.teamcenter.helloworld.commands.sampleCommnand 在这个扩展点中，主要定义command id。 1 2 3 4 5 6 7 &lt;extension point=&quot;org.eclipse.ui.commands&quot; &gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.helloworld.commands.category&quot;&gt; &lt;/category&gt; &lt;command name= =&#39; Sample Command&quot; categoryId=&quot; com.teamcenter.helloworld.commands.category&quot; id=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; 第三个扩展点，是给COMMANID增加快捷键的绑定。这个 扩展点主要用于增强用户体验。M1+6代表了当按下快捷键. Ctr1+6时也会执行相应的命令，M2代表Shift。 1 2 3 4 &lt;extension point=&quot; org. eclipse. ui. bindings&#39; &gt; &lt;key commandId=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot; contextId=”org.eclipse.ui.contexts.window&quot; sequence=“M1+6&quot;schemeId=&quot; org. eclipse. ui. defaul tAcce leratorConf iguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; 第四个扩展点，完成了采单的定义。这个扩展点需要重 点掌握，我们大部分的菜单配置项，都在这个扩展点中实现。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 &lt;extension point=&quot; org.eclipse.ui.menus&quot; &gt; &lt;menuContribution locat ionURI=&#39; menu:org. eclipse. ui. main. menu?after additions&#39; &gt; &lt;menu 1abe1=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id= &#39;com.teamcenter.helloworld.menus.sampleMenu&#39;&gt; &lt;command commandId= =&quot; com. teamcenter. hellowor ld. commands. sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot; com. teamcenter. hel lowor ld. menus. sampl eCommand”&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI= toolbar:org.eclipse.ui.main.toolbar?after=additions&#39; &gt; &lt;toolbar id= &quot;com.teamcenter.helloworld.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot; com. teamcenter. hel loworld. commands. sampl eCommand&quot; icon :&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot; com.teamcenter.helloworld.toolbars.sampleCommand^ &gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;/extension&gt; locationURI语法规则 在定义菜单在Teamcenter出现的位置，需要设置locationURI的参数值。locationURI属性格式如 下: 1 &lt;menuContribution locationURI=&quot;[Scheme]:[id] ? [argument-list] &quot;&gt; 其中: Scheme 为该菜单项出现的区域，为menu、popup、toolbar中 的任何一个。 id为菜单区域ID,即现在已经存在的菜单ID、视图ID。 argument-list为该菜单项出现在指定菜单的位置。 主菜单定义 通过Commands 方式把菜单项添加到主菜单及其工具栏上，和视图菜单一样，也是通过扩 展点org. eclipse. ui. menus ;实现，需要设定其menuContribution的locationURI。 例如，添加一个菜单(菜单可以包含若干个菜单项)到主菜单栏中的某一个位置，其locationURI 为: 1 menu:org.eclipse.ui.main.menu?before=Edit 例如，把菜单项添加到已经存在的菜单当中。例如，添加-一个菜单项到File主菜单当中，其locationURI为: 1 menu:File?after=addition 例如，在DetailsView的 下拉菜单加一一个 菜单项，其MenuContribution的locationURI 应为: 1 menu: org.eclipse.ui.views.DetailsView?after=additions 快捷键参数 1 2 D:\Siemens\Teamcenter10\portal\portal.bat -nl zh_CN D:\Siemens\Teamcenter10\portal\portal.bat -nl en_US plugin.xml文件中定义的脚本程序： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;c9.mycustom.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;c9.mycustom.commands.category&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;c9.mycustom.commands.sampleCommand&quot; class=&quot;c9.mycustom.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;c9.mycustom.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?before=Edit&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;c9.mycustom.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt;; &lt;reference definitionId=&quot;com.teamcenter.rac.cme.mpp.inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:file?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand3&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;c9.mycustom.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;c9.mycustom.toolbars.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand2&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand22&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 上下文菜单 Commands;方式与添加视图菜单和主菜单的方式-样，通过设定其menuContribution的locationURI 来实现。 例如，添加一个上下文菜单到快捷菜单中，其locat ionURI为: popup:org.eclipse.ui.popup.any?after=additions 菜单显示/隐藏控制方法 菜单控制是-一个常见的功能。例如，随着选定的内容或当前窗口的不同，菜单中的菜单项会有相应的变化(显示/隐藏或启用/禁用菜单项)。如何控制菜单是插件开发必须掌握的知识。Eclipse为菜单控制提供了两种方法，一种是通过扩展点;另一种是通过API的方式编写程序控制。通过Command方式创建的菜单，可以通过org. eclipse. ui. commands的visibleWhen 属性控制菜单的显示和隐藏。visibleWhen是用于控制菜单显示的核心表达式。该标签即可位于menu标签之下，也可位于command标签之前。尽管从官方的语法说明来看，可以作用于toobar标签下，但是经过测试toolbar 下的visibl eWhen标签不生效。通过org. eclipse. ui. handlers的activewhen 或enabledWhen 控制菜单的启用或禁用。 visibleWhen可以用在command、menu子节点下在menu标签下，添加如下代码，可以让该菜单及其子菜单，仅仅显示在“我的Teamcenter”、“制造工艺规划器中”和“分类”。“or.”标签用于在多个应用程序中显示。 1 2 3 4 5 6 7 8 &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective”&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. cme. mpp. inMainView&#39;&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. classification. icm. inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; Teamcenter中常见的应用程序ID如下: “我的Teamcenter”: com.teamcenter. rac. ui.inMainPerspective “制造工艺规划器”: com.teamcenter. rac. cme. mpp. inMainView “结构管理器”: com. teamcenter. rac. pse. inMainView . “分类管理”: com. teamcenter. rac. classification. icadmin. inMainView “分类”:com. teamcenter. rac. classification. icm. inMainView “入门”: com. teamcenter. rac. gettingstarted. inMainView “项目”: com. teamcenter. rac. project. inMainView 实践练习一： 加载项目c9. mycustom，查看其扩展的设置方式，并修改: 自定义菜单sampl eCommand在Main menu中 出现的位置,出现在windows菜单中; 自定义菜单sampleCommand出现在上下文菜单中。 实践练习二： 定义两个主菜单报表输出、功能 报表输出含有：产品报表导出 功能：创建项目文件夹、创建数据文件夹、修改技术文档ID 实例 工具栏toolbar 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addbutton.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; class=&quot;com.mycom.addbutton.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;toolbar:navigator_Toolbar?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;com.mycom.addbutton.toolbars.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 菜单栏中添加一个新的菜单 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; class=&quot;com.mycom.addmenuitem.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:tools?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addmenuitem.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package com.mycom.addmenuitem.handlers; import org.eclipse.core.commands.AbstractHandler; import org.eclipse.core.commands.ExecutionEvent; import org.eclipse.core.commands.ExecutionException; import org.eclipse.ui.IWorkbenchWindow; import org.eclipse.ui.handlers.HandlerUtil; import org.eclipse.jface.dialogs.MessageDialog; /** * Our sample handler extends AbstractHandler, an IHandler base class. * @see org.eclipse.core.commands.IHandler * @see org.eclipse.core.commands.AbstractHandler */ public class SampleHandler extends AbstractHandler { /** * The constructor. */ public SampleHandler() { } /** * the command has been executed, so extract extract the needed information * from the application context. */ public Object execute(ExecutionEvent event) throws ExecutionException { IWorkbenchWindow window = HandlerUtil.getActiveWorkbenchWindowChecked(event); MessageDialog.openInformation( window.getShell(), &quot;Addmenuitem&quot;, &quot;demo&quot;); return null; } } 菜单栏选项 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.toggleexample.commands.category&quot;&gt; &lt;/category&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleInfoHandler&quot; id=&quot;com.mycom.toggle.commands.infoCommand&quot; name=&quot;Info&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:true&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleWarnHandler&quot; id=&quot;com.mycom.toggle.commands.warnCommand&quot; name=&quot;Warn&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleErrorHandler&quot; id=&quot;com.mycom.toggle.commands.errorCommand&quot; name=&quot;Error&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu id=&quot;com.mycom.toggle.menus.sampleMenu&quot; label=&quot;Error Level&quot; mnemonic=&quot;L&quot;&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.infoCommand&quot; label=&quot;Info&quot; mnemonic=&quot;I&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.warnCommand&quot; label=&quot;Warn&quot; mnemonic=&quot;W&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.errorCommand&quot; label=&quot;Error&quot; mnemonic=&quot;E&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 在右键上添加 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addshortcut.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; class=&quot;com.mycom.addshortcut.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addshortcut.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 视图 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.customview.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; class=&quot;com.mycom.customview.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;com.mycom.customview.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;com.mycom.customview.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.mycom.customview.inMainView&quot; &gt;; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.views&quot;&gt; &lt;view name=&quot;MyCom Custom View&quot; class=&quot;com.mycom.customview.views.CustomView&quot; id=&quot;com.mycom.customview.views.CustomView&quot;&gt; &lt;/view&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.core.expressions.definitions&quot;&gt; &lt;definition id=&quot;com.mycom.customview.inMainView&quot;&gt; &lt;with variable=&quot;activePartId&quot;&gt; &lt;equals value=&quot;com.mycom.customview.views.CustomView&quot; &gt;; &lt;/with&gt; &lt;/definition&gt; &lt;/extension&gt; &lt;/plugin&gt; 退出 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.exit.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;com.mycom.exitcommand.commands.category&quot; id=&quot;com.mycom.exitcommand.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;command defaultHandler=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot; id=&quot;com.mycom.exitcommand.command1.Exit&quot; name=&quot;Exit&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; class=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=group4&quot;&gt; &lt;menu id=&quot;closeMenu&quot; label=&quot;Close&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView&quot;&gt; &lt;toolbar id=&quot;com.mycom.exitcommand.toolbar1&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 综合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;新建文件夹&quot; id=&quot;com.origin.custom.handler.newFolderHandler&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; class=&quot;com.origin.custom.handler.NewFolderHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;客户化菜单(M)&quot; mnemonic=&quot;M&quot; id=&quot;customMenus&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customMenus&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;customToolbar&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; icon=&quot;icons/newfolder_16.png&quot; tooltip=&quot;新建文件夹&quot; id=&quot;customToolbar&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customPopup&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 第五章 五代码化定制任务 5.1.1无代码化定制 实例:定制Teamcenter 胖客户端logon window.通过定制com.teamcenter.rac.kernel version.jar文件， 当登录TC时，可以改变加载的登录界面。 1、自定义登录窗口(logon window) 使用解压缩包工具打开%TC _RO0T%\portal\plugins\com.teamcenter.rac.kernel_10000.1. 0.jar文件，替换\icons’下的background. png文件。 注意:修改原始文件前，先做好备份，并去掉. jar后缀名。 2、按照清理TC缓存的方法，删除C: \Documents andSettings \Admini strator \Teamcenter*目录，重新打开TC验证功能。 1、修改Views,Dial og boxes,Forms，Wizards的布局和内容 可以使用渲染文件Style sheets来改变Teamcenter views, dialogboxes, forms,和wizards using的布局与内容。Style sheets是一种数据集类型，使用Style sheets可以按照实际需求加载定制的数据属性。可供修改的数据对象包括Views，Dialog boxes，Forms的窗口信息。使用渲染文件进行定制的步骤如下 (1)在TC的Newstuff文件夹中新建XMLRenderingStylesheet数据集。例如，要修改汇总(Summary)视图的布局和加载属性，可以命名数据集为myItemSummary。 (2)使用“数据集…..”查询，检索系统中现有的XMLRenderingStylesheet,找到Itemsummary数据集。 ```xml &lt;?xml version=”1.0” encoding=”UTF-8”?&gt; ; ; ; ; ; ; &lt;/header&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; &lt;/section&gt; ; &lt;/section&gt; &lt;/column&gt; ; &lt;/section&gt; ; ; ; &lt;/column&gt; &lt;/page&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; ; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; &lt;/command&gt; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt;" />
<meta property="og:description" content="Teamcenter笔记 概述 客户端定制 服务端定制 第一章 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item Item Revision 动态类型 Relations 修改Item/Item Recision 属性及属性分类 Dataset Model Form Model 第三章 3.1客户端开发技术 3.11AWT &amp; Java Swing RCP的概念 透视图 perspective 视图 View 3.2Teamcenter插件开发 对插件程序的注册方法: . 3.3TC开发环境搭建 创建TC插件项目 配置反编译环境 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp com.teamcenter.rac .common com.teamcenter.rac.external com.teamcenter.rac .kernal com.teamcenter.rac.tcapps 任务要求: 3.5TCSession的使用 获取TCSession的三种办法 从当前应用程序直接获取TC Session 从TCComponent对象上获取TC Session 通过ISessionService获取到TCSession 获取当前TC信息 设置当前用户 DBA用户旁路功能打开 获取Type 获取Service服务 3.6创建TC对象 TCAPI接口 Folder Form的创建: Item的创建: item _ID和item Revision获取方法: Item单位获取方法 Item创建方法 Dataset的创建方法 查询构建器的调用 Teamcenter中BOM结构的构建 获取版本规则 创建BOMWi ndow 获取BOMLine的两种方法 添加对象到BOMLine Java调用c的方法 第四章 菜单定制 Teamcenter主菜单 上下文菜单 视图/编辑器菜单 工具栏按钮 菜单扩展点 菜单项扩展点 locationURI语法规则 主菜单定义 上下文菜单 菜单显示/隐藏控制方法 实践练习一： 实践练习二： 实例 工具栏toolbar 菜单栏中添加一个新的菜单 在右键上添加 视图 退出 综合 第五章 5.1.1无代码化定制 5.2 无代码化定制应用 5.2.2 首选项 5.2.3访问权限管理 第六章 6.1.3 为什么需要报表开发 6.1.4 TC报表生成方式 Teamcenter笔记 概述 Teamcenter的标准功能基本可以供用户使用，但是基于每家公司业务问题以及使用习惯，还有一些特殊的应用与数据整合，所以会产生不同的业务需求，这个时候我们就需要通过客户化定制的方式去满足用户的应用。通过对TC系统的二次开发来实现客户化。 客户端定制 通过个性化定制让用户操作更加方便，提高用户的操作效率。比如一些对话框、操作界面等的定制，数据显示与表单定制，可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 数据显示与表单定制：可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 服务端定制 应用集成： 使用集成工具包（ITK）或服务（Teamcenter Service）进行定制，改变Teamcenter与外部应用集成时行为（behavior）。比如前处理，后处理，SOA接口，ITK函数，Handler等。 数据共享 通过定制开发可以使Teamcenter系统中的一些数据与别的系统共享，或者Teamcenter共享别的系统中数据，比较典型的有报表、CAD集成ERP集成、CAPP集成等。 第一章 1）查看\设置 TC命令行 1 2 3 set TC_ROOT=D:\Siemens\Teamcenter10 set TC_Data=D:\Siemens\tcdata call D:\Siemens\tcdata\tc_profilevars.bat 2）运行TC命令： 清除TC死进程 clearlocks -verbose 列出所有登录到TC的用户 list_users –u=infodba –p=infodba 获取TC版本信息 install -ask_version 导出某个Item到本地文件夹中 tcxml_export -u=infodba -p=infodba -file=D:\output.xml -item=000034 -rev=A -floder=Home 文件卷信息备份 backup_xmlinfo -u=infodba -p=infodba -g=dba 3）查看TC环境变量 ： set TC 实践练习2： 1）运行TC命令： （1）导出原始或旧的CAD属性映射文件 export_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt （2）导入原始或旧的CAD属性映射文件 import_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt 实践练习3： 1）运行TC命令： （1）游离数据收集命令： collect_garbage -u=infodba -p=infodba -g=dba -item -dataset -floder -report （2）删除WASTE BASKET文件夹下所有没有引用的对象 collect_garbage -u=infodba -p=infodba -g=dba -all –delete 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item |tem Revision 动态类型 Relation 属性及属性分类 Teamcenter对象模型由管理数据的类组成 模型可描述成两个基本关系集图 继承关系 关联关系 对象模型原理 Item and Item Revision Model Dataset Model Form Model System Administration Model Product structure object Model Access control Model Application encapsulation M lodel POM persistent Object Manager POM是Teamcenter的核心模块，是应用模块与系统模块的接口，是一个提供内部程序员、第三方以及客户定义他们自己业务对象(business object) 的工具。 系统模块通常是用0DBC访问0racle关系数据库或MS SQL Server POM提供应用程序与系统模块比关系数据库表更高层次的抽象(如创建文件夹)，可以创建、存取他们自己的数据以及存取简单的TC数据 可以通过BMIDE (Bus iness Modeler IDE) 创建业务对象，而不是直接编辑表或写代码，提供了数据的面向对象浏览器，而不是SQL 表达式。 Item Item是TC中管理信息的最基本的对象，提供了用于组织信息、审计/变更控制的物理或概念上的实体。表示真实世界中的一个产品、部件或零件对象等，例如发动机总成、支架等。 ltem有以下基本信息: Item ID (必须唯一,可以是流水码) |tem Name Item type Unitof Measure (Optional) 。 Description 最多240个字符 其中Bus inessOb ject是所有类的基类，再往下是两个分支: POM_ object带有存储类的业务类 Runt imeBusinessOb ect动态类型 Item类型是选择客户化继承类的首选基类。在Item这个视图下，有:存储类、父类、版本类、表单这四项。这里主要解释的是存储类。规则为:每个业务对象，都有一个存储类与之对应。另外同时注意:不同的业务对象可以共同对应于一个存储类。 Item Revision Item Revision用于记录Item的历史 |tem Revision信息 ID Item的唯一 标识 Revision Name . 动态类型 例如: BOML ine它实际是从种存储类.上获取属性从而计算得到的。其中包括PSOccur rence,Note，Item，ItemRev等等 属性可以加载到结构管理器。 Relations TC用Re | at i on来关联数据的Item和Item Revision ReIation描述了数据是怎样与Item和Ite Revision关联的 例:一个Dataset包含了CAD模型，这个模型由某个ItemRevisi on说明 例:一个标准文档描述了一个Item所需要特定草图的填充表单和功能 Item和ltem Revis ion可以与其他一些对象有关，包括Datasets，Forms， Fo Iders以及其他的Item和Item Revision . 每个与Item关联的对象表示了该ltem的各个方面信息 TC提供了基本的关系集，对象与Item、Item Revision之间的关系取决于所执行的规则 master_ Form 关联Form与Item或Item Revision Form是Item或Item Revis ion的属性(Attr ibutes) 集合 关系规则 Item或Item Revis ion必须要有对Form添加、删除master_ Form关系的权限 一个Form与一个Item或Item Revision只能有一个master_ Form关系 一个Form的master_ Form关系只能对应一个Item或Item Revision TC提供了基本的关系集，对象与ltem、Item Revision之间的关系取决于所执行的规则 requirement 关联data与Item或Item Revision (如:草图的标准、Part的技术需求) 关系规则 Item或Item Revis ion必须要有对一个对象添加、删除requirement关系的权限 Form与Item或Item Revis ion可以有一个requi rement关系 只有Dataset的0版本可以与Item或Item Revis i on有requi rement关系 Folder、 enve | ope、 BOM vi ew或BOM Revis i on不能与Item或ItemRevision有requirement关系 一个Item不能另外的Item或Item Revis ion有requi rement关系 一个Item Revis i on可以与另外的Item或Item Revis ion有requirement关系 一个Item Revision不能与另外的同- -个Item的Item Revision有requi rement关系 manifestation关联与Item或Item Revis ion相关其他数据 specification关联定义Item Revis ion的数据 reference关联数据与Item或Item Revision Revision关联Item Revis ion与相应的Item BOMView关联产品结构与Item BOMView Revision关联产品结构Revision与Item Revision 修改Item/Item Recision 当Item被创建时就有了ID 只有对Item添加了数据，Item才有意义 数据集(Dataset)用于其他应用中创建的信息，这些数据可以与Item和Item Revision关联 在TC中，ItemRevision和Datasetversion都可以表示修改信息 Item Revis ion表示Item的明显变化 Dataset vers ion表示每天的变化 修改Item、 Item Revis i on的方法 通过cut、paste方法添加或移除Item与Item Revision的关系 修改与Item和ItemRevision相关的对象的内容 属性及属性分类 类定义了对象的类型(type of object) 、属性(Attr ibutes)和方法(methods) 在TC中，Attr ibute可以是: Integer， Float，Boolean， String,Date，Tag,Array Tag唯一标识Reference和Relation Attribute具有以下特性: Unique Protected:属性只能由创建该对象的应用修改 NULLallowed：如果这个特性不为true的话，对象不能保存 Upper bound (.上边界) Lower bound (下边界) Default value (默认值) 永久 该类型的属性会在数据库中对应一条记录上的一个字段，从而得以保存 运行时 一顾名思义，只是运行时动态的属性，需要配合程序计算获得。 复合 复合属性，如不清楚可以 查看BMI DE使用帮助 关系 从TC8开始关系首先需要定义为属性。 TC2007是不需要的，只用首选项配置。 其他对象模型 Dataset Model 每个产品对象均有一些具体的数据文件来描述其不同方面的详细信息，如设计模型、计算说明、设计要求等。这些数据文件是由不同的应用软件产生的( 如CAD软件、0ffice软件等)，具有不同的表现形式(如Text文件、图形文件等)。 Teamcenter的Dataset (数据集)提供了管理各类应用软件所产生的文件的手段。不管是技术说明文件或CAD / CAM / CAE系统产生的图形数据文件，都可以用原来的形式或点阵形式或其它任何计算机形式的文件存放在Teamcenter系统中。 Dataset是用来管理(存放)应用软件生成的数据(文件)的-种对象。对应于不同类型(格式)的数据(文件)，Teamcenter 提供Dataset Type与之对应。 业务对象是用于详细说明TC对象的行为的 Dataset业务对象用于对Dataset分类 例:当Document Dataset数据打开时， 与该对象关联的WORD处理程序打开 当创建数据集时，会创建0和1两个版本，Revision 0总是指向最新的版本，所以最初时它指向Revision 1。如果创建了Revision 2,Revision 0就指向2。在编程时，如果希望获得最新的版本，就用Revision 0。 所有Dataset的版本都有相同的所有者(owning user)、组(group) 和保护(protect ion)机制。 ITK functions use this convention with R evisions asfollows: 1 AE_ask_dataset Given any dataset, returns Revision 0. AE_ask_dataset_first_rev Given any dataset, returns the oldest Revision. 1 AE_ask_dataset_latest_rev Given any dataset, returns the most recent Revision (nothe Revision 0 copy). Given any dataset, returns the most recent evision (nothe Revision 0 copy). 1 AE_ask_dataset_next_rev Given any dataset, returns the next Revision 1n the sequence. 1 AE_ask_dataset_prev_rev Given any dataset, returns the previous Revision in the sequence 1 AE_find_dataset (&quot;name&quot;, &amp;Dataset) Finds Revision 0 of the Dataset. 1 AOM_refresh(dataset, true) Loads the given Dataset version for modification. 1 AOM_save(dataset) Creates a new, later version of the Dataset and saves a copy to Revision 0. Form Model Form能存储用户定义的属性(Attr ibute), TC提供了标准Form模型。Form是POM对象，可以使用Form |TK函数存取Attr ibute 所有的POM_ appl icat ion_ _ob ject类和它的子类都有所有者和保护机制，只能被系统管理员修改 ACL (Access control | ist)实体由对组和/或用户以及子对象授权的引用组成。 子对象是TC中可以被授权的对象。 Teamcenter软件系统版本历史如下: Teamcenter Enterprise 4.0 Teamcenter Enterprise 5.0 Teamcenter Engineering 9.0 2005年: Teamcenter Engineering 2005 2007年: Teamcenter 2007 2009年:Teamcenter 8 2012年: Teamcenter 9 201 3年: Teamcenter10 201 6年:Teamcenter11 201 8年:Teamcenter1 2 第三章 3.1客户端开发技术 Teamcenter 胖客户端基于客户端-服务器架构模式，客户端和服务器层均可以定制开发。胖客户端具有UI界面，使用Java语言进行构建与定制。服务器端使用Integration Toolkit (ITK) 和 C/C++ 编程语言进行开发。 因为胖客户端基于Eclipse平台，开发时可以获取所有扩展点，作为Teamcenter 开发定制技术，可以使用如下三种方式定制客户端： 1 2 3 Base Eclipse extension points and services (使用org.eclipse.ui.menus extension point). Teamcenter extension points and services (使用application extension points). Teamcenter customization mechanisms (使用style sheets). 基础定制技术用于在客户端创建具有用户界面的插件，并加以显示，需要熟练掌握Eclipse。 Teamcenter 提供几种界面，包括： 胖客户端界面； 基于Web的瘦客户端界面； 业务建模器； Teamcenter集成Microsoft Office； Teamcenter集成CAX，ERP等 因为胖客户端与瘦客户端接口开放了定制方法，仅提供此两种开发方式。 随着Teamcenter软件的发展和进步，利用新技术，尽可能灵活和简单化Teamcenter扩展和定制的能力。 Back and Forward buttons Application banner Search box Navigation pane Application pane Getting Started application button. Primary applications Secondary applications Clipboard button 3.11AWT &amp; Java Swing Abstract Windows Toolkit（AWT）是最原始的、具有有限 GUI 组件、布局管理和函数功能的工具包。AWT的主要优点是，它在 Java 技术的每个版本上都成为了一种标准配置，包括早期的 Web 浏览器中的 Java 实现。另外它也非常稳定，可以在任何一个以Java为基础的环境中运行使用。 AWT中包含了许多类和接口，用于Java Application的GUI编程。通过图形用户界面用户和程序之间可以方便地进行交互。 ava的抽象窗口工具包AWT由Java的java.awt包提供，该包中有许多用来设计GUI的组件类，如：按钮、菜单、列表、文本框等组件类，同事它还包含窗口、面板等容器类。 ava Swing是Java Foundation Classes（JFC）的一部分，它是在 AWT 组件基础上构建的，所有 Swing组件实际上也是 AWT 的一部分。在Swing 中，Sun 开发了一个经过仔细设计的、灵活而强大的 GUI工具包。 Swing 具有内嵌于Java 技术的优点，可完全移植的。Swing 也具有高级图形应用程序所需要的优点。SWT 具有可以作为本地应用程序实现的优点，这可以提高性能，并利用基于SWT 的GUI 来实现本地兼容性。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing与结合了JFace的SWT一起构建GUI。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing 与结合了JFace 的SWT 一起构建GUI。 Standard Widget Toolkit (SWT)，即标准部件工具包。它是一个Java平台下开放源码的Native GUI组件库，也是Eclipse平台的UI组件之一。如果只为一种平台来开发系统，那么SWT 就具有主机兼容性方面的优点，包括与主机特性的集成，例如在Windows 上对ActiveX控件的使用。 Teamcenter2007以上都是采用SWT与Swing结合进行客户端构建的。 与 AWT 的概念相比，SWT 是一个低级的 GUI 工具包。JFace是一组用来简化使用SWT构建GUI的增强组件和工具服务。SWT的创建者为了建立一个只有两者的有点而没有缺点的系统，从AWT和Swing的实践中吸取了大量的经验。从很多方面来说，他们已经成功了。SWT 的 GUI 既具有主机外观，又具有主机的性能。这样就避免了使用 AWT 和 Swing 而引起的大部分问题。特定的主机具有一些低级功能控件，因此 SWT 提供了扩充版本，从而可以产生更一致的行为。 RCP的概念 RCP是Rich Client Platform的缩写，利用Eclipse核心平台和一些有用的插件，进行应用系统的构建。只要新的代码符合插件的代码结构，将代码放入工作空间后，Eclipse平台会自动加载新代码，构成新的Eclipse平台。 Eclipse RCP 提供了标准化的组件模型，包括菜单，工具栏，以及可叠加的窗口组件(编辑器和视图)、按钮、表格、树形结构的支持。 Eclipse RCP的优点 组件化：基于Eclipse的系统设计由被称为plug-ins的插件构成，可以通过扩展点进行配置，也可以被不同应用程序共享。 便利性:Eclipse RCP对各个平台下的产品包装提供了强有力的支持，其开发的RCP甚至可以在嵌入式设备、掌上电脑上运行。Sun公司对Java的口号是write once，run everywhere，Eclipse也可以说是RCP run everywhere。 智能安装和升级：Eclipse提供了专门的Update组件，可以实现通过HTTP、Web站点、复制等多种方式进行安装和更新，避免了早期胖客户端应用、部署升级的麻烦。 可扩展性：Eclipse基于插件进行扩展的思想使得用户可以方便地搭建各种规模、类型和用途的应用程序。按照Eclipse官方的说法，Eclipse RCP一开始就被设计为可扩展的。 使用体验：Eclipse为各种操作系统提供了本地图形接口包。当RCP运行时，Eclipse首先直接调用本机窗口组件，只有没有本机所需组件时才进行模拟。无论RCP在哪种操作系统上运行，都可以保持与本机一致的外观和行为。一个设计优良的富客户端，可以提供诸如拖曳操作、剪切板、导航等 UI元素。UI设计者也可以利用各种界面工具，轻松设计出完美的用户界面。 CP中的每个视图都对应程序中的UI界面。每个透视图对应一个应用组合，如在Teamcenter中 ：我的Teamcenter、结构管理器、分类管理等。下图是以Teamcenter系统为例展示RCP应用程序运行的界面： 透视图 perspective 一个客户端可以运行多个透视图，但每次在界面中只显示一个透视图；在一个透视图中可以添加和重新排列视图，以在透视图中同时显示多个信息集；可以保存重排的透视图，并使用当前名字，也可以为新的排列创建一个新名字。系统管理员可以使用 HiddenPerspectives 首选项来显示/隐藏各个透视图功能。 视图 View 视图中相关工作改变通常会对其他视图中的选项更改；视图中数据的更改会立即保存；视图在透视图中可以便捷的加载，当前透视图中的视图排列可以存储到本透视图，或者新创建的透视图中。 3.2Teamcenter插件开发 Eclipse的设计思想是:一切皆插件。Eclipse核心很小，其它所有功能都以插件的形式附加于Eclipse核心之上。Eclipse基 本内核包括:图形API (SWT/Jface)，Java开 发环境插件(JDT ),插件开发环境(PDE), JDT与PDE构成了Platform run-time。 Teamcenter胖客户端宿主于Eclipse胖客户端平台框架。RCP是一个通用的应用程序框架，通过使用插件，提供了模块化和基于可扩展的组件开发的支持。 PDE和Java Deve lopment Tooling (JDT) IDE 是Eclipse的标准扩展。PDE提供了一些向导以帮助创建插件。 Workbench和Workspace是 Eclipse平台的两个必备的插件它们. 提供了大多数插件使用的扩展点。插件需要添加到扩展点才可以运行。Workbench组件包含了一些扩展点，允许插件扩展Eclipse 用户界面，使这些用户界面带有菜单选择和工具栏按钮;请求不同类型事件的通知;以及创 建新视图。Workspace 组件包含了可以与资源(包括项目和文件)交互的扩展点。 除了Workbench和Workspace，其它插件也可以扩展Eclipse组件。Debug组件可以让插件启动程序、与正在运行的程序交互，以及处理错误Team组件允许Eclipse 资源与版本控制系统(VCS) 交互，构建VCS的Eclipse客户机时，Team 组件就象Debug组件一样，会扩展或增强Eclipse的功能。Help组件可以提供应用程序的联机文档和与上下文的帮助。 一个插件(p lug- in)是Ec lipse平台中的最小功能单元，可以进行独立的开发和发布。 插件是用Java编写的。插件由以下内容组成: JAR中的Java代码 一些只读文件和其它资源(例如图片、web模板、消息资源文件、本地类库等)。 一个插件清单，用于声明它与其它插件之间的连接关系，一个插件的清单由几个文件表示: manifest,mf文件是一个OSGI bundle清单， 它描述了插件间运行时的依赖关系; plugin.xml是一 -个XML文件，它描述了扩展和扩展点的信息 插件目录 标签的结解释，各个标签页的作用 扩展与扩展点 Plugin. xmI中扩展点(extens ion point) 解释 org.eclipse.ui.perspectives：定义新透视图。 org.eclipse. ui.views ::为工作台定义额外的视图。 org.eclipse.ui.commands:命令定义，定义命令、命令目录以及默认快捷键。 org.eclipse.ui.perspectiveExtensions :扩展其他插件定义的透视图。允许添加菜单、工具栏项目、快捷键、视图等等。 org.eclipse.ui.menus :将命令与界面菜单或工具栏绑定。确定菜单创建的区域。用来对菜单进行扩展，可以对主菜单，工具栏，上下文菜单进行扩展。 org.eclipse.ui.handlers:命令实现，(command的具体行为，定义command对应的c lass。 org. eclipse. ui. command Images: comand的图片。 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、启动图标、本地化文本、搜索顺序和外观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter 的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。 在进行TC客户化时主要的配置文件可以通过修改registry完成。例如修改aif. properties文件中的修改显示信息 flashScreen. ICON=images/FlashScreen. jpg执行%TC_ _ROOT%\portal \registry\genregxml. bat文件，如果修改了. properties文件需要执行此程序。执行这个文件的作用是，将所有jar包中的. properties文件中的配置信息写入到RegistryLoader. xml. gz文件及其多国语言文件中。Teamcenter中的Regisity类，从这些文件中预先读取配置信 息。 也支持基本类型的注册，支持以下类型: color、 font、integer、float、 double、 char、 boolean、 string、 string array 和images。有些类型使用特殊的格式，如下所示: Color 1 2 red, green, blue 255,255,255 Font 1 2 font-name,. font-style,font-size &quot;Times Roman, Font.ITALIC, 12” String array 1 one,two,three 快捷启动eclipse 1 2 3 4 5 6 7 8 9 10 11 12 @echo off rem setlocal title Teamcenter Rich Client set TC_JRE_HOME=C:\Program Files\Java\jdk1.8.0_201\jre set TPR=D:\Siemens\Teamcenter10\portal set FMS_HOME=D:\Siemens\Teamcenter10\tccs set PATH=%SYSTEMROOT%\system32;%FMS_HOME%\bin;%FMS_HOME%\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\Siemens\Teamcenter10\iiopservers\start_imr.bat&quot; start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; 对插件程序的注册方法: . 将jar格式的文件复制到TC的plugins文件夹中:D:\Siemens\Teamcenter 10\portal\plugins; 打开D:\Siemens\Teamcenter10\portal中 的register文件夹，浏览到注册文件程序genregxml.bat; 双击注册文件程序genregxml.bat，开始进行注册，等待注册文件程序genregxml.bat自动关闭; 清理TC缓存;C:\Users\Administrator\Teamcenter 打开TC，验证程序功能，查看注册文件。关于–&gt;安装详细信息 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、 启动图标、本地化文本、搜索顺序和外:观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。. 1）、将Jar文件com. newProcess. rac_ 1. 0. jar复制到TC Plugins文件夹;D:\Siemens\Teamcenter10\portal\plugins 2）、修改genregxml.bat，start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; 3）、双击注册文件 4）、清理TC缓存 5）、打开TC验证程序功能 3.3TC开发环境搭建 配置tcEc lipse集成文件 Teamcenter胖客户端本质是建立在Eclipse框架之上的应用程序，因此通过改造启动Teamcenter的启动脚本portal.bat，可以快速方便的构建一个可以直接启动Teamcenter的调试环境。 1）、复制%TC_ ROOT%\portal\portal.bat 2)、将脚本最后启动Teamcenter部分，修改为启动Eclipse程序。原始脚本: 1 2 @echo Starting Teamcenter Rich Client. ···start Teamcenter.exe %* -vm &quot;%JRE_ HOME%\bin\javaw.exe&quot; -Vmargs -Xmx%VM XMX% -XX:MaxPermSize=128m -Xbootclasspath/a:&quot;%JRE_ HOME%lib\plugin.jar&quot;;&quot;%JRE_ HOME%\lib\deploy.jar&quot;;&quot;%JRE_ HOME%\lib\javaws.jar&quot; 修改后脚本: 1 @echo Starting Teamcenter Rich Client..start cmd /c &quot;D: leclipseleclipse.exe&quot; -vm &quot;C:\ProgramFiles\Java\jdk1.8.0_ 201\bin\javaw&quot; 双击该脚本，启动Eclipse， 那么就具备了调试Teamcenter系统的基础环境。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 @echo off rem setlocal rem TPR is short for TC_PORTAL_ROOT to reduce command line length title Teamcenter Rich Client call &quot;D:\Siemens\Teamcenter10\install\tem_init.bat&quot; set TPR=D:\Siemens\Teamcenter10\portal if not defined FMS_HOME set FMS_HOME=D:\Siemens\Teamcenter10\tccs rem use AUX_PATH env var for any additional required paths rem save original path for external applications set ORIGINAL_PATH=%PATH% rem for optimal startup performance, keep the PATH length at a minimum set PATH=%SYSTEMROOT%\system32;%FMS_HOME%\bin;%FMS_HOME%\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\Siemens\Teamcenter10\iiopservers\start_imr.bat&quot; :start_portal cd /d %TPR% set CLASSPATH=.; set VM_XMX=1024m rem Set DJIPJL_VMARG environment variable IF EXIST &quot;%TPR%\DJIPJL\setenv.cmd&quot; call &quot;%TPR%\DJIPJL\setenv.cmd&quot; @echo Starting Teamcenter Rich Client... start D:\eclipse\eclipse.exe -vm &quot;C:\Program Files\Java\jdk1.8.0_201\bin\javaw&quot; i、配置Eclipse JRE的首选项 1)、使用tcEclipse快捷方式启动Eclipse。 2）、单击菜单:窗口→首选项 3）、打开“安装JRE”窗口。自Preferences ii、添加JRE位置和系统库 1）、单击添加。 2）、在Add JRE对话框中，选择Standard VM，然后单击下一步。 3）、单击目录…导航到JAVA_HOME，然后单击确定。 4）、等待作为Eclipse中填入的JRE系统库。 ii、更改Preference以使用新安装的JRE 1）、在Preferences对话框，请确认所安装的JRE被选中。 2）、取消选择默认安装的JRE。 3）、选择添加的jdk1.8.0 45的JRE。 4）、保持Preferences窗口打开。 iii、设置Eclipse优先目标平台Teamcenter 由于当前针对Teamcenter平台使用Eclipse进行开发，因此需要将Eclipse开发平台设置为Teamcenter。 1）、单击菜单:窗口- &gt;首选项。 2）、双击Plug-in Development树将其展开，选择Target Platform。 3）、在Target Platform对话框中，单击Add… ，打开“New Target Definition”窗口 4）、初始化目标定义为: Nothing: Start with an empty target definition，点击下一步。 5）、在位置选项卡上，单击“添加”，并使用目录选项，浏览到胖客户端位于:%TC_ ROOT%\portal。 6）、单击Finish。 7）、更改名称: Tc10 Rich Client, 然后单击Finish。 8）、设置“TC10 Rich client”为激活状态。 iiii、设置Teamcenter调试环境参数 1）、单击Run-→Run Configuration…. 2）、双击Eclipse Application。 3）、名称输入“Tc10.1 Rich Client”。 4）、选择Arguments选项卡，在VM参数区域中，输入-Xms256m -Xmx1024m,设置JVM最大内存参数为1024m。 5）、保留值的其余部分保持不变。 创建TC插件项目 i、创建新项目 (1)、单击文件- +新建→项目 (2)、从项目列表中选择Plug-in Project。 (3) 、单击下一步。 ii、输入项目信息 (1)、对于项目名称，键入c9.mycustom (2)、清除源文件夹框。 (3)、保留值的其余部分保持不变。 (4)、单击下一步。 iii、添加插件信息 (1)、在Plug-in Content对话框中，在Vendor框 中输入training Class。 (2）、该值的其余部分应默认 iiii、完成创建 (1)、选择创建检查插件使用的模板“hello， world command”。 (2)、单击Finish。 iiiii、检查调试配置项 (1)、单击Run-→Run Configuration….，查看各项参数设置。 调试测试 (1)单击Eclipse的运行菜单run，运行程序; 调试测试 (2)、在TC登录界面输入账号和密码，登录TC系统; (3)、单击TC中的菜单:帮助一-&gt;关于，弹出TC10的关于对话框; (4)、在“安装详细信息”中可以检索到自定义的插件。 (5)、在TC中可以查看程序功能。 项目打包与部署 (1)、单击文件“导出”，弹出到处对话框，选择“导出”，选择“Deployment plug-in and fragments” ; (2)、选择要导出的插件项目及路径，默认设置在%TC_ ROOT %/Portal文件夹中单击完成按钮，执行导出任务; (3)、在TC的插件文件夹中查看导出的插件包; (4)、执行插件包的注册; (5)、打开TC，从“安装详细信息”中检索插件包。 配置反编译环境 点击Eclipse中菜单windows- &gt; preference。 选中导航树上的Java &gt;JadClipse 编辑Path to decompiler, 内容为刚刚下载的jadnet158.zip所解压缩后路径,如右图所示,路径是软件环境中的具体路径。 设置Class文件默认查看器选中导航树上的General &gt;Editors→File Associations， 在右边列表里,选中*.class确保”JadClipse Class FileViewer”是默认(default) 这样反编译工具JAD就和Eclipse集成到一-起了,只要在Eclipse中双击Class文件就能自动进行编译并显示源代 码。不过有时候反编译会不完全。 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 2 3 4 5 6 7 AbstractAIFApplication AbstractAIFSession AbstractAIFDialog AbstractAIFOperation AlFDesktop AIFPortal AbstractAI FA ction Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAI FApplication 用于创建Application Integration Frame(AIF )应用程序的基本AIFApplication类。该类包含AbstractAIFApplication的定义。它被用作所有AIF应用程序都要继承的基类。 1 2 3 4 getSession() initialize(java.util.Map parameters) open(InterfaceAIFComponent[] components ) refresh() Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAIFSession 这个类表示抽象的AIF会话对象，应用程序集成框架要求它的注册应用程序实现这个对象。子类包括TCSession。 1 2 3 getUserName() login() refresh() com.teamcenter.rac .common Teamcenter的一- 些动作和菜单都在该插件包中进行了定义和注册，如菜单栏，工具栏，以及右键菜单等。一般的菜单动作都在com.teamcenter.rac.common.actions中进行了定义，如新建Item，Dataset, folder. 1.在该包中建LNewltemAction类,并继承AbstractAIFAction类，实现public void run(方法。 2.在action.properties文件中进行了注册，如下所示: File-&gt; New -&gt; Item 1 2 3 4 5 newItemAction=com. teamcenter.rac.common. actions. NewItemAction newItemAction.ICON=images/newitem_ 1 6.png newItemAction.COMM AND=newItem( Command newItem Action.ACCELERATOR=ctrl pressed T newItemC ommand=com.teamcenter.rac.commands. newitem.N ewItemCommand 3.相应的，在该插件中对应一一个com.teamcenter.rac.commands.newitem包，创建Item 的业务逻辑都在该包中进行了实现。 com.teamcenter.rac.external Teamcenter插件中引用到的第三方类大部分都在该插件中进行了继承，可以说该插件为资源性插件 com.teamcenter.rac .kernal 对于客户端开发，都是基于Kernel API组件的，通过Kernel API，可以调用服务器端的功能，实际上Kernel API用 于Rich Client的ITK界面。进程(Session)对象是Kernel API的核心，通过-一个组件或者应用程序的getSession( )方法可以获取该对象的引用，AIFComponentManager是一个当前Session中所存组件的缓存器。二次开发工作所涉及的对象是:进程(Session)、 类型(Type)、服务( Service)、组件(Component)，在做二次开发的时候，如果要从当前的组件转到其他的组件，一般通过Session来进行。 Type组件存在于Teamcenter的每一类对象类型中，主要用来执行如:创建这样的任务，就面向对象来说，当一个对象还没有示例化的时候，无法调用其create方法，所以必须首先获得-一个指向Session的引用，这样即可从Session中获得Type组件。例如:创建-一个Folder的代码如下(假设当前已经获得了一个Session): 1 2 3 4 TCComponentFolderType foldertype= ( TCComponentFolderType).getTypeComponent(&quot;Folder&quot;); TCComponentFolder folder= foldertypecreate(&quot;Folder Name&quot;, &quot;Folder Description&quot;, &quot;Folder Type&quot; ); . Kernel API面向对象的本质是通过应用程序接口(API)来满足用户的需求，整个Kernel的方法模式是创建对象、查找对应的 Type组件和对对象执行操作，组件类中的方法和服务是定义好的就Kernel而言，另外一个需要注意的问题是: Rich Client中所有的组件都是基于属性(property)的，即当要获取-一个对象名称的时候不能用getName( )方法(实际上也没有这个方法)，而是通过getProperty(object_ name; )的方法来完成这个功能。 这主要是因为整个的Kernel是建立在属性(property)层之上的，所以组件类具备获取属性信息的能力，而新建的类是继 承自TC Component组件类的，显然具备获取属性(property)信息的能力。比如当获取-一个BOMLine的数量属性的时候，通过BOMLine.getProperty( bl_ _quantity )即可得到。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 TCSession session = RACUIUtil.getTCSession0; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication0; AIFComponentContext[] selectedContexts = app.getTargetContexts(); InterfaceAIFComponent component = context.getComponent(; TCComponentItem targetItem = (TCComponentItem)component; TCComponentItemRevision rev = targetItem.getLatestItemRevision(; TCComponentForm form = (TCComponentForm )rev.getRelatedComponent(&quot;IMAN_ master_ form_ rev&quot;); if(form.getProperty(&quot;user_ _data_ 1&quot;)== =&quot;&quot; || form.getProperty(&quot;user_ _data_ 2&quot;)=&quot;&quot;) { MessageBox.post(&quot;ITEM无法取到用户数据属性! &quot;, &quot;提示&quot;, MessageBox.INFORMATION); } 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象,该对象对应的系统类是: 1)、TCComponentFolder 该类继承了TCComponent类。扩展定义了Folder的获取以及和属性的修改方法。基本上所有的业务对象都继承于TCComponent类。相应的我们可以联想到，Item对 应的组件类为TCComponentItem; Dataset对 应的组件类为TCComponentDataset。 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象，该对象对应的系统类是: 2）、一个业务类对应的组件类相应的也会对应-一个业务类型类,如Folder对应的业务类型组件类为TCComponentFolderType。该类继承于TCComponentType类。相应的我们可以联想到，Item对应的组件类型类为TCComponentItemType; Dataset对应的组件类型类为TCComponentDatasetType。该类主要扩展定义了相应的业务对象的创建以及另存为等方法。 通过业务对象对应的类型组件类去创建业务对象，还是以Folder对象为例: 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= t.create(&quot;My Folder Name&quot;,&quot;My Folder Description&quot;, &quot;My Folder Type&quot;); com.teamcenter.rac.tcapps Teamcenter中部分应用的基础实现和业务逻辑都在该类中进行了实现，该类也定义了–些公共组件等。 该插件是Teamcenter对大部分Swing组件进行了继承与重写。如: iTextField继承 于JTextField; iComboBox类为 Teamcenter自己定义的组件。 该插件中还定义了一些公共工具类，如: TcLogger日志控制类，Registry注册控制类等 。 1 2 3 4 com.teamcenter.rac.cme.mpp 对MSE应用进行了实现 com.teamcenter.rac.pse 对结构管理器进行了实现 com.teamcenter.rac.query builder 对查询构建器进行了实现 com.teamcenter.rac.explorer 对浏览器进行了实现 任务要求: 1)、掌握jar的解压方式; 2)、掌握使用Common包中的类，构建Jar包，实现快捷菜单添加新建零组件新建数据集的功能。 在EcIipse中创建一个新的插件项目，命名为com.newCreate，不使用模板; 新建plugin. xml文件，调用Common包中的newltem，newDataset类， 实现右键新建Item,新建数据集的功能。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt;; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 修改p lugin.xmI文件，调用Common包中的newltem，newDataset类， 实现右键新建Item，新建数据集的功能。 思考:此处设置的p lugin. xmI脚本文件中，和com. newProcess. rac_1.0解压之后的p lugin.xm |做个比较。 在runtime选项卡中添加导出包。 在Build选项卡中，勾选.上plugin. xml文件，确保生成jar包时，plugin. xml也在包中。 修改Minifest清单文件如下。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Manifest-Version: 1.0 Bundle-ManifestVersion: 2 Bundle-Name: NewCreate Bundle-SymbolicName: com.newCreate;singleton:=true Bundle-Version: 1.0.0.qualifier Bundle-Activator: com.newcreate.Activator Bundle-Vendor: Mycom Require-Bundle: org.eclipse.core.runtime, com.teamcenter.rac.common;bundle-version=&quot;10000.1.0&quot;, org.eclipse.core.runtime.compatibility;bundle-version=&quot;3.2.200&quot;, com.teamcenter.rac.kernel;bundle-version=&quot;10000.1.0&quot;, com.teamcenter.rac.aifrcp;bundle-version=&quot;10000.1.0&quot;, org.eclipse.ui;bundle-version=&quot;3.8.0&quot;, com.teamcenter.rac.external;bundle-version=&quot;10000.1.0&quot; Import-Package: com.teamcenter.rac.commands.newitem Import-Package: com.teamcenter.rac.commands.newdataset Bundle-RequiredExecutionEnvironment: JavaSE-1.7 Bundle-ActivationPolicy: lazy Export-Package: com.newcreate 生成结束后，打包jar包，放到p lugin文件夹中，并通过genr egxml. bat注册，清除缓存后登录TC查看功能结果。 3.5TCSession的使用 在进行Teamcenter客户化(二次开发)前，我们首先要了解哪些是核心API。只有掌握了核心API的使用，才能游刃有余的进行定制开发。下图展示了Teamcenter的核心API。从图中可以看到TC Session是核心API的核 心，通过TC Session沟通了应用程序AbstractAIFUIApplication、业务对象TCComponent、缓存AIFComponentManager、数据类型Type、业务服务Service。其中Type和Services是 各种相关类的集合。 TcSession类在com.teamcenter.rac.kernel包中，是com.teamcenter.rac.aif.kernel.AbstractAIFSession的子类。TC会话负责登录到TC，并记录会话信息。它扩i展了AbstractAIFSession类的功能，使用AIF会话管理器管理会话。AIF : Application Integration Framework 获取TCSession的三种办法 从当前应用程序直接获取TC Session 1 2 AbstractAIFUIApplication app =AIFUtility.getCurrentApplication(); TCSession tcSession = (TCSession) app.getSession(); AbstractAIFUIApplication类在com.teamcenter.rac.aif包中，是com.teamcenter.rac.aif.AbstractAIFApplication的子类。 从TCComponent对象上获取TC Session 1 2 3 4 5 6 7 8 TCSession tcSession = null; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication(); //获取选择的目标对象 InterfaceAIFComponent target = app.getTargetComponent(); if(target != null){ TCComponent tcComp = (TCComponent)target; tcSession = target.getSession(; } 通过ISessionService获取到TCSession 在启动Teamcenter后，TCSession缓存到 了AIFSessionManager中,而AIFSessionManager实现了ISessionService接口。 1 2 3 4 5 6 7 ISessionService iss = AifrcpPlugin. getSessionService(); TCSession tcSession = null; try { tcSession =(TCSession)iss.getSession( &quot;com.teamcenter.rac.kernel.TCSession&quot;); } catch (Exceptione) { e.printStackTrace(); } 获取当前TC信息 1 2 3 4 5 6 7 8 9 tcSession.getUser(); //获取用户 tcSession. getCurrentGroup(); //获取组信息 tcSession.getGroup(); tcSession.getCurrentOrganization(); tcSession.getLoginGroupOrganization(); tcSession.getCurrentRole); // 获取角色. tcSession.getRole(); 设置当前用户 1 2 3 tcSession.setCurrentGroupMember(TCComponentGroup,TCComponentRole); tcSession.setCurrentOrganization(TCComponentGroup); tcSession.setCurrentProject(TCComponentProject); DBA用户旁路功能打开 首选要判断是否为DBA角色。注意:实际上，非BA用户也是可以开通旁路功能的，但是实现的方式稍微复杂些。在某些业务场景下，可能存在这个超越权限的特殊处理，一般是通过代码的方式，使用完后，及时关闭。 1 tcSession.enableBypass(true); 获取Type 函数: 1 TCComponentType type =tcSession.getTypeComponent(&quot;XXXType&quot;) Type组件，存在于Teamcenter的所有数据类型对象中，比如Item、Dataset、 Folder、 Revision等。 这种Type组件主要用于执行一些.如对象的创建、对象的查找等功能。因此，当需要创建对象的时候，首先应该想到通过Type实现。 以下是一些常用的Type: 表单: TCComponentFormType Item对象: TCComponentItemType 版本对象: TCComponentItemRevisionType 数据集: TTCComponentDatasetType 文件夹: CComponentFolderType 分类对象: TCComponentICOType 项目: TCComponentProjectType 查询: TCComponentQueryType 流程: TCComponentProcessType 时间表: TCComponentScheduleType BOM行: TCComponentBOMLineType BOM: TCComponentBOM WindowType 工艺对象: TCComponentMEProcessType 例如创建文件夹功能代码如下: 1 2 3 TCComponentFolderType type = (TCComponentFolderType) tcSession.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= type.create(&quot;My Folder Name&quot;, &quot;MyFolder Description&quot;，&quot;My Folder Type&quot;); getTypeComponent函数中传递的参数，多数情况下， 就是TCComponentXXXType中的XXX。但是也有特列。更准确的说这个参数应该与对象的存储类名–致。例如: 1 2 3 TCComponentQueryType queryType = (TCComponentQueryType)tcSession.getTypeComponent(&quot;ImanQuery&quot;); TCComponentProjectType tcComponentProjectType =(TCComponentProjectType)tcSession.getTypeComponent(&quot;TC_ Project&quot;); TCComponentProcessType processType =(TCComponentProcessType) tcSession.getTypeComponent(&quot;Job&quot;); 对于自定义的对象类型N4MTMOPTrackingRevision，获取参数的 代码如下: 1 TCComponentType tcComptype =tcSession.getTypeComponent(&quot;N4MTMOPTrackingRevision&quot;); 获取Service服务 以下是在二次开发过程中常用的几个服务: (1)首选项服务，可以操作与首选项相关的大部分操作。 1 TCPreferenceService preferenceService =tcSession. getPreferenceService(); (2)分类管理服务，可以完成大部分分类管理操作，包括创建 分类对象、查找分类对象、获取分类结构信息等。 1 TCClassificationService classi ficationService =tcSession. getClassificationService(); 3.6创建TC对象 TCAPI接口 TCComponent TCComponentItem TCComponentI temRevision . TCComponent ItemType . TCComponentFolderType TCComponentUser TCComponentPerson TCComponentGroup TCComponentRole TCComponentForm TCComponentBOMW indow TCComponentRevi si onRule . TCComponentiTextField JCheckBox JFi 1 eChooser JButton JPanel JLabel JTextArea LOVComboBox，LOVUIComponent,TCComponentListOfValues Jtable JDialog DateButton Teamcenter中对象的创建一般都是通过会话获取要创建 对象的类型，然后再根据类型去创建具体的数据对象。每种 对象的创建用的函数方法都不一样。下面将根据不同对象的 创建方式进行说明: 1. Folder 的创建。 2. Form的创建。 3. Item的创建。 4. Dataset 的创建。 Folder 文件夹的创建需要对三个参数赋值，即文件夹名称、文件夹描述、文件夹的类型，以下是系统中创建文件夹的代码。 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session. getTypeComponent (&quot;Folder&quot;) ; TCComponentFolder f=t. create(&quot; My Folder Name ”，” MyFolder Description&quot;, &quot;My Folder Type&quot;) ; Form的创建: Form的创建和Folder的创建类似，需要对三个参数赋值。Form名称、Form描述，以及Form类型。 1 2 TCComponentFormType tccomponentFormType = (TCComponentFormType)session. getTypeComponent (&#39; MyForm&#39; ) ; TCComponentForm tccomponentForm =tccomponentFormType.create (&#39; MyForm&#39;, &quot;MyFormDescription&quot;,&quot;MyForm&quot;) ; Item的创建: Item的创建相对来说比前两个都复杂点，具体原理就是先根据系统类型从系统中获取编码和版本编码，然后进行创建。 item _ID和item Revision获取方法: java TCComponentItemType tccomponentitemtype =(TCComponentItemType)session.getTypeComponent(itemType) ; String itemId = tccomponentitemtype.getNewID(); String itemRev = tccomponentitemtype.getNewRev(); Item单位获取方法 1 2 TCComponentType uom=session.getTypeComponent(UnitOfMeasure); TCComponent[] uoms = uom.extent() ; Item创建方法 1 2 3 TCComponentItem item =tccomponent i temtype. create (i temId, i temRev, itemType, itemName, i temD escription, uoms[0]); ((TCComponentFolder)target).add(contents,item) ; Dataset的创建方法 数据集的创建涉及到命名引用，创建过程:先创建某一一个类型的数据集，然后把命名引用添加上去。代码如下: 1 2 3 4 5 6 7 String as1[] = {url}; String as2[] = {&quot;Text&quot;}; String as3[] = {&quot;Text&quot;}; String as4[] = {&quot;P1ain&quot;}; TCComponentDatasetType tccomponentDatasetType =(TCComponentDatasetType)session. getTypeComponent(&quot;Text&quot;) ; TCComponentDataset tccomponentDataset =tccomponentDatasetType.create(dataFileName,&quot;Text&quot;,&quot;Text&quot;) ; tccomponentDataset.setFiles (as1,as2,as3,as4,); 查询构建器的调用 Teamcenter中有专门的查询构建器模块，我们可以通过配置查询构建器，然后通过代码对系统中的对象进行搜索，以下是调用代码: 1 2 3 4 TCTextService tcTextService = session.getTextService() ; String asKey[] = tcTextService.getTextValue(item_id) ; String asValues[] =00001; InterfaceAIFComponent interfaceAifComponent [] =session.search(ItemId...,asKey,asValues) ; Teamcenter中BOM结构的构建 Teamcenter中的BOM结构建立，具体方法是先在系统中创建B0MWindow对象，然后再得到B0MLine对象，分别在BOMLine.上进行添加即可，实现代码如下: 获取版本规则 1 2 TCComponentRevisionRuleType tcComponentRevisionRuleType =(TCComponentRevisionRuleType)session. getTypeComponent (&quot;RevisionRule&quot;) ; TCComponentRevisionRule tcComponentRevisionRule =tcComponentRevisionRuleType. getDefaultRule() ; 创建BOMWi ndow 1 2 TCComponentBOMWindowType tcComponentBomWindowType =(TCComponentBOMWindowType) session.getTypeComponent (&quot;BOMWindow&quot;) ; TCComponentBOMWi ndow tcComponentBomWindow =tcComponentBomWindowType. create(tcComponentRevisionRule) ; 获取BOMLine的两种方法 1 TCComponentB0MLine line= ((AbstractPSEApplication)app).getTopBOMLine() ; 1 TCComponentBOMLine []Lines= ( (AbstractPSEApplication) app).getSelectedBOMLines() ; 添加对象到BOMLine 1 TCComponentBOMLine tcComponentBomLine1 =tcomponentBomWindow.setWindowTopLine (tcComponentItem,tcComponentI temRevision1，tcComponent,tcComponent1) ; Java调用c的方法 有时候某些功能需要Java程序和C语言程序同时去处理，以下是Java程序调用C语言程序的方法，以调用C语言程序来创建I tem为例: 1 2 3 4 5 6 7 8 9 TCUserService userServ = sessionObj.getUserService() ; Object objs = new Object[3]; String itemId = new String( &quot;1234&quot;); String itemRev = new String (&quot;A&quot;); String itemName = new String (&quot;Nameof1234&quot; ); objs[0] = itemId; objs[1] = itemRev; objs[2] = itemName; TCComponent itemComp = (TCComponent) userServ.call ( &quot;createItem&quot;,objs) ; 通过以下的方式，可以取得目前的session user所属的newstuff folder, 并将objects贴附在这个folder下 1 2 TCComponentFolder newStuffFolder=tcfolder. getNewStuffFolder (session) ; newStuffFolder.add (&quot;contents&quot;,tcComponentItem) ; 通过以下的方式，建立一个已经存在的workflow template, 并将i tem贴附到target中: 1 2 3 4 5 TCComponentProcessType tcComponentProcessType= (TCComponentProcessType) session. getTypeComponent(&quot;Job&#39; ) ; TCComponentProcess newProcess:s= (TCComponentProcess) tcComponentProcessType.create (PROCESS NAME， PROCESS DESC ，WORKFLOW TEMPLATE NAME，TCComponent[], Target : 1) ; TCComponentTaskTemplateType tcComponentTaskTemplateType =(TCComponentTaskTemplateType) session. getTypeComponent ( &quot;EPMTaskTemplate&quot;); tcComponentTaskTemplate=tcComponentTaskTemplateType.extentReadyTemplates (true) ; 第四章 菜单定制是各种软件及其开发平台都会提供的必备功能。Teamcenter平台继承自Eclipse平台，其菜单功能与Eclipse平台是一脉相承的，因此Teamcenter平 台也提供了丰富的菜单功能项。如何实现Teamcenter的菜单功能，是Teamcenter二次 开发者必须掌握的重要技能。本章节将重点介绍Teamcenter中菜单的定制方法，并且以示例的方式引导读者深入了解Teamcenter的菜单定制功能。 菜单定制 Teamcenter Rich Client客户端本身是一个RCP程序，Teamcenter菜单的扩展遵循Ecl ipse菜单扩展的规则，给开发 人员提供了很好的用户体验。 Teamcenter菜单种类包括: 主菜单. 上下文菜单 视图/编辑器菜单 工具栏按钮 发送到菜单 切换菜单项Toggle menu Item Teamcenter主菜单 主菜单一般位于软件的最顶层。下 图中的Sample Menu， 就是二次开发定制的主菜单，我们称这类菜单为一级主菜单。点开一-级主菜单“编辑”后，展开的一般是二级主菜单。Teamcenter平台即支持定制一 级菜单，也支持在OOTB平台.上定制二级菜单。主菜单在哪些应用程序显示，在什么情况下显示，也是可以定制的。 上下文菜单 上下文菜单(Context Menu)，也称为快捷菜单(Shortcut Menu) ,右键点击时才会出现，出现频率较高的菜单项才会出现在上下文菜单中。上下文菜单具有很强的灵活项，随着点击对象的不同，弹出的菜单也会有相应的变化。 视图/编辑器菜单 视图/编辑器菜单(ViewPart/EditorPartMenu)，最右侧弹出的就是“详细信息”视图的菜单。这部分区域的菜单，也是可定制的。 工具栏按钮 工具栏(Toolbar) 是显示位图式按钮行的控制条，使用位图式按钮用来执行命令。按工具栏按钮相当于选择菜单项;如果某个菜单项具有和工具栏按钮相同的ID，那么使用工具栏按钮将会调用映射到该菜单项的同一个处理程序。可以配置按钮，使其在外观和行为上表现为普通按钮、单选按钮或复选框。 菜单扩展点 按照RCP开发方式，菜单配置信息位于plugin. xml文件中,Teamcenter提供了两种扩展点供用户添加菜单到相应的位置: org.eclipse.ui.actionSets,简称为Actions方式; org.eclipse.ui.commands，简称为Commands方式。 Actions,方式为界面上不同区域的表现方式提供了相应的扩展点，并且没有分离其界面表现和内在实现。主要在Teamcenter2007及以前的版本使用，后续版本使用Commands方式扩展。因此，课程仅讲解Commands方式的菜单项扩展。 Commands;方式通过三步设置，有效的达到界面表现和内部实现的分离: 通过org. eclipse. ui. commands 扩展点创建命令和类别(Category)，并且可以把某些命令放在- 一个类别(Category) 中; 通过org. eclipse. ui. menus指定命令出现在界面的哪个区域(视图菜单/主菜单/上下文菜单) ; 通过org. eclipse. ui. handlers指定命令的实现。 针对上下文菜单，除了Actions方式和Comnands方式均可创建外，Eclipse还提供了另外一●种创建上下文菜单的扩展点 org. ecl ipse. ui. popupMenus,简称为popupMenus方 式。 采用Commands方 式创建视图菜单，需要引入org. ecl ipse. ui. menus扩展点、org. eclipse. ui. handlers扩 展点和org. eclipse. ui. bindings扩展点。相关知识点包括: 菜单项扩展点 locationURI语法规则 菜单显示/隐藏控制方法 菜单项扩展点 在具体介绍各菜单扩展点时，我们使用3.3节“hello,world command” 工程中自动创建的菜单，这份配置主要包括 四个扩展点: 第一个扩展点，定义了命令ID: 1 com.teamcenter.helloworld.commands.sampleCommnand 在这个扩展点中，主要定义command id。 1 2 3 4 5 6 7 &lt;extension point=&quot;org.eclipse.ui.commands&quot; &gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.helloworld.commands.category&quot;&gt; &lt;/category&gt; &lt;command name= =&#39; Sample Command&quot; categoryId=&quot; com.teamcenter.helloworld.commands.category&quot; id=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; 第三个扩展点，是给COMMANID增加快捷键的绑定。这个 扩展点主要用于增强用户体验。M1+6代表了当按下快捷键. Ctr1+6时也会执行相应的命令，M2代表Shift。 1 2 3 4 &lt;extension point=&quot; org. eclipse. ui. bindings&#39; &gt; &lt;key commandId=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot; contextId=”org.eclipse.ui.contexts.window&quot; sequence=“M1+6&quot;schemeId=&quot; org. eclipse. ui. defaul tAcce leratorConf iguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; 第四个扩展点，完成了采单的定义。这个扩展点需要重 点掌握，我们大部分的菜单配置项，都在这个扩展点中实现。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 &lt;extension point=&quot; org.eclipse.ui.menus&quot; &gt; &lt;menuContribution locat ionURI=&#39; menu:org. eclipse. ui. main. menu?after additions&#39; &gt; &lt;menu 1abe1=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id= &#39;com.teamcenter.helloworld.menus.sampleMenu&#39;&gt; &lt;command commandId= =&quot; com. teamcenter. hellowor ld. commands. sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot; com. teamcenter. hel lowor ld. menus. sampl eCommand”&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI= toolbar:org.eclipse.ui.main.toolbar?after=additions&#39; &gt; &lt;toolbar id= &quot;com.teamcenter.helloworld.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot; com. teamcenter. hel loworld. commands. sampl eCommand&quot; icon :&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot; com.teamcenter.helloworld.toolbars.sampleCommand^ &gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;/extension&gt; locationURI语法规则 在定义菜单在Teamcenter出现的位置，需要设置locationURI的参数值。locationURI属性格式如 下: 1 &lt;menuContribution locationURI=&quot;[Scheme]:[id] ? [argument-list] &quot;&gt; 其中: Scheme 为该菜单项出现的区域，为menu、popup、toolbar中 的任何一个。 id为菜单区域ID,即现在已经存在的菜单ID、视图ID。 argument-list为该菜单项出现在指定菜单的位置。 主菜单定义 通过Commands 方式把菜单项添加到主菜单及其工具栏上，和视图菜单一样，也是通过扩 展点org. eclipse. ui. menus ;实现，需要设定其menuContribution的locationURI。 例如，添加一个菜单(菜单可以包含若干个菜单项)到主菜单栏中的某一个位置，其locationURI 为: 1 menu:org.eclipse.ui.main.menu?before=Edit 例如，把菜单项添加到已经存在的菜单当中。例如，添加-一个菜单项到File主菜单当中，其locationURI为: 1 menu:File?after=addition 例如，在DetailsView的 下拉菜单加一一个 菜单项，其MenuContribution的locationURI 应为: 1 menu: org.eclipse.ui.views.DetailsView?after=additions 快捷键参数 1 2 D:\Siemens\Teamcenter10\portal\portal.bat -nl zh_CN D:\Siemens\Teamcenter10\portal\portal.bat -nl en_US plugin.xml文件中定义的脚本程序： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;c9.mycustom.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;c9.mycustom.commands.category&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;c9.mycustom.commands.sampleCommand&quot; class=&quot;c9.mycustom.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;c9.mycustom.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?before=Edit&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;c9.mycustom.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt;; &lt;reference definitionId=&quot;com.teamcenter.rac.cme.mpp.inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:file?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand3&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;c9.mycustom.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;c9.mycustom.toolbars.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand2&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand22&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 上下文菜单 Commands;方式与添加视图菜单和主菜单的方式-样，通过设定其menuContribution的locationURI 来实现。 例如，添加一个上下文菜单到快捷菜单中，其locat ionURI为: popup:org.eclipse.ui.popup.any?after=additions 菜单显示/隐藏控制方法 菜单控制是-一个常见的功能。例如，随着选定的内容或当前窗口的不同，菜单中的菜单项会有相应的变化(显示/隐藏或启用/禁用菜单项)。如何控制菜单是插件开发必须掌握的知识。Eclipse为菜单控制提供了两种方法，一种是通过扩展点;另一种是通过API的方式编写程序控制。通过Command方式创建的菜单，可以通过org. eclipse. ui. commands的visibleWhen 属性控制菜单的显示和隐藏。visibleWhen是用于控制菜单显示的核心表达式。该标签即可位于menu标签之下，也可位于command标签之前。尽管从官方的语法说明来看，可以作用于toobar标签下，但是经过测试toolbar 下的visibl eWhen标签不生效。通过org. eclipse. ui. handlers的activewhen 或enabledWhen 控制菜单的启用或禁用。 visibleWhen可以用在command、menu子节点下在menu标签下，添加如下代码，可以让该菜单及其子菜单，仅仅显示在“我的Teamcenter”、“制造工艺规划器中”和“分类”。“or.”标签用于在多个应用程序中显示。 1 2 3 4 5 6 7 8 &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective”&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. cme. mpp. inMainView&#39;&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. classification. icm. inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; Teamcenter中常见的应用程序ID如下: “我的Teamcenter”: com.teamcenter. rac. ui.inMainPerspective “制造工艺规划器”: com.teamcenter. rac. cme. mpp. inMainView “结构管理器”: com. teamcenter. rac. pse. inMainView . “分类管理”: com. teamcenter. rac. classification. icadmin. inMainView “分类”:com. teamcenter. rac. classification. icm. inMainView “入门”: com. teamcenter. rac. gettingstarted. inMainView “项目”: com. teamcenter. rac. project. inMainView 实践练习一： 加载项目c9. mycustom，查看其扩展的设置方式，并修改: 自定义菜单sampl eCommand在Main menu中 出现的位置,出现在windows菜单中; 自定义菜单sampleCommand出现在上下文菜单中。 实践练习二： 定义两个主菜单报表输出、功能 报表输出含有：产品报表导出 功能：创建项目文件夹、创建数据文件夹、修改技术文档ID 实例 工具栏toolbar 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addbutton.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; class=&quot;com.mycom.addbutton.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;toolbar:navigator_Toolbar?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;com.mycom.addbutton.toolbars.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 菜单栏中添加一个新的菜单 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; class=&quot;com.mycom.addmenuitem.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:tools?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addmenuitem.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package com.mycom.addmenuitem.handlers; import org.eclipse.core.commands.AbstractHandler; import org.eclipse.core.commands.ExecutionEvent; import org.eclipse.core.commands.ExecutionException; import org.eclipse.ui.IWorkbenchWindow; import org.eclipse.ui.handlers.HandlerUtil; import org.eclipse.jface.dialogs.MessageDialog; /** * Our sample handler extends AbstractHandler, an IHandler base class. * @see org.eclipse.core.commands.IHandler * @see org.eclipse.core.commands.AbstractHandler */ public class SampleHandler extends AbstractHandler { /** * The constructor. */ public SampleHandler() { } /** * the command has been executed, so extract extract the needed information * from the application context. */ public Object execute(ExecutionEvent event) throws ExecutionException { IWorkbenchWindow window = HandlerUtil.getActiveWorkbenchWindowChecked(event); MessageDialog.openInformation( window.getShell(), &quot;Addmenuitem&quot;, &quot;demo&quot;); return null; } } 菜单栏选项 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.toggleexample.commands.category&quot;&gt; &lt;/category&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleInfoHandler&quot; id=&quot;com.mycom.toggle.commands.infoCommand&quot; name=&quot;Info&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:true&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleWarnHandler&quot; id=&quot;com.mycom.toggle.commands.warnCommand&quot; name=&quot;Warn&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleErrorHandler&quot; id=&quot;com.mycom.toggle.commands.errorCommand&quot; name=&quot;Error&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu id=&quot;com.mycom.toggle.menus.sampleMenu&quot; label=&quot;Error Level&quot; mnemonic=&quot;L&quot;&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.infoCommand&quot; label=&quot;Info&quot; mnemonic=&quot;I&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.warnCommand&quot; label=&quot;Warn&quot; mnemonic=&quot;W&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.errorCommand&quot; label=&quot;Error&quot; mnemonic=&quot;E&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 在右键上添加 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addshortcut.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; class=&quot;com.mycom.addshortcut.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addshortcut.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 视图 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.customview.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; class=&quot;com.mycom.customview.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;com.mycom.customview.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;com.mycom.customview.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.mycom.customview.inMainView&quot; &gt;; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.views&quot;&gt; &lt;view name=&quot;MyCom Custom View&quot; class=&quot;com.mycom.customview.views.CustomView&quot; id=&quot;com.mycom.customview.views.CustomView&quot;&gt; &lt;/view&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.core.expressions.definitions&quot;&gt; &lt;definition id=&quot;com.mycom.customview.inMainView&quot;&gt; &lt;with variable=&quot;activePartId&quot;&gt; &lt;equals value=&quot;com.mycom.customview.views.CustomView&quot; &gt;; &lt;/with&gt; &lt;/definition&gt; &lt;/extension&gt; &lt;/plugin&gt; 退出 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.exit.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;com.mycom.exitcommand.commands.category&quot; id=&quot;com.mycom.exitcommand.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;command defaultHandler=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot; id=&quot;com.mycom.exitcommand.command1.Exit&quot; name=&quot;Exit&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; class=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=group4&quot;&gt; &lt;menu id=&quot;closeMenu&quot; label=&quot;Close&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView&quot;&gt; &lt;toolbar id=&quot;com.mycom.exitcommand.toolbar1&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 综合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;新建文件夹&quot; id=&quot;com.origin.custom.handler.newFolderHandler&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; class=&quot;com.origin.custom.handler.NewFolderHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;客户化菜单(M)&quot; mnemonic=&quot;M&quot; id=&quot;customMenus&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customMenus&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;customToolbar&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; icon=&quot;icons/newfolder_16.png&quot; tooltip=&quot;新建文件夹&quot; id=&quot;customToolbar&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customPopup&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 第五章 五代码化定制任务 5.1.1无代码化定制 实例:定制Teamcenter 胖客户端logon window.通过定制com.teamcenter.rac.kernel version.jar文件， 当登录TC时，可以改变加载的登录界面。 1、自定义登录窗口(logon window) 使用解压缩包工具打开%TC _RO0T%\portal\plugins\com.teamcenter.rac.kernel_10000.1. 0.jar文件，替换\icons’下的background. png文件。 注意:修改原始文件前，先做好备份，并去掉. jar后缀名。 2、按照清理TC缓存的方法，删除C: \Documents andSettings \Admini strator \Teamcenter*目录，重新打开TC验证功能。 1、修改Views,Dial og boxes,Forms，Wizards的布局和内容 可以使用渲染文件Style sheets来改变Teamcenter views, dialogboxes, forms,和wizards using的布局与内容。Style sheets是一种数据集类型，使用Style sheets可以按照实际需求加载定制的数据属性。可供修改的数据对象包括Views，Dialog boxes，Forms的窗口信息。使用渲染文件进行定制的步骤如下 (1)在TC的Newstuff文件夹中新建XMLRenderingStylesheet数据集。例如，要修改汇总(Summary)视图的布局和加载属性，可以命名数据集为myItemSummary。 (2)使用“数据集…..”查询，检索系统中现有的XMLRenderingStylesheet,找到Itemsummary数据集。 ```xml &lt;?xml version=”1.0” encoding=”UTF-8”?&gt; ; ; ; ; ; ; &lt;/header&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; &lt;/section&gt; ; &lt;/section&gt; &lt;/column&gt; ; &lt;/section&gt; ; ; ; &lt;/column&gt; &lt;/page&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; ; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; &lt;/command&gt; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt;" />
<link rel="canonical" href="http://localhost:4000/posts/teamcenter%E5%AD%A6%E4%B9%A0/" />
<meta property="og:url" content="http://localhost:4000/posts/teamcenter%E5%AD%A6%E4%B9%A0/" />
<meta property="og:site_name" content="Allen" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-29T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Teamcenter学习" />
<meta name="twitter:site" content="@AllenXDong" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-11-30T10:53:44+08:00","datePublished":"2023-11-29T00:00:00+08:00","description":"Teamcenter笔记 概述 客户端定制 服务端定制 第一章 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item Item Revision 动态类型 Relations 修改Item/Item Recision 属性及属性分类 Dataset Model Form Model 第三章 3.1客户端开发技术 3.11AWT &amp; Java Swing RCP的概念 透视图 perspective 视图 View 3.2Teamcenter插件开发 对插件程序的注册方法: . 3.3TC开发环境搭建 创建TC插件项目 配置反编译环境 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp com.teamcenter.rac .common com.teamcenter.rac.external com.teamcenter.rac .kernal com.teamcenter.rac.tcapps 任务要求: 3.5TCSession的使用 获取TCSession的三种办法 从当前应用程序直接获取TC Session 从TCComponent对象上获取TC Session 通过ISessionService获取到TCSession 获取当前TC信息 设置当前用户 DBA用户旁路功能打开 获取Type 获取Service服务 3.6创建TC对象 TCAPI接口 Folder Form的创建: Item的创建: item _ID和item Revision获取方法: Item单位获取方法 Item创建方法 Dataset的创建方法 查询构建器的调用 Teamcenter中BOM结构的构建 获取版本规则 创建BOMWi ndow 获取BOMLine的两种方法 添加对象到BOMLine Java调用c的方法 第四章 菜单定制 Teamcenter主菜单 上下文菜单 视图/编辑器菜单 工具栏按钮 菜单扩展点 菜单项扩展点 locationURI语法规则 主菜单定义 上下文菜单 菜单显示/隐藏控制方法 实践练习一： 实践练习二： 实例 工具栏toolbar 菜单栏中添加一个新的菜单 在右键上添加 视图 退出 综合 第五章 5.1.1无代码化定制 5.2 无代码化定制应用 5.2.2 首选项 5.2.3访问权限管理 第六章 6.1.3 为什么需要报表开发 6.1.4 TC报表生成方式 Teamcenter笔记 概述 Teamcenter的标准功能基本可以供用户使用，但是基于每家公司业务问题以及使用习惯，还有一些特殊的应用与数据整合，所以会产生不同的业务需求，这个时候我们就需要通过客户化定制的方式去满足用户的应用。通过对TC系统的二次开发来实现客户化。 客户端定制 通过个性化定制让用户操作更加方便，提高用户的操作效率。比如一些对话框、操作界面等的定制，数据显示与表单定制，可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 数据显示与表单定制：可以对系统中对象图标的显示、表单界面进行具体的定制与开发。 服务端定制 应用集成： 使用集成工具包（ITK）或服务（Teamcenter Service）进行定制，改变Teamcenter与外部应用集成时行为（behavior）。比如前处理，后处理，SOA接口，ITK函数，Handler等。 数据共享 通过定制开发可以使Teamcenter系统中的一些数据与别的系统共享，或者Teamcenter共享别的系统中数据，比较典型的有报表、CAD集成ERP集成、CAPP集成等。 第一章 1）查看\\设置 TC命令行 1 2 3 set TC_ROOT=D:\\Siemens\\Teamcenter10 set TC_Data=D:\\Siemens\\tcdata call D:\\Siemens\\tcdata\\tc_profilevars.bat 2）运行TC命令： 清除TC死进程 clearlocks -verbose 列出所有登录到TC的用户 list_users –u=infodba –p=infodba 获取TC版本信息 install -ask_version 导出某个Item到本地文件夹中 tcxml_export -u=infodba -p=infodba -file=D:\\output.xml -item=000034 -rev=A -floder=Home 文件卷信息备份 backup_xmlinfo -u=infodba -p=infodba -g=dba 3）查看TC环境变量 ： set TC 实践练习2： 1）运行TC命令： （1）导出原始或旧的CAD属性映射文件 export_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\\attr.txt （2）导入原始或旧的CAD属性映射文件 import_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\\attr.txt 实践练习3： 1）运行TC命令： （1）游离数据收集命令： collect_garbage -u=infodba -p=infodba -g=dba -item -dataset -floder -report （2）删除WASTE BASKET文件夹下所有没有引用的对象 collect_garbage -u=infodba -p=infodba -g=dba -all –delete 第二章 2.1对象模型和系统框架 Item和Item Revision模型 POM Item |tem Revision 动态类型 Relation 属性及属性分类 Teamcenter对象模型由管理数据的类组成 模型可描述成两个基本关系集图 继承关系 关联关系 对象模型原理 Item and Item Revision Model Dataset Model Form Model System Administration Model Product structure object Model Access control Model Application encapsulation M lodel POM persistent Object Manager POM是Teamcenter的核心模块，是应用模块与系统模块的接口，是一个提供内部程序员、第三方以及客户定义他们自己业务对象(business object) 的工具。 系统模块通常是用0DBC访问0racle关系数据库或MS SQL Server POM提供应用程序与系统模块比关系数据库表更高层次的抽象(如创建文件夹)，可以创建、存取他们自己的数据以及存取简单的TC数据 可以通过BMIDE (Bus iness Modeler IDE) 创建业务对象，而不是直接编辑表或写代码，提供了数据的面向对象浏览器，而不是SQL 表达式。 Item Item是TC中管理信息的最基本的对象，提供了用于组织信息、审计/变更控制的物理或概念上的实体。表示真实世界中的一个产品、部件或零件对象等，例如发动机总成、支架等。 ltem有以下基本信息: Item ID (必须唯一,可以是流水码) |tem Name Item type Unitof Measure (Optional) 。 Description 最多240个字符 其中Bus inessOb ject是所有类的基类，再往下是两个分支: POM_ object带有存储类的业务类 Runt imeBusinessOb ect动态类型 Item类型是选择客户化继承类的首选基类。在Item这个视图下，有:存储类、父类、版本类、表单这四项。这里主要解释的是存储类。规则为:每个业务对象，都有一个存储类与之对应。另外同时注意:不同的业务对象可以共同对应于一个存储类。 Item Revision Item Revision用于记录Item的历史 |tem Revision信息 ID Item的唯一 标识 Revision Name . 动态类型 例如: BOML ine它实际是从种存储类.上获取属性从而计算得到的。其中包括PSOccur rence,Note，Item，ItemRev等等 属性可以加载到结构管理器。 Relations TC用Re | at i on来关联数据的Item和Item Revision ReIation描述了数据是怎样与Item和Ite Revision关联的 例:一个Dataset包含了CAD模型，这个模型由某个ItemRevisi on说明 例:一个标准文档描述了一个Item所需要特定草图的填充表单和功能 Item和ltem Revis ion可以与其他一些对象有关，包括Datasets，Forms， Fo Iders以及其他的Item和Item Revision . 每个与Item关联的对象表示了该ltem的各个方面信息 TC提供了基本的关系集，对象与Item、Item Revision之间的关系取决于所执行的规则 master_ Form 关联Form与Item或Item Revision Form是Item或Item Revis ion的属性(Attr ibutes) 集合 关系规则 Item或Item Revis ion必须要有对Form添加、删除master_ Form关系的权限 一个Form与一个Item或Item Revision只能有一个master_ Form关系 一个Form的master_ Form关系只能对应一个Item或Item Revision TC提供了基本的关系集，对象与ltem、Item Revision之间的关系取决于所执行的规则 requirement 关联data与Item或Item Revision (如:草图的标准、Part的技术需求) 关系规则 Item或Item Revis ion必须要有对一个对象添加、删除requirement关系的权限 Form与Item或Item Revis ion可以有一个requi rement关系 只有Dataset的0版本可以与Item或Item Revis i on有requi rement关系 Folder、 enve | ope、 BOM vi ew或BOM Revis i on不能与Item或ItemRevision有requirement关系 一个Item不能另外的Item或Item Revis ion有requi rement关系 一个Item Revis i on可以与另外的Item或Item Revis ion有requirement关系 一个Item Revision不能与另外的同- -个Item的Item Revision有requi rement关系 manifestation关联与Item或Item Revis ion相关其他数据 specification关联定义Item Revis ion的数据 reference关联数据与Item或Item Revision Revision关联Item Revis ion与相应的Item BOMView关联产品结构与Item BOMView Revision关联产品结构Revision与Item Revision 修改Item/Item Recision 当Item被创建时就有了ID 只有对Item添加了数据，Item才有意义 数据集(Dataset)用于其他应用中创建的信息，这些数据可以与Item和Item Revision关联 在TC中，ItemRevision和Datasetversion都可以表示修改信息 Item Revis ion表示Item的明显变化 Dataset vers ion表示每天的变化 修改Item、 Item Revis i on的方法 通过cut、paste方法添加或移除Item与Item Revision的关系 修改与Item和ItemRevision相关的对象的内容 属性及属性分类 类定义了对象的类型(type of object) 、属性(Attr ibutes)和方法(methods) 在TC中，Attr ibute可以是: Integer， Float，Boolean， String,Date，Tag,Array Tag唯一标识Reference和Relation Attribute具有以下特性: Unique Protected:属性只能由创建该对象的应用修改 NULLallowed：如果这个特性不为true的话，对象不能保存 Upper bound (.上边界) Lower bound (下边界) Default value (默认值) 永久 该类型的属性会在数据库中对应一条记录上的一个字段，从而得以保存 运行时 一顾名思义，只是运行时动态的属性，需要配合程序计算获得。 复合 复合属性，如不清楚可以 查看BMI DE使用帮助 关系 从TC8开始关系首先需要定义为属性。 TC2007是不需要的，只用首选项配置。 其他对象模型 Dataset Model 每个产品对象均有一些具体的数据文件来描述其不同方面的详细信息，如设计模型、计算说明、设计要求等。这些数据文件是由不同的应用软件产生的( 如CAD软件、0ffice软件等)，具有不同的表现形式(如Text文件、图形文件等)。 Teamcenter的Dataset (数据集)提供了管理各类应用软件所产生的文件的手段。不管是技术说明文件或CAD / CAM / CAE系统产生的图形数据文件，都可以用原来的形式或点阵形式或其它任何计算机形式的文件存放在Teamcenter系统中。 Dataset是用来管理(存放)应用软件生成的数据(文件)的-种对象。对应于不同类型(格式)的数据(文件)，Teamcenter 提供Dataset Type与之对应。 业务对象是用于详细说明TC对象的行为的 Dataset业务对象用于对Dataset分类 例:当Document Dataset数据打开时， 与该对象关联的WORD处理程序打开 当创建数据集时，会创建0和1两个版本，Revision 0总是指向最新的版本，所以最初时它指向Revision 1。如果创建了Revision 2,Revision 0就指向2。在编程时，如果希望获得最新的版本，就用Revision 0。 所有Dataset的版本都有相同的所有者(owning user)、组(group) 和保护(protect ion)机制。 ITK functions use this convention with R evisions asfollows: 1 AE_ask_dataset Given any dataset, returns Revision 0. AE_ask_dataset_first_rev Given any dataset, returns the oldest Revision. 1 AE_ask_dataset_latest_rev Given any dataset, returns the most recent Revision (nothe Revision 0 copy). Given any dataset, returns the most recent evision (nothe Revision 0 copy). 1 AE_ask_dataset_next_rev Given any dataset, returns the next Revision 1n the sequence. 1 AE_ask_dataset_prev_rev Given any dataset, returns the previous Revision in the sequence 1 AE_find_dataset (&quot;name&quot;, &amp;Dataset) Finds Revision 0 of the Dataset. 1 AOM_refresh(dataset, true) Loads the given Dataset version for modification. 1 AOM_save(dataset) Creates a new, later version of the Dataset and saves a copy to Revision 0. Form Model Form能存储用户定义的属性(Attr ibute), TC提供了标准Form模型。Form是POM对象，可以使用Form |TK函数存取Attr ibute 所有的POM_ appl icat ion_ _ob ject类和它的子类都有所有者和保护机制，只能被系统管理员修改 ACL (Access control | ist)实体由对组和/或用户以及子对象授权的引用组成。 子对象是TC中可以被授权的对象。 Teamcenter软件系统版本历史如下: Teamcenter Enterprise 4.0 Teamcenter Enterprise 5.0 Teamcenter Engineering 9.0 2005年: Teamcenter Engineering 2005 2007年: Teamcenter 2007 2009年:Teamcenter 8 2012年: Teamcenter 9 201 3年: Teamcenter10 201 6年:Teamcenter11 201 8年:Teamcenter1 2 第三章 3.1客户端开发技术 Teamcenter 胖客户端基于客户端-服务器架构模式，客户端和服务器层均可以定制开发。胖客户端具有UI界面，使用Java语言进行构建与定制。服务器端使用Integration Toolkit (ITK) 和 C/C++ 编程语言进行开发。 因为胖客户端基于Eclipse平台，开发时可以获取所有扩展点，作为Teamcenter 开发定制技术，可以使用如下三种方式定制客户端： 1 2 3 Base Eclipse extension points and services (使用org.eclipse.ui.menus extension point). Teamcenter extension points and services (使用application extension points). Teamcenter customization mechanisms (使用style sheets). 基础定制技术用于在客户端创建具有用户界面的插件，并加以显示，需要熟练掌握Eclipse。 Teamcenter 提供几种界面，包括： 胖客户端界面； 基于Web的瘦客户端界面； 业务建模器； Teamcenter集成Microsoft Office； Teamcenter集成CAX，ERP等 因为胖客户端与瘦客户端接口开放了定制方法，仅提供此两种开发方式。 随着Teamcenter软件的发展和进步，利用新技术，尽可能灵活和简单化Teamcenter扩展和定制的能力。 Back and Forward buttons Application banner Search box Navigation pane Application pane Getting Started application button. Primary applications Secondary applications Clipboard button 3.11AWT &amp; Java Swing Abstract Windows Toolkit（AWT）是最原始的、具有有限 GUI 组件、布局管理和函数功能的工具包。AWT的主要优点是，它在 Java 技术的每个版本上都成为了一种标准配置，包括早期的 Web 浏览器中的 Java 实现。另外它也非常稳定，可以在任何一个以Java为基础的环境中运行使用。 AWT中包含了许多类和接口，用于Java Application的GUI编程。通过图形用户界面用户和程序之间可以方便地进行交互。 ava的抽象窗口工具包AWT由Java的java.awt包提供，该包中有许多用来设计GUI的组件类，如：按钮、菜单、列表、文本框等组件类，同事它还包含窗口、面板等容器类。 ava Swing是Java Foundation Classes（JFC）的一部分，它是在 AWT 组件基础上构建的，所有 Swing组件实际上也是 AWT 的一部分。在Swing 中，Sun 开发了一个经过仔细设计的、灵活而强大的 GUI工具包。 Swing 具有内嵌于Java 技术的优点，可完全移植的。Swing 也具有高级图形应用程序所需要的优点。SWT 具有可以作为本地应用程序实现的优点，这可以提高性能，并利用基于SWT 的GUI 来实现本地兼容性。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing与结合了JFace的SWT一起构建GUI。 在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing 与结合了JFace 的SWT 一起构建GUI。 Standard Widget Toolkit (SWT)，即标准部件工具包。它是一个Java平台下开放源码的Native GUI组件库，也是Eclipse平台的UI组件之一。如果只为一种平台来开发系统，那么SWT 就具有主机兼容性方面的优点，包括与主机特性的集成，例如在Windows 上对ActiveX控件的使用。 Teamcenter2007以上都是采用SWT与Swing结合进行客户端构建的。 与 AWT 的概念相比，SWT 是一个低级的 GUI 工具包。JFace是一组用来简化使用SWT构建GUI的增强组件和工具服务。SWT的创建者为了建立一个只有两者的有点而没有缺点的系统，从AWT和Swing的实践中吸取了大量的经验。从很多方面来说，他们已经成功了。SWT 的 GUI 既具有主机外观，又具有主机的性能。这样就避免了使用 AWT 和 Swing 而引起的大部分问题。特定的主机具有一些低级功能控件，因此 SWT 提供了扩充版本，从而可以产生更一致的行为。 RCP的概念 RCP是Rich Client Platform的缩写，利用Eclipse核心平台和一些有用的插件，进行应用系统的构建。只要新的代码符合插件的代码结构，将代码放入工作空间后，Eclipse平台会自动加载新代码，构成新的Eclipse平台。 Eclipse RCP 提供了标准化的组件模型，包括菜单，工具栏，以及可叠加的窗口组件(编辑器和视图)、按钮、表格、树形结构的支持。 Eclipse RCP的优点 组件化：基于Eclipse的系统设计由被称为plug-ins的插件构成，可以通过扩展点进行配置，也可以被不同应用程序共享。 便利性:Eclipse RCP对各个平台下的产品包装提供了强有力的支持，其开发的RCP甚至可以在嵌入式设备、掌上电脑上运行。Sun公司对Java的口号是write once，run everywhere，Eclipse也可以说是RCP run everywhere。 智能安装和升级：Eclipse提供了专门的Update组件，可以实现通过HTTP、Web站点、复制等多种方式进行安装和更新，避免了早期胖客户端应用、部署升级的麻烦。 可扩展性：Eclipse基于插件进行扩展的思想使得用户可以方便地搭建各种规模、类型和用途的应用程序。按照Eclipse官方的说法，Eclipse RCP一开始就被设计为可扩展的。 使用体验：Eclipse为各种操作系统提供了本地图形接口包。当RCP运行时，Eclipse首先直接调用本机窗口组件，只有没有本机所需组件时才进行模拟。无论RCP在哪种操作系统上运行，都可以保持与本机一致的外观和行为。一个设计优良的富客户端，可以提供诸如拖曳操作、剪切板、导航等 UI元素。UI设计者也可以利用各种界面工具，轻松设计出完美的用户界面。 CP中的每个视图都对应程序中的UI界面。每个透视图对应一个应用组合，如在Teamcenter中 ：我的Teamcenter、结构管理器、分类管理等。下图是以Teamcenter系统为例展示RCP应用程序运行的界面： 透视图 perspective 一个客户端可以运行多个透视图，但每次在界面中只显示一个透视图；在一个透视图中可以添加和重新排列视图，以在透视图中同时显示多个信息集；可以保存重排的透视图，并使用当前名字，也可以为新的排列创建一个新名字。系统管理员可以使用 HiddenPerspectives 首选项来显示/隐藏各个透视图功能。 视图 View 视图中相关工作改变通常会对其他视图中的选项更改；视图中数据的更改会立即保存；视图在透视图中可以便捷的加载，当前透视图中的视图排列可以存储到本透视图，或者新创建的透视图中。 3.2Teamcenter插件开发 Eclipse的设计思想是:一切皆插件。Eclipse核心很小，其它所有功能都以插件的形式附加于Eclipse核心之上。Eclipse基 本内核包括:图形API (SWT/Jface)，Java开 发环境插件(JDT ),插件开发环境(PDE), JDT与PDE构成了Platform run-time。 Teamcenter胖客户端宿主于Eclipse胖客户端平台框架。RCP是一个通用的应用程序框架，通过使用插件，提供了模块化和基于可扩展的组件开发的支持。 PDE和Java Deve lopment Tooling (JDT) IDE 是Eclipse的标准扩展。PDE提供了一些向导以帮助创建插件。 Workbench和Workspace是 Eclipse平台的两个必备的插件它们. 提供了大多数插件使用的扩展点。插件需要添加到扩展点才可以运行。Workbench组件包含了一些扩展点，允许插件扩展Eclipse 用户界面，使这些用户界面带有菜单选择和工具栏按钮;请求不同类型事件的通知;以及创 建新视图。Workspace 组件包含了可以与资源(包括项目和文件)交互的扩展点。 除了Workbench和Workspace，其它插件也可以扩展Eclipse组件。Debug组件可以让插件启动程序、与正在运行的程序交互，以及处理错误Team组件允许Eclipse 资源与版本控制系统(VCS) 交互，构建VCS的Eclipse客户机时，Team 组件就象Debug组件一样，会扩展或增强Eclipse的功能。Help组件可以提供应用程序的联机文档和与上下文的帮助。 一个插件(p lug- in)是Ec lipse平台中的最小功能单元，可以进行独立的开发和发布。 插件是用Java编写的。插件由以下内容组成: JAR中的Java代码 一些只读文件和其它资源(例如图片、web模板、消息资源文件、本地类库等)。 一个插件清单，用于声明它与其它插件之间的连接关系，一个插件的清单由几个文件表示: manifest,mf文件是一个OSGI bundle清单， 它描述了插件间运行时的依赖关系; plugin.xml是一 -个XML文件，它描述了扩展和扩展点的信息 插件目录 标签的结解释，各个标签页的作用 扩展与扩展点 Plugin. xmI中扩展点(extens ion point) 解释 org.eclipse.ui.perspectives：定义新透视图。 org.eclipse. ui.views ::为工作台定义额外的视图。 org.eclipse.ui.commands:命令定义，定义命令、命令目录以及默认快捷键。 org.eclipse.ui.perspectiveExtensions :扩展其他插件定义的透视图。允许添加菜单、工具栏项目、快捷键、视图等等。 org.eclipse.ui.menus :将命令与界面菜单或工具栏绑定。确定菜单创建的区域。用来对菜单进行扩展，可以对主菜单，工具栏，上下文菜单进行扩展。 org.eclipse.ui.handlers:命令实现，(command的具体行为，定义command对应的c lass。 org. eclipse. ui. command Images: comand的图片。 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、启动图标、本地化文本、搜索顺序和外观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter 的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。 在进行TC客户化时主要的配置文件可以通过修改registry完成。例如修改aif. properties文件中的修改显示信息 flashScreen. ICON=images/FlashScreen. jpg执行%TC_ _ROOT%\\portal \\registry\\genregxml. bat文件，如果修改了. properties文件需要执行此程序。执行这个文件的作用是，将所有jar包中的. properties文件中的配置信息写入到RegistryLoader. xml. gz文件及其多国语言文件中。Teamcenter中的Regisity类，从这些文件中预先读取配置信 息。 也支持基本类型的注册，支持以下类型: color、 font、integer、float、 double、 char、 boolean、 string、 string array 和images。有些类型使用特殊的格式，如下所示: Color 1 2 red, green, blue 255,255,255 Font 1 2 font-name,. font-style,font-size &quot;Times Roman, Font.ITALIC, 12” String array 1 one,two,three 快捷启动eclipse 1 2 3 4 5 6 7 8 9 10 11 12 @echo off rem setlocal title Teamcenter Rich Client set TC_JRE_HOME=C:\\Program Files\\Java\\jdk1.8.0_201\\jre set TPR=D:\\Siemens\\Teamcenter10\\portal set FMS_HOME=D:\\Siemens\\Teamcenter10\\tccs set PATH=%SYSTEMROOT%\\system32;%FMS_HOME%\\bin;%FMS_HOME%\\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\\Siemens\\Teamcenter10\\iiopservers\\start_imr.bat&quot; start D:\\eclipse\\eclipse.exe -vm &quot;C:\\Program Files\\Java\\jdk1.8.0_201\\bin\\javaw&quot; 对插件程序的注册方法: . 将jar格式的文件复制到TC的plugins文件夹中:D:\\Siemens\\Teamcenter 10\\portal\\plugins; 打开D:\\Siemens\\Teamcenter10\\portal中 的register文件夹，浏览到注册文件程序genregxml.bat; 双击注册文件程序genregxml.bat，开始进行注册，等待注册文件程序genregxml.bat自动关闭; 清理TC缓存;C:\\Users\\Administrator\\Teamcenter 打开TC，验证程序功能，查看注册文件。关于–&gt;安装详细信息 注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、 启动图标、本地化文本、搜索顺序和外:观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。. 1）、将Jar文件com. newProcess. rac_ 1. 0. jar复制到TC Plugins文件夹;D:\\Siemens\\Teamcenter10\\portal\\plugins 2）、修改genregxml.bat，start D:\\eclipse\\eclipse.exe -vm &quot;C:\\Program Files\\Java\\jdk1.8.0_201\\bin\\javaw&quot; 3）、双击注册文件 4）、清理TC缓存 5）、打开TC验证程序功能 3.3TC开发环境搭建 配置tcEc lipse集成文件 Teamcenter胖客户端本质是建立在Eclipse框架之上的应用程序，因此通过改造启动Teamcenter的启动脚本portal.bat，可以快速方便的构建一个可以直接启动Teamcenter的调试环境。 1）、复制%TC_ ROOT%\\portal\\portal.bat 2)、将脚本最后启动Teamcenter部分，修改为启动Eclipse程序。原始脚本: 1 2 @echo Starting Teamcenter Rich Client. ···start Teamcenter.exe %* -vm &quot;%JRE_ HOME%\\bin\\javaw.exe&quot; -Vmargs -Xmx%VM XMX% -XX:MaxPermSize=128m -Xbootclasspath/a:&quot;%JRE_ HOME%lib\\plugin.jar&quot;;&quot;%JRE_ HOME%\\lib\\deploy.jar&quot;;&quot;%JRE_ HOME%\\lib\\javaws.jar&quot; 修改后脚本: 1 @echo Starting Teamcenter Rich Client..start cmd /c &quot;D: leclipseleclipse.exe&quot; -vm &quot;C:\\ProgramFiles\\Java\\jdk1.8.0_ 201\\bin\\javaw&quot; 双击该脚本，启动Eclipse， 那么就具备了调试Teamcenter系统的基础环境。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 @echo off rem setlocal rem TPR is short for TC_PORTAL_ROOT to reduce command line length title Teamcenter Rich Client call &quot;D:\\Siemens\\Teamcenter10\\install\\tem_init.bat&quot; set TPR=D:\\Siemens\\Teamcenter10\\portal if not defined FMS_HOME set FMS_HOME=D:\\Siemens\\Teamcenter10\\tccs rem use AUX_PATH env var for any additional required paths rem save original path for external applications set ORIGINAL_PATH=%PATH% rem for optimal startup performance, keep the PATH length at a minimum set PATH=%SYSTEMROOT%\\system32;%FMS_HOME%\\bin;%FMS_HOME%\\lib;%TPR%;%AUX_PATH% set JAVA_HOME=%TC_JRE_HOME% set JRE_HOME=%TC_JRE_HOME% start &quot;TAO ImR&quot; /min cmd /c &quot;D:\\Siemens\\Teamcenter10\\iiopservers\\start_imr.bat&quot; :start_portal cd /d %TPR% set CLASSPATH=.; set VM_XMX=1024m rem Set DJIPJL_VMARG environment variable IF EXIST &quot;%TPR%\\DJIPJL\\setenv.cmd&quot; call &quot;%TPR%\\DJIPJL\\setenv.cmd&quot; @echo Starting Teamcenter Rich Client... start D:\\eclipse\\eclipse.exe -vm &quot;C:\\Program Files\\Java\\jdk1.8.0_201\\bin\\javaw&quot; i、配置Eclipse JRE的首选项 1)、使用tcEclipse快捷方式启动Eclipse。 2）、单击菜单:窗口→首选项 3）、打开“安装JRE”窗口。自Preferences ii、添加JRE位置和系统库 1）、单击添加。 2）、在Add JRE对话框中，选择Standard VM，然后单击下一步。 3）、单击目录…导航到JAVA_HOME，然后单击确定。 4）、等待作为Eclipse中填入的JRE系统库。 ii、更改Preference以使用新安装的JRE 1）、在Preferences对话框，请确认所安装的JRE被选中。 2）、取消选择默认安装的JRE。 3）、选择添加的jdk1.8.0 45的JRE。 4）、保持Preferences窗口打开。 iii、设置Eclipse优先目标平台Teamcenter 由于当前针对Teamcenter平台使用Eclipse进行开发，因此需要将Eclipse开发平台设置为Teamcenter。 1）、单击菜单:窗口- &gt;首选项。 2）、双击Plug-in Development树将其展开，选择Target Platform。 3）、在Target Platform对话框中，单击Add… ，打开“New Target Definition”窗口 4）、初始化目标定义为: Nothing: Start with an empty target definition，点击下一步。 5）、在位置选项卡上，单击“添加”，并使用目录选项，浏览到胖客户端位于:%TC_ ROOT%\\portal。 6）、单击Finish。 7）、更改名称: Tc10 Rich Client, 然后单击Finish。 8）、设置“TC10 Rich client”为激活状态。 iiii、设置Teamcenter调试环境参数 1）、单击Run-→Run Configuration…. 2）、双击Eclipse Application。 3）、名称输入“Tc10.1 Rich Client”。 4）、选择Arguments选项卡，在VM参数区域中，输入-Xms256m -Xmx1024m,设置JVM最大内存参数为1024m。 5）、保留值的其余部分保持不变。 创建TC插件项目 i、创建新项目 (1)、单击文件- +新建→项目 (2)、从项目列表中选择Plug-in Project。 (3) 、单击下一步。 ii、输入项目信息 (1)、对于项目名称，键入c9.mycustom (2)、清除源文件夹框。 (3)、保留值的其余部分保持不变。 (4)、单击下一步。 iii、添加插件信息 (1)、在Plug-in Content对话框中，在Vendor框 中输入training Class。 (2）、该值的其余部分应默认 iiii、完成创建 (1)、选择创建检查插件使用的模板“hello， world command”。 (2)、单击Finish。 iiiii、检查调试配置项 (1)、单击Run-→Run Configuration….，查看各项参数设置。 调试测试 (1)单击Eclipse的运行菜单run，运行程序; 调试测试 (2)、在TC登录界面输入账号和密码，登录TC系统; (3)、单击TC中的菜单:帮助一-&gt;关于，弹出TC10的关于对话框; (4)、在“安装详细信息”中可以检索到自定义的插件。 (5)、在TC中可以查看程序功能。 项目打包与部署 (1)、单击文件“导出”，弹出到处对话框，选择“导出”，选择“Deployment plug-in and fragments” ; (2)、选择要导出的插件项目及路径，默认设置在%TC_ ROOT %/Portal文件夹中单击完成按钮，执行导出任务; (3)、在TC的插件文件夹中查看导出的插件包; (4)、执行插件包的注册; (5)、打开TC，从“安装详细信息”中检索插件包。 配置反编译环境 点击Eclipse中菜单windows- &gt; preference。 选中导航树上的Java &gt;JadClipse 编辑Path to decompiler, 内容为刚刚下载的jadnet158.zip所解压缩后路径,如右图所示,路径是软件环境中的具体路径。 设置Class文件默认查看器选中导航树上的General &gt;Editors→File Associations， 在右边列表里,选中*.class确保”JadClipse Class FileViewer”是默认(default) 这样反编译工具JAD就和Eclipse集成到一-起了,只要在Eclipse中双击Class文件就能自动进行编译并显示源代 码。不过有时候反编译会不完全。 3.4客户化开发常用接口 com.teamcenter.rac.aifrcp Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 2 3 4 5 6 7 AbstractAIFApplication AbstractAIFSession AbstractAIFDialog AbstractAIFOperation AlFDesktop AIFPortal AbstractAI FA ction Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAI FApplication 用于创建Application Integration Frame(AIF )应用程序的基本AIFApplication类。该类包含AbstractAIFApplication的定义。它被用作所有AIF应用程序都要继承的基类。 1 2 3 4 getSession() initialize(java.util.Map parameters) open(InterfaceAIFComponent[] components ) refresh() Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如: 1 AbstractAIFSession 这个类表示抽象的AIF会话对象，应用程序集成框架要求它的注册应用程序实现这个对象。子类包括TCSession。 1 2 3 getUserName() login() refresh() com.teamcenter.rac .common Teamcenter的一- 些动作和菜单都在该插件包中进行了定义和注册，如菜单栏，工具栏，以及右键菜单等。一般的菜单动作都在com.teamcenter.rac.common.actions中进行了定义，如新建Item，Dataset, folder. 1.在该包中建LNewltemAction类,并继承AbstractAIFAction类，实现public void run(方法。 2.在action.properties文件中进行了注册，如下所示: File-&gt; New -&gt; Item 1 2 3 4 5 newItemAction=com. teamcenter.rac.common. actions. NewItemAction newItemAction.ICON=images/newitem_ 1 6.png newItemAction.COMM AND=newItem( Command newItem Action.ACCELERATOR=ctrl pressed T newItemC ommand=com.teamcenter.rac.commands. newitem.N ewItemCommand 3.相应的，在该插件中对应一一个com.teamcenter.rac.commands.newitem包，创建Item 的业务逻辑都在该包中进行了实现。 com.teamcenter.rac.external Teamcenter插件中引用到的第三方类大部分都在该插件中进行了继承，可以说该插件为资源性插件 com.teamcenter.rac .kernal 对于客户端开发，都是基于Kernel API组件的，通过Kernel API，可以调用服务器端的功能，实际上Kernel API用 于Rich Client的ITK界面。进程(Session)对象是Kernel API的核心，通过-一个组件或者应用程序的getSession( )方法可以获取该对象的引用，AIFComponentManager是一个当前Session中所存组件的缓存器。二次开发工作所涉及的对象是:进程(Session)、 类型(Type)、服务( Service)、组件(Component)，在做二次开发的时候，如果要从当前的组件转到其他的组件，一般通过Session来进行。 Type组件存在于Teamcenter的每一类对象类型中，主要用来执行如:创建这样的任务，就面向对象来说，当一个对象还没有示例化的时候，无法调用其create方法，所以必须首先获得-一个指向Session的引用，这样即可从Session中获得Type组件。例如:创建-一个Folder的代码如下(假设当前已经获得了一个Session): 1 2 3 4 TCComponentFolderType foldertype= ( TCComponentFolderType).getTypeComponent(&quot;Folder&quot;); TCComponentFolder folder= foldertypecreate(&quot;Folder Name&quot;, &quot;Folder Description&quot;, &quot;Folder Type&quot; ); . Kernel API面向对象的本质是通过应用程序接口(API)来满足用户的需求，整个Kernel的方法模式是创建对象、查找对应的 Type组件和对对象执行操作，组件类中的方法和服务是定义好的就Kernel而言，另外一个需要注意的问题是: Rich Client中所有的组件都是基于属性(property)的，即当要获取-一个对象名称的时候不能用getName( )方法(实际上也没有这个方法)，而是通过getProperty(object_ name; )的方法来完成这个功能。 这主要是因为整个的Kernel是建立在属性(property)层之上的，所以组件类具备获取属性信息的能力，而新建的类是继 承自TC Component组件类的，显然具备获取属性(property)信息的能力。比如当获取-一个BOMLine的数量属性的时候，通过BOMLine.getProperty( bl_ _quantity )即可得到。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 TCSession session = RACUIUtil.getTCSession0; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication0; AIFComponentContext[] selectedContexts = app.getTargetContexts(); InterfaceAIFComponent component = context.getComponent(; TCComponentItem targetItem = (TCComponentItem)component; TCComponentItemRevision rev = targetItem.getLatestItemRevision(; TCComponentForm form = (TCComponentForm )rev.getRelatedComponent(&quot;IMAN_ master_ form_ rev&quot;); if(form.getProperty(&quot;user_ _data_ 1&quot;)== =&quot;&quot; || form.getProperty(&quot;user_ _data_ 2&quot;)=&quot;&quot;) { MessageBox.post(&quot;ITEM无法取到用户数据属性! &quot;, &quot;提示&quot;, MessageBox.INFORMATION); } 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象,该对象对应的系统类是: 1)、TCComponentFolder 该类继承了TCComponent类。扩展定义了Folder的获取以及和属性的修改方法。基本上所有的业务对象都继承于TCComponent类。相应的我们可以联想到，Item对 应的组件类为TCComponentItem; Dataset对 应的组件类为TCComponentDataset。 该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象，该对象对应的系统类是: 2）、一个业务类对应的组件类相应的也会对应-一个业务类型类,如Folder对应的业务类型组件类为TCComponentFolderType。该类继承于TCComponentType类。相应的我们可以联想到，Item对应的组件类型类为TCComponentItemType; Dataset对应的组件类型类为TCComponentDatasetType。该类主要扩展定义了相应的业务对象的创建以及另存为等方法。 通过业务对象对应的类型组件类去创建业务对象，还是以Folder对象为例: 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= t.create(&quot;My Folder Name&quot;,&quot;My Folder Description&quot;, &quot;My Folder Type&quot;); com.teamcenter.rac.tcapps Teamcenter中部分应用的基础实现和业务逻辑都在该类中进行了实现，该类也定义了–些公共组件等。 该插件是Teamcenter对大部分Swing组件进行了继承与重写。如: iTextField继承 于JTextField; iComboBox类为 Teamcenter自己定义的组件。 该插件中还定义了一些公共工具类，如: TcLogger日志控制类，Registry注册控制类等 。 1 2 3 4 com.teamcenter.rac.cme.mpp 对MSE应用进行了实现 com.teamcenter.rac.pse 对结构管理器进行了实现 com.teamcenter.rac.query builder 对查询构建器进行了实现 com.teamcenter.rac.explorer 对浏览器进行了实现 任务要求: 1)、掌握jar的解压方式; 2)、掌握使用Common包中的类，构建Jar包，实现快捷菜单添加新建零组件新建数据集的功能。 在EcIipse中创建一个新的插件项目，命名为com.newCreate，不使用模板; 新建plugin. xml文件，调用Common包中的newltem，newDataset类， 实现右键新建Item,新建数据集的功能。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt;; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 修改p lugin.xmI文件，调用Common包中的newltem，newDataset类， 实现右键新建Item，新建数据集的功能。 思考:此处设置的p lugin. xmI脚本文件中，和com. newProcess. rac_1.0解压之后的p lugin.xm |做个比较。 在runtime选项卡中添加导出包。 在Build选项卡中，勾选.上plugin. xml文件，确保生成jar包时，plugin. xml也在包中。 修改Minifest清单文件如下。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Manifest-Version: 1.0 Bundle-ManifestVersion: 2 Bundle-Name: NewCreate Bundle-SymbolicName: com.newCreate;singleton:=true Bundle-Version: 1.0.0.qualifier Bundle-Activator: com.newcreate.Activator Bundle-Vendor: Mycom Require-Bundle: org.eclipse.core.runtime, com.teamcenter.rac.common;bundle-version=&quot;10000.1.0&quot;, org.eclipse.core.runtime.compatibility;bundle-version=&quot;3.2.200&quot;, com.teamcenter.rac.kernel;bundle-version=&quot;10000.1.0&quot;, com.teamcenter.rac.aifrcp;bundle-version=&quot;10000.1.0&quot;, org.eclipse.ui;bundle-version=&quot;3.8.0&quot;, com.teamcenter.rac.external;bundle-version=&quot;10000.1.0&quot; Import-Package: com.teamcenter.rac.commands.newitem Import-Package: com.teamcenter.rac.commands.newdataset Bundle-RequiredExecutionEnvironment: JavaSE-1.7 Bundle-ActivationPolicy: lazy Export-Package: com.newcreate 生成结束后，打包jar包，放到p lugin文件夹中，并通过genr egxml. bat注册，清除缓存后登录TC查看功能结果。 3.5TCSession的使用 在进行Teamcenter客户化(二次开发)前，我们首先要了解哪些是核心API。只有掌握了核心API的使用，才能游刃有余的进行定制开发。下图展示了Teamcenter的核心API。从图中可以看到TC Session是核心API的核 心，通过TC Session沟通了应用程序AbstractAIFUIApplication、业务对象TCComponent、缓存AIFComponentManager、数据类型Type、业务服务Service。其中Type和Services是 各种相关类的集合。 TcSession类在com.teamcenter.rac.kernel包中，是com.teamcenter.rac.aif.kernel.AbstractAIFSession的子类。TC会话负责登录到TC，并记录会话信息。它扩i展了AbstractAIFSession类的功能，使用AIF会话管理器管理会话。AIF : Application Integration Framework 获取TCSession的三种办法 从当前应用程序直接获取TC Session 1 2 AbstractAIFUIApplication app =AIFUtility.getCurrentApplication(); TCSession tcSession = (TCSession) app.getSession(); AbstractAIFUIApplication类在com.teamcenter.rac.aif包中，是com.teamcenter.rac.aif.AbstractAIFApplication的子类。 从TCComponent对象上获取TC Session 1 2 3 4 5 6 7 8 TCSession tcSession = null; AbstractAIFUIApplication app = AIFUtility.getCurrentApplication(); //获取选择的目标对象 InterfaceAIFComponent target = app.getTargetComponent(); if(target != null){ TCComponent tcComp = (TCComponent)target; tcSession = target.getSession(; } 通过ISessionService获取到TCSession 在启动Teamcenter后，TCSession缓存到 了AIFSessionManager中,而AIFSessionManager实现了ISessionService接口。 1 2 3 4 5 6 7 ISessionService iss = AifrcpPlugin. getSessionService(); TCSession tcSession = null; try { tcSession =(TCSession)iss.getSession( &quot;com.teamcenter.rac.kernel.TCSession&quot;); } catch (Exceptione) { e.printStackTrace(); } 获取当前TC信息 1 2 3 4 5 6 7 8 9 tcSession.getUser(); //获取用户 tcSession. getCurrentGroup(); //获取组信息 tcSession.getGroup(); tcSession.getCurrentOrganization(); tcSession.getLoginGroupOrganization(); tcSession.getCurrentRole); // 获取角色. tcSession.getRole(); 设置当前用户 1 2 3 tcSession.setCurrentGroupMember(TCComponentGroup,TCComponentRole); tcSession.setCurrentOrganization(TCComponentGroup); tcSession.setCurrentProject(TCComponentProject); DBA用户旁路功能打开 首选要判断是否为DBA角色。注意:实际上，非BA用户也是可以开通旁路功能的，但是实现的方式稍微复杂些。在某些业务场景下，可能存在这个超越权限的特殊处理，一般是通过代码的方式，使用完后，及时关闭。 1 tcSession.enableBypass(true); 获取Type 函数: 1 TCComponentType type =tcSession.getTypeComponent(&quot;XXXType&quot;) Type组件，存在于Teamcenter的所有数据类型对象中，比如Item、Dataset、 Folder、 Revision等。 这种Type组件主要用于执行一些.如对象的创建、对象的查找等功能。因此，当需要创建对象的时候，首先应该想到通过Type实现。 以下是一些常用的Type: 表单: TCComponentFormType Item对象: TCComponentItemType 版本对象: TCComponentItemRevisionType 数据集: TTCComponentDatasetType 文件夹: CComponentFolderType 分类对象: TCComponentICOType 项目: TCComponentProjectType 查询: TCComponentQueryType 流程: TCComponentProcessType 时间表: TCComponentScheduleType BOM行: TCComponentBOMLineType BOM: TCComponentBOM WindowType 工艺对象: TCComponentMEProcessType 例如创建文件夹功能代码如下: 1 2 3 TCComponentFolderType type = (TCComponentFolderType) tcSession.getTypeComponent(&quot;Folder&quot;); TCComponentFolder f= type.create(&quot;My Folder Name&quot;, &quot;MyFolder Description&quot;，&quot;My Folder Type&quot;); getTypeComponent函数中传递的参数，多数情况下， 就是TCComponentXXXType中的XXX。但是也有特列。更准确的说这个参数应该与对象的存储类名–致。例如: 1 2 3 TCComponentQueryType queryType = (TCComponentQueryType)tcSession.getTypeComponent(&quot;ImanQuery&quot;); TCComponentProjectType tcComponentProjectType =(TCComponentProjectType)tcSession.getTypeComponent(&quot;TC_ Project&quot;); TCComponentProcessType processType =(TCComponentProcessType) tcSession.getTypeComponent(&quot;Job&quot;); 对于自定义的对象类型N4MTMOPTrackingRevision，获取参数的 代码如下: 1 TCComponentType tcComptype =tcSession.getTypeComponent(&quot;N4MTMOPTrackingRevision&quot;); 获取Service服务 以下是在二次开发过程中常用的几个服务: (1)首选项服务，可以操作与首选项相关的大部分操作。 1 TCPreferenceService preferenceService =tcSession. getPreferenceService(); (2)分类管理服务，可以完成大部分分类管理操作，包括创建 分类对象、查找分类对象、获取分类结构信息等。 1 TCClassificationService classi ficationService =tcSession. getClassificationService(); 3.6创建TC对象 TCAPI接口 TCComponent TCComponentItem TCComponentI temRevision . TCComponent ItemType . TCComponentFolderType TCComponentUser TCComponentPerson TCComponentGroup TCComponentRole TCComponentForm TCComponentBOMW indow TCComponentRevi si onRule . TCComponentiTextField JCheckBox JFi 1 eChooser JButton JPanel JLabel JTextArea LOVComboBox，LOVUIComponent,TCComponentListOfValues Jtable JDialog DateButton Teamcenter中对象的创建一般都是通过会话获取要创建 对象的类型，然后再根据类型去创建具体的数据对象。每种 对象的创建用的函数方法都不一样。下面将根据不同对象的 创建方式进行说明: 1. Folder 的创建。 2. Form的创建。 3. Item的创建。 4. Dataset 的创建。 Folder 文件夹的创建需要对三个参数赋值，即文件夹名称、文件夹描述、文件夹的类型，以下是系统中创建文件夹的代码。 1 2 3 TCComponentFolderType t = (TCComponentFolderType) session. getTypeComponent (&quot;Folder&quot;) ; TCComponentFolder f=t. create(&quot; My Folder Name ”，” MyFolder Description&quot;, &quot;My Folder Type&quot;) ; Form的创建: Form的创建和Folder的创建类似，需要对三个参数赋值。Form名称、Form描述，以及Form类型。 1 2 TCComponentFormType tccomponentFormType = (TCComponentFormType)session. getTypeComponent (&#39; MyForm&#39; ) ; TCComponentForm tccomponentForm =tccomponentFormType.create (&#39; MyForm&#39;, &quot;MyFormDescription&quot;,&quot;MyForm&quot;) ; Item的创建: Item的创建相对来说比前两个都复杂点，具体原理就是先根据系统类型从系统中获取编码和版本编码，然后进行创建。 item _ID和item Revision获取方法: java TCComponentItemType tccomponentitemtype =(TCComponentItemType)session.getTypeComponent(itemType) ; String itemId = tccomponentitemtype.getNewID(); String itemRev = tccomponentitemtype.getNewRev(); Item单位获取方法 1 2 TCComponentType uom=session.getTypeComponent(UnitOfMeasure); TCComponent[] uoms = uom.extent() ; Item创建方法 1 2 3 TCComponentItem item =tccomponent i temtype. create (i temId, i temRev, itemType, itemName, i temD escription, uoms[0]); ((TCComponentFolder)target).add(contents,item) ; Dataset的创建方法 数据集的创建涉及到命名引用，创建过程:先创建某一一个类型的数据集，然后把命名引用添加上去。代码如下: 1 2 3 4 5 6 7 String as1[] = {url}; String as2[] = {&quot;Text&quot;}; String as3[] = {&quot;Text&quot;}; String as4[] = {&quot;P1ain&quot;}; TCComponentDatasetType tccomponentDatasetType =(TCComponentDatasetType)session. getTypeComponent(&quot;Text&quot;) ; TCComponentDataset tccomponentDataset =tccomponentDatasetType.create(dataFileName,&quot;Text&quot;,&quot;Text&quot;) ; tccomponentDataset.setFiles (as1,as2,as3,as4,); 查询构建器的调用 Teamcenter中有专门的查询构建器模块，我们可以通过配置查询构建器，然后通过代码对系统中的对象进行搜索，以下是调用代码: 1 2 3 4 TCTextService tcTextService = session.getTextService() ; String asKey[] = tcTextService.getTextValue(item_id) ; String asValues[] =00001; InterfaceAIFComponent interfaceAifComponent [] =session.search(ItemId...,asKey,asValues) ; Teamcenter中BOM结构的构建 Teamcenter中的BOM结构建立，具体方法是先在系统中创建B0MWindow对象，然后再得到B0MLine对象，分别在BOMLine.上进行添加即可，实现代码如下: 获取版本规则 1 2 TCComponentRevisionRuleType tcComponentRevisionRuleType =(TCComponentRevisionRuleType)session. getTypeComponent (&quot;RevisionRule&quot;) ; TCComponentRevisionRule tcComponentRevisionRule =tcComponentRevisionRuleType. getDefaultRule() ; 创建BOMWi ndow 1 2 TCComponentBOMWindowType tcComponentBomWindowType =(TCComponentBOMWindowType) session.getTypeComponent (&quot;BOMWindow&quot;) ; TCComponentBOMWi ndow tcComponentBomWindow =tcComponentBomWindowType. create(tcComponentRevisionRule) ; 获取BOMLine的两种方法 1 TCComponentB0MLine line= ((AbstractPSEApplication)app).getTopBOMLine() ; 1 TCComponentBOMLine []Lines= ( (AbstractPSEApplication) app).getSelectedBOMLines() ; 添加对象到BOMLine 1 TCComponentBOMLine tcComponentBomLine1 =tcomponentBomWindow.setWindowTopLine (tcComponentItem,tcComponentI temRevision1，tcComponent,tcComponent1) ; Java调用c的方法 有时候某些功能需要Java程序和C语言程序同时去处理，以下是Java程序调用C语言程序的方法，以调用C语言程序来创建I tem为例: 1 2 3 4 5 6 7 8 9 TCUserService userServ = sessionObj.getUserService() ; Object objs = new Object[3]; String itemId = new String( &quot;1234&quot;); String itemRev = new String (&quot;A&quot;); String itemName = new String (&quot;Nameof1234&quot; ); objs[0] = itemId; objs[1] = itemRev; objs[2] = itemName; TCComponent itemComp = (TCComponent) userServ.call ( &quot;createItem&quot;,objs) ; 通过以下的方式，可以取得目前的session user所属的newstuff folder, 并将objects贴附在这个folder下 1 2 TCComponentFolder newStuffFolder=tcfolder. getNewStuffFolder (session) ; newStuffFolder.add (&quot;contents&quot;,tcComponentItem) ; 通过以下的方式，建立一个已经存在的workflow template, 并将i tem贴附到target中: 1 2 3 4 5 TCComponentProcessType tcComponentProcessType= (TCComponentProcessType) session. getTypeComponent(&quot;Job&#39; ) ; TCComponentProcess newProcess:s= (TCComponentProcess) tcComponentProcessType.create (PROCESS NAME， PROCESS DESC ，WORKFLOW TEMPLATE NAME，TCComponent[], Target : 1) ; TCComponentTaskTemplateType tcComponentTaskTemplateType =(TCComponentTaskTemplateType) session. getTypeComponent ( &quot;EPMTaskTemplate&quot;); tcComponentTaskTemplate=tcComponentTaskTemplateType.extentReadyTemplates (true) ; 第四章 菜单定制是各种软件及其开发平台都会提供的必备功能。Teamcenter平台继承自Eclipse平台，其菜单功能与Eclipse平台是一脉相承的，因此Teamcenter平 台也提供了丰富的菜单功能项。如何实现Teamcenter的菜单功能，是Teamcenter二次 开发者必须掌握的重要技能。本章节将重点介绍Teamcenter中菜单的定制方法，并且以示例的方式引导读者深入了解Teamcenter的菜单定制功能。 菜单定制 Teamcenter Rich Client客户端本身是一个RCP程序，Teamcenter菜单的扩展遵循Ecl ipse菜单扩展的规则，给开发 人员提供了很好的用户体验。 Teamcenter菜单种类包括: 主菜单. 上下文菜单 视图/编辑器菜单 工具栏按钮 发送到菜单 切换菜单项Toggle menu Item Teamcenter主菜单 主菜单一般位于软件的最顶层。下 图中的Sample Menu， 就是二次开发定制的主菜单，我们称这类菜单为一级主菜单。点开一-级主菜单“编辑”后，展开的一般是二级主菜单。Teamcenter平台即支持定制一 级菜单，也支持在OOTB平台.上定制二级菜单。主菜单在哪些应用程序显示，在什么情况下显示，也是可以定制的。 上下文菜单 上下文菜单(Context Menu)，也称为快捷菜单(Shortcut Menu) ,右键点击时才会出现，出现频率较高的菜单项才会出现在上下文菜单中。上下文菜单具有很强的灵活项，随着点击对象的不同，弹出的菜单也会有相应的变化。 视图/编辑器菜单 视图/编辑器菜单(ViewPart/EditorPartMenu)，最右侧弹出的就是“详细信息”视图的菜单。这部分区域的菜单，也是可定制的。 工具栏按钮 工具栏(Toolbar) 是显示位图式按钮行的控制条，使用位图式按钮用来执行命令。按工具栏按钮相当于选择菜单项;如果某个菜单项具有和工具栏按钮相同的ID，那么使用工具栏按钮将会调用映射到该菜单项的同一个处理程序。可以配置按钮，使其在外观和行为上表现为普通按钮、单选按钮或复选框。 菜单扩展点 按照RCP开发方式，菜单配置信息位于plugin. xml文件中,Teamcenter提供了两种扩展点供用户添加菜单到相应的位置: org.eclipse.ui.actionSets,简称为Actions方式; org.eclipse.ui.commands，简称为Commands方式。 Actions,方式为界面上不同区域的表现方式提供了相应的扩展点，并且没有分离其界面表现和内在实现。主要在Teamcenter2007及以前的版本使用，后续版本使用Commands方式扩展。因此，课程仅讲解Commands方式的菜单项扩展。 Commands;方式通过三步设置，有效的达到界面表现和内部实现的分离: 通过org. eclipse. ui. commands 扩展点创建命令和类别(Category)，并且可以把某些命令放在- 一个类别(Category) 中; 通过org. eclipse. ui. menus指定命令出现在界面的哪个区域(视图菜单/主菜单/上下文菜单) ; 通过org. eclipse. ui. handlers指定命令的实现。 针对上下文菜单，除了Actions方式和Comnands方式均可创建外，Eclipse还提供了另外一●种创建上下文菜单的扩展点 org. ecl ipse. ui. popupMenus,简称为popupMenus方 式。 采用Commands方 式创建视图菜单，需要引入org. ecl ipse. ui. menus扩展点、org. eclipse. ui. handlers扩 展点和org. eclipse. ui. bindings扩展点。相关知识点包括: 菜单项扩展点 locationURI语法规则 菜单显示/隐藏控制方法 菜单项扩展点 在具体介绍各菜单扩展点时，我们使用3.3节“hello,world command” 工程中自动创建的菜单，这份配置主要包括 四个扩展点: 第一个扩展点，定义了命令ID: 1 com.teamcenter.helloworld.commands.sampleCommnand 在这个扩展点中，主要定义command id。 1 2 3 4 5 6 7 &lt;extension point=&quot;org.eclipse.ui.commands&quot; &gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.helloworld.commands.category&quot;&gt; &lt;/category&gt; &lt;command name= =&#39; Sample Command&quot; categoryId=&quot; com.teamcenter.helloworld.commands.category&quot; id=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; 第三个扩展点，是给COMMANID增加快捷键的绑定。这个 扩展点主要用于增强用户体验。M1+6代表了当按下快捷键. Ctr1+6时也会执行相应的命令，M2代表Shift。 1 2 3 4 &lt;extension point=&quot; org. eclipse. ui. bindings&#39; &gt; &lt;key commandId=&quot; com.teamcenter.helloworld.commands.sampleCommand&quot; contextId=”org.eclipse.ui.contexts.window&quot; sequence=“M1+6&quot;schemeId=&quot; org. eclipse. ui. defaul tAcce leratorConf iguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; 第四个扩展点，完成了采单的定义。这个扩展点需要重 点掌握，我们大部分的菜单配置项，都在这个扩展点中实现。. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 &lt;extension point=&quot; org.eclipse.ui.menus&quot; &gt; &lt;menuContribution locat ionURI=&#39; menu:org. eclipse. ui. main. menu?after additions&#39; &gt; &lt;menu 1abe1=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id= &#39;com.teamcenter.helloworld.menus.sampleMenu&#39;&gt; &lt;command commandId= =&quot; com. teamcenter. hellowor ld. commands. sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot; com. teamcenter. hel lowor ld. menus. sampl eCommand”&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI= toolbar:org.eclipse.ui.main.toolbar?after=additions&#39; &gt; &lt;toolbar id= &quot;com.teamcenter.helloworld.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot; com. teamcenter. hel loworld. commands. sampl eCommand&quot; icon :&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot; com.teamcenter.helloworld.toolbars.sampleCommand^ &gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;/extension&gt; locationURI语法规则 在定义菜单在Teamcenter出现的位置，需要设置locationURI的参数值。locationURI属性格式如 下: 1 &lt;menuContribution locationURI=&quot;[Scheme]:[id] ? [argument-list] &quot;&gt; 其中: Scheme 为该菜单项出现的区域，为menu、popup、toolbar中 的任何一个。 id为菜单区域ID,即现在已经存在的菜单ID、视图ID。 argument-list为该菜单项出现在指定菜单的位置。 主菜单定义 通过Commands 方式把菜单项添加到主菜单及其工具栏上，和视图菜单一样，也是通过扩 展点org. eclipse. ui. menus ;实现，需要设定其menuContribution的locationURI。 例如，添加一个菜单(菜单可以包含若干个菜单项)到主菜单栏中的某一个位置，其locationURI 为: 1 menu:org.eclipse.ui.main.menu?before=Edit 例如，把菜单项添加到已经存在的菜单当中。例如，添加-一个菜单项到File主菜单当中，其locationURI为: 1 menu:File?after=addition 例如，在DetailsView的 下拉菜单加一一个 菜单项，其MenuContribution的locationURI 应为: 1 menu: org.eclipse.ui.views.DetailsView?after=additions 快捷键参数 1 2 D:\\Siemens\\Teamcenter10\\portal\\portal.bat -nl zh_CN D:\\Siemens\\Teamcenter10\\portal\\portal.bat -nl en_US plugin.xml文件中定义的脚本程序： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;c9.mycustom.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;c9.mycustom.commands.category&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;c9.mycustom.commands.sampleCommand&quot; class=&quot;c9.mycustom.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;c9.mycustom.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?before=Edit&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;c9.mycustom.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt;; &lt;reference definitionId=&quot;com.teamcenter.rac.cme.mpp.inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:file?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand3&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;c9.mycustom.toolbars.sampleToolbar&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;c9.mycustom.toolbars.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand2&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView?after=additions&quot;&gt; &lt;command commandId=&quot;c9.mycustom.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; mnemonic=&quot;S&quot; id=&quot;c9.mycustom.commands.sampleCommand22&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 上下文菜单 Commands;方式与添加视图菜单和主菜单的方式-样，通过设定其menuContribution的locationURI 来实现。 例如，添加一个上下文菜单到快捷菜单中，其locat ionURI为: popup:org.eclipse.ui.popup.any?after=additions 菜单显示/隐藏控制方法 菜单控制是-一个常见的功能。例如，随着选定的内容或当前窗口的不同，菜单中的菜单项会有相应的变化(显示/隐藏或启用/禁用菜单项)。如何控制菜单是插件开发必须掌握的知识。Eclipse为菜单控制提供了两种方法，一种是通过扩展点;另一种是通过API的方式编写程序控制。通过Command方式创建的菜单，可以通过org. eclipse. ui. commands的visibleWhen 属性控制菜单的显示和隐藏。visibleWhen是用于控制菜单显示的核心表达式。该标签即可位于menu标签之下，也可位于command标签之前。尽管从官方的语法说明来看，可以作用于toobar标签下，但是经过测试toolbar 下的visibl eWhen标签不生效。通过org. eclipse. ui. handlers的activewhen 或enabledWhen 控制菜单的启用或禁用。 visibleWhen可以用在command、menu子节点下在menu标签下，添加如下代码，可以让该菜单及其子菜单，仅仅显示在“我的Teamcenter”、“制造工艺规划器中”和“分类”。“or.”标签用于在多个应用程序中显示。 1 2 3 4 5 6 7 8 &lt;visibleWhen&gt; &lt;or&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective”&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. cme. mpp. inMainView&#39;&gt;; &lt;reference definitionId=&quot; com. teamcenter. rac. classification. icm. inMainView&quot; &gt;; &lt;/or&gt; &lt;/visibleWhen&gt; Teamcenter中常见的应用程序ID如下: “我的Teamcenter”: com.teamcenter. rac. ui.inMainPerspective “制造工艺规划器”: com.teamcenter. rac. cme. mpp. inMainView “结构管理器”: com. teamcenter. rac. pse. inMainView . “分类管理”: com. teamcenter. rac. classification. icadmin. inMainView “分类”:com. teamcenter. rac. classification. icm. inMainView “入门”: com. teamcenter. rac. gettingstarted. inMainView “项目”: com. teamcenter. rac. project. inMainView 实践练习一： 加载项目c9. mycustom，查看其扩展的设置方式，并修改: 自定义菜单sampl eCommand在Main menu中 出现的位置,出现在windows菜单中; 自定义菜单sampleCommand出现在上下文菜单中。 实践练习二： 定义两个主菜单报表输出、功能 报表输出含有：产品报表导出 功能：创建项目文件夹、创建数据文件夹、修改技术文档ID 实例 工具栏toolbar 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addbutton.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; class=&quot;com.mycom.addbutton.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;toolbar:navigator_Toolbar?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addbutton.commands.sampleCommand&quot; icon=&quot;icons/sample.gif&quot; tooltip=&quot;Say hello world&quot; id=&quot;com.mycom.addbutton.toolbars.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 菜单栏中添加一个新的菜单 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; class=&quot;com.mycom.addmenuitem.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:tools?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addmenuitem.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addmenuitem.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package com.mycom.addmenuitem.handlers; import org.eclipse.core.commands.AbstractHandler; import org.eclipse.core.commands.ExecutionEvent; import org.eclipse.core.commands.ExecutionException; import org.eclipse.ui.IWorkbenchWindow; import org.eclipse.ui.handlers.HandlerUtil; import org.eclipse.jface.dialogs.MessageDialog; /** * Our sample handler extends AbstractHandler, an IHandler base class. * @see org.eclipse.core.commands.IHandler * @see org.eclipse.core.commands.AbstractHandler */ public class SampleHandler extends AbstractHandler { /** * The constructor. */ public SampleHandler() { } /** * the command has been executed, so extract extract the needed information * from the application context. */ public Object execute(ExecutionEvent event) throws ExecutionException { IWorkbenchWindow window = HandlerUtil.getActiveWorkbenchWindowChecked(event); MessageDialog.openInformation( window.getShell(), &quot;Addmenuitem&quot;, &quot;demo&quot;); return null; } } 菜单栏选项 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.toggleexample.commands.category&quot;&gt; &lt;/category&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleInfoHandler&quot; id=&quot;com.mycom.toggle.commands.infoCommand&quot; name=&quot;Info&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:true&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleWarnHandler&quot; id=&quot;com.mycom.toggle.commands.warnCommand&quot; name=&quot;Warn&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;command categoryId=&quot;com.mycom.toggle.commands.category&quot; defaultHandler=&quot;com.mycom.toggle.handlers.ToggleErrorHandler&quot; id=&quot;com.mycom.toggle.commands.errorCommand&quot; name=&quot;Error&quot;&gt; &lt;state class=&quot;org.eclipse.ui.handlers.RegistryToggleState:false&quot; id=&quot;org.eclipse.ui.commands.toggleState&quot;&gt; &lt;/state&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu id=&quot;com.mycom.toggle.menus.sampleMenu&quot; label=&quot;Error Level&quot; mnemonic=&quot;L&quot;&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.infoCommand&quot; label=&quot;Info&quot; mnemonic=&quot;I&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.warnCommand&quot; label=&quot;Warn&quot; mnemonic=&quot;W&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;command commandId=&quot;com.mycom.toggle.commands.errorCommand&quot; label=&quot;Error&quot; mnemonic=&quot;E&quot; style=&quot;toggle&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 在右键上添加 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.addshortcut.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; class=&quot;com.mycom.addshortcut.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.mycom.addshortcut.commands.sampleCommand&quot; mnemonic=&quot;S&quot; icon=&quot;icons/sample.gif&quot; id=&quot;com.mycom.addshortcut.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command id=&quot;CustNewItem&quot; name=&quot;Create New Item&quot;&gt; &lt;command id=&quot;CustNewDataset&quot; name=&quot;Create New Dataset&quot;&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;CustNewDataset&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;handler commandId=&quot;CustNewItem&quot; class=&quot;com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions&quot; &gt;; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewItem&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;CustNewDataset&quot;&gt;&lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 视图 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.6&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;Sample Command&quot; id=&quot;com.mycom.customview.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; class=&quot;com.mycom.customview.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;Sample Menu&quot; mnemonic=&quot;M&quot; id=&quot;com.mycom.customview.menus.sampleMenu&quot;&gt; &lt;command commandId=&quot;com.mycom.customview.commands.sampleCommand&quot; mnemonic=&quot;S&quot; id=&quot;com.mycom.customview.menus.sampleCommand&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.mycom.customview.inMainView&quot; &gt;; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.views&quot;&gt; &lt;view name=&quot;MyCom Custom View&quot; class=&quot;com.mycom.customview.views.CustomView&quot; id=&quot;com.mycom.customview.views.CustomView&quot;&gt; &lt;/view&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.core.expressions.definitions&quot;&gt; &lt;definition id=&quot;com.mycom.customview.inMainView&quot;&gt; &lt;with variable=&quot;activePartId&quot;&gt; &lt;equals value=&quot;com.mycom.customview.views.CustomView&quot; &gt;; &lt;/with&gt; &lt;/definition&gt; &lt;/extension&gt; &lt;/plugin&gt; 退出 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;category name=&quot;Sample Category&quot; id=&quot;com.teamcenter.rac.exit.commands.category&quot;&gt; &lt;/category&gt; &lt;command name=&quot;Sample Command&quot; categoryId=&quot;com.mycom.exitcommand.commands.category&quot; id=&quot;com.mycom.exitcommand.commands.sampleCommand&quot;&gt; &lt;/command&gt; &lt;command defaultHandler=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot; id=&quot;com.mycom.exitcommand.command1.Exit&quot; name=&quot;Exit&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; class=&quot;com.mycom.exitcommand.handlers.SampleHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.bindings&quot;&gt; &lt;key commandId=&quot;com.mycom.exitcommand.commands.sampleCommand&quot; contextId=&quot;org.eclipse.ui.contexts.window&quot; sequence=&quot;M1+6&quot; schemeId=&quot;org.eclipse.ui.defaultAcceleratorConfiguration&quot;&gt; &lt;/key&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:com.teamcenter.rac.ui.views.DetailsView?after=group4&quot;&gt; &lt;menu id=&quot;closeMenu&quot; label=&quot;Close&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:com.teamcenter.rac.ui.views.DetailsView&quot;&gt; &lt;toolbar id=&quot;com.mycom.exitcommand.toolbar1&quot;&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;command commandId=&quot;com.mycom.exitcommand.command1.Exit&quot; icon=&quot;icons/sample.gif&quot; label=&quot;Exit&quot; style=&quot;push&quot; tooltip=&quot;Exit the application&quot;&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 综合 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;?eclipse version=&quot;3.4&quot;?&gt; &lt;plugin&gt; &lt;extension point=&quot;org.eclipse.ui.commands&quot;&gt; &lt;command name=&quot;新建文件夹&quot; id=&quot;com.origin.custom.handler.newFolderHandler&quot;&gt; &lt;/command&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.handlers&quot;&gt; &lt;handler commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; class=&quot;com.origin.custom.handler.NewFolderHandler&quot;&gt; &lt;/handler&gt; &lt;/extension&gt; &lt;extension point=&quot;org.eclipse.ui.menus&quot;&gt; &lt;menuContribution locationURI=&quot;menu:org.eclipse.ui.main.menu?after=additions&quot;&gt; &lt;menu label=&quot;客户化菜单(M)&quot; mnemonic=&quot;M&quot; id=&quot;customMenus&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customMenus&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menu&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;toolbar:org.eclipse.ui.main.toolbar?after=additions&quot;&gt; &lt;toolbar id=&quot;customToolbar&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; icon=&quot;icons/newfolder_16.png&quot; tooltip=&quot;新建文件夹&quot; id=&quot;customToolbar&quot;&gt; &lt;/command&gt; &lt;/toolbar&gt; &lt;/menuContribution&gt; &lt;menuContribution locationURI=&quot;popup:org.eclipse.ui.popup.any?after=additions&quot;&gt; &lt;command commandId=&quot;com.origin.custom.handler.newFolderHandler&quot; mnemonic=&quot;S&quot; icon=&quot;icons/newfolder_16.png&quot; id=&quot;customPopup&quot;&gt; &lt;visibleWhen&gt; &lt;reference definitionId=&quot;com.teamcenter.rac.ui.inMainPerspective&quot;&gt; &lt;/reference&gt; &lt;/visibleWhen&gt; &lt;/command&gt; &lt;/menuContribution&gt; &lt;/extension&gt; &lt;/plugin&gt; 第五章 五代码化定制任务 5.1.1无代码化定制 实例:定制Teamcenter 胖客户端logon window.通过定制com.teamcenter.rac.kernel version.jar文件， 当登录TC时，可以改变加载的登录界面。 1、自定义登录窗口(logon window) 使用解压缩包工具打开%TC _RO0T%\\portal\\plugins\\com.teamcenter.rac.kernel_10000.1. 0.jar文件，替换\\icons’下的background. png文件。 注意:修改原始文件前，先做好备份，并去掉. jar后缀名。 2、按照清理TC缓存的方法，删除C: \\Documents andSettings \\Admini strator \\Teamcenter*目录，重新打开TC验证功能。 1、修改Views,Dial og boxes,Forms，Wizards的布局和内容 可以使用渲染文件Style sheets来改变Teamcenter views, dialogboxes, forms,和wizards using的布局与内容。Style sheets是一种数据集类型，使用Style sheets可以按照实际需求加载定制的数据属性。可供修改的数据对象包括Views，Dialog boxes，Forms的窗口信息。使用渲染文件进行定制的步骤如下 (1)在TC的Newstuff文件夹中新建XMLRenderingStylesheet数据集。例如，要修改汇总(Summary)视图的布局和加载属性，可以命名数据集为myItemSummary。 (2)使用“数据集…..”查询，检索系统中现有的XMLRenderingStylesheet,找到Itemsummary数据集。 ```xml &lt;?xml version=”1.0” encoding=”UTF-8”?&gt; ; ; ; ; ; ; &lt;/header&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; &lt;/section&gt; ; &lt;/section&gt; &lt;/column&gt; ; &lt;/section&gt; ; ; ; &lt;/column&gt; &lt;/page&gt; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; ; ; ; ; ; &lt;/treeDisplay&gt; ; ; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; ; ; &lt;/command&gt; ; ; &lt;/command&gt; &lt;/objectSet&gt; &lt;/page&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; &lt;/tableDisplay&gt; &lt;/objectSet&gt; ; &lt;/section&gt;","headline":"Teamcenter学习","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/teamcenter%E5%AD%A6%E4%B9%A0/"},"url":"http://localhost:4000/posts/teamcenter%E5%AD%A6%E4%B9%A0/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Teamcenter学习 | Allen
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Allen">
<meta name="application-name" content="Allen">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
    </a>

    <h1 class="site-title">
      <a href="/">Allen</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Xiaodong</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/AllenXDong"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/AllenXDong"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['316739861','qq.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>Teamcenter学习</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Teamcenter学习</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1701187200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov 29, 2023
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1701312824"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov 30, 2023
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">AllenXDong</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="23257 words"
>
  <em>129 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <li><a href="#teamcenter笔记">Teamcenter笔记</a>
<ul>
<li><a href="#概述">概述</a>
<ul>
<li><a href="#客户端定制">客户端定制</a></li>
<li><a href="#服务端定制">服务端定制</a></li>
</ul></li>
<li><a href="#第一章">第一章</a></li>
<li><a href="#第二章">第二章</a>
<ul>
<li><a href="#2-1对象模型和系统框架">2.1对象模型和系统框架</a>
<ul>
<li><a href="#item和item-revision模型">Item和Item Revision模型</a></li>
<li><a href="#pom">POM</a></li>
<li><a href="#item">Item</a></li>
<li><a href="#item-revision">Item Revision</a></li>
<li><a href="#动态类型">动态类型</a></li>
<li><a href="#relations">Relations</a></li>
<li><a href="#修改item-item-recision">修改Item/Item Recision</a></li>
<li><a href="#属性及属性分类">属性及属性分类</a></li>
<li><a href="#dataset-model">Dataset Model</a></li>
<li><a href="#form-model">Form Model</a></li>
</ul></li>
</ul></li>
<li><a href="#第三章">第三章</a>
<ul>
<li><a href="#3-1客户端开发技术">3.1客户端开发技术</a>
<ul>
<li><a href="#3-11awt-java-swing">3.11AWT &amp; Java Swing</a>
<ul>
<li><a href="#rcp的概念">RCP的概念</a></li>
<li><a href="#透视图-perspective">透视图 perspective</a></li>
<li><a href="#视图-view">视图 View</a></li>
</ul></li>
</ul></li>
<li><a href="#3-2teamcenter插件开发">3.2Teamcenter插件开发</a>
<ul>
<li>
<ul>
<li><a href="#对插件程序的注册方法">对插件程序的注册方法: .</a></li>
</ul></li>
</ul></li>
<li><a href="#3-3tc开发环境搭建">3.3TC开发环境搭建</a>
<ul>
<li>
<ul>
<li><a href="#创建tc插件项目">创建TC插件项目</a></li>
<li><a href="#配置反编译环境">配置反编译环境</a></li>
</ul></li>
</ul></li>
<li><a href="#3-4客户化开发常用接口">3.4客户化开发常用接口</a>
<ul>
<li><a href="#com-teamcenter-rac-aifrcp">com.teamcenter.rac.aifrcp</a></li>
<li><a href="#com-teamcenter-rac-common">com.teamcenter.rac .common</a></li>
<li><a href="#com-teamcenter-rac-external">com.teamcenter.rac.external</a></li>
<li><a href="#com-teamcenter-rac-kernal">com.teamcenter.rac .kernal</a></li>
<li><a href="#com-teamcenter-rac-tcapps">com.teamcenter.rac.tcapps</a></li>
<li><a href="#任务要求">任务要求:</a></li>
</ul></li>
<li><a href="#3-5tcsession的使用">3.5TCSession的使用</a>
<ul>
<li><a href="#获取tcsession的三种办法">获取TCSession的三种办法</a>
<ul>
<li><a href="#从当前应用程序直接获取tc-session">从当前应用程序直接获取TC Session</a></li>
<li><a href="#从tccomponent对象上获取tc-session">从TCComponent对象上获取TC Session</a></li>
<li><a href="#通过isessionservice获取到tcsession">通过ISessionService获取到TCSession</a></li>
</ul></li>
<li><a href="#获取当前tc信息">获取当前TC信息</a></li>
<li><a href="#设置当前用户">设置当前用户</a></li>
<li><a href="#dba用户旁路功能打开">DBA用户旁路功能打开</a></li>
<li><a href="#获取type">获取Type</a></li>
<li><a href="#获取service服务">获取Service服务</a></li>
</ul></li>
<li><a href="#3-6创建tc对象">3.6创建TC对象</a>
<ul>
<li><a href="#tcapi接口">TCAPI接口</a></li>
<li><a href="#folder">Folder</a></li>
<li><a href="#form的创建">Form的创建:</a></li>
<li><a href="#item的创建">Item的创建:</a>
<ul>
<li><a href="#item-id和item-revision获取方法">item _ID和item Revision获取方法:</a></li>
<li><a href="#item单位获取方法">Item单位获取方法</a></li>
<li><a href="#item创建方法">Item创建方法</a></li>
</ul></li>
<li><a href="#dataset的创建方法">Dataset的创建方法</a></li>
<li><a href="#查询构建器的调用">查询构建器的调用</a></li>
<li><a href="#teamcenter中bom结构的构建">Teamcenter中BOM结构的构建</a>
<ul>
<li><a href="#获取版本规则">获取版本规则</a></li>
<li><a href="#创建bomwi-ndow">创建BOMWi ndow</a></li>
</ul></li>
<li><a href="#获取bomline的两种方法">获取BOMLine的两种方法</a></li>
<li><a href="#添加对象到bomline">添加对象到BOMLine</a></li>
<li><a href="#java调用c的方法">Java调用c的方法</a></li>
</ul></li>
</ul></li>
<li><a href="#第四章">第四章</a>
<ul>
<li><a href="#菜单定制">菜单定制</a>
<ul>
<li><a href="#teamcenter主菜单"><strong>Teamcenter主菜单</strong></a></li>
<li><a href="#上下文菜单">上下文菜单</a></li>
<li><a href="#视图-编辑器菜单">视图/编辑器菜单</a></li>
<li><a href="#工具栏按钮">工具栏按钮</a></li>
</ul></li>
<li><a href="#菜单扩展点">菜单扩展点</a>
<ul>
<li><a href="#菜单项扩展点">菜单项扩展点</a></li>
</ul></li>
<li><a href="#locationuri语法规则">locationURI语法规则</a>
<ul>
<li><a href="#主菜单定义">主菜单定义</a></li>
<li><a href="#上下文菜单-1">上下文菜单</a></li>
<li><a href="#菜单显示-隐藏控制方法">菜单显示/隐藏控制方法</a></li>
<li><a href="#实践练习一">实践练习一：</a></li>
<li><a href="#实践练习二">实践练习二：</a></li>
</ul></li>
<li><a href="#实例">实例</a>
<ul>
<li><a href="#工具栏toolbar">工具栏toolbar</a></li>
<li><a href="#菜单栏中添加一个新的菜单">菜单栏中添加一个新的菜单</a></li>
<li><a href="#在右键上添加">在右键上添加</a></li>
<li><a href="#视图">视图</a></li>
<li><a href="#退出">退出</a></li>
<li><a href="#综合">综合</a></li>
</ul></li>
</ul></li>
<li><a href="#第五章">第五章</a>
<ul>
<li><a href="#5-1-1无代码化定制">5.1.1无代码化定制</a></li>
<li><a href="#5-2-无代码化定制应用">5.2 无代码化定制应用</a></li>
<li><a href="#5-2-2-首选项">5.2.2 首选项</a></li>
<li><a href="#5-2-3访问权限管理">5.2.3访问权限管理</a></li>
</ul></li>
<li><a href="#第六章">第六章</a>
<ul>
<li><a href="#6-1-3-为什么需要报表开发">6.1.3 为什么需要报表开发</a></li>
<li><a href="#6-1-4-tc报表生成方式">6.1.4 TC报表生成方式</a></li>
</ul></li>
</ul></li>
<h1 id="teamcenter笔记">Teamcenter笔记</h1>
<h2 id="概述"><span class="me-2">概述</span><a href="#概述" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Teamcenter的标准功能基本可以供用户使用，但是基于每家公司业务问题以及使用习惯，还有一些特殊的应用与数据整合，所以会产生不同的业务需求，这个时候我们就需要通过客户化定制的方式去满足用户的应用。通过对TC系统的二次开发来实现客户化。</p>
<h3 id="客户端定制"><span class="me-2">客户端定制</span><a href="#客户端定制" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
<li><p>通过个性化定制让用户操作更加方便，提高用户的操作效率。比如一些对话框、操作界面等的定制，数据显示与表单定制，可以对系统中对象图标的显示、表单界面进行具体的定制与开发。</p></li>
<li><p>数据显示与表单定制：可以对系统中对象图标的显示、表单界面进行具体的定制与开发。</p>
<h3 id="服务端定制"><span class="me-2">服务端定制</span><a href="#服务端定制" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
<li><p>应用集成：</p>
<p>使用集成工具包（ITK）或服务（Teamcenter Service）进行定制，改变Teamcenter与外部应用集成时行为（behavior）。比如前处理，后处理，SOA接口，ITK函数，Handler等。</p></li>
<li><p>数据共享</p>
<p>通过定制开发可以使Teamcenter系统中的一些数据与别的系统共享，或者Teamcenter共享别的系统中数据，比较典型的有报表、CAD集成ERP集成、CAPP集成等。</p></li>
</ul></li>
</ul>
<h2 id="第一章"><span class="me-2">第一章</span><a href="#第一章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>1）查看\设置 TC命令行</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">set</span> <span class="no">TC_ROOT</span><span class="o">=</span><span class="nl">D:</span><span class="err">\</span><span class="nc">Siemens</span><span class="err">\</span><span class="nc">Teamcenter10</span>
  <span class="n">set</span> <span class="n">TC_Data</span><span class="o">=</span><span class="nl">D:</span><span class="err">\</span><span class="nc">Siemens</span><span class="err">\</span><span class="n">tcdata</span>
  <span class="n">call</span>  <span class="nl">D:</span><span class="err">\</span><span class="nc">Siemens</span><span class="err">\</span><span class="n">tcdata</span><span class="err">\</span><span class="n">tc_profilevars</span><span class="o">.</span><span class="na">bat</span> 
</pre></td></tr></tbody></table></code></div></div>
<p>2）运行TC命令：</p>
<ul>
  <li>清除TC死进程   clearlocks -verbose</li>
  <li>列出所有登录到TC的用户 list_users –u=infodba –p=infodba</li>
  <li>获取TC版本信息  install -ask_version</li>
  <li>导出某个Item到本地文件夹中 tcxml_export -u=infodba -p=infodba -file=D:\output.xml -item=000034 -rev=A -floder=Home</li>
  <li>文件卷信息备份   backup_xmlinfo -u=infodba -p=infodba -g=dba</li>
</ul>
<p>3）查看TC环境变量 ： <code>set TC</code></p>
<p>实践练习2：</p>
<p>1）运行TC命令：</p>
<p>（1）导出原始或旧的CAD属性映射文件  export_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt</p>
<p>（2）导入原始或旧的CAD属性映射文件 import_attr_mappings -u=infodba -p=infodba -g=dba -file=D:\attr.txt</p>
<p>实践练习3：</p>
<p>1）运行TC命令：</p>
<p>（1）游离数据收集命令： collect_garbage -u=infodba -p=infodba -g=dba -item -dataset -floder -report</p>
<p>（2）删除WASTE BASKET文件夹下所有没有引用的对象 collect_garbage -u=infodba -p=infodba -g=dba -all –delete</p>
<h2 id="第二章"><span class="me-2">第二章</span><a href="#第二章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="2-1对象模型和系统框架"><span class="me-2">2.1对象模型和系统框架</span><a href="#2-1对象模型和系统框架" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<h4 id="item和item-revision模型"><span class="me-2">Item和Item Revision模型</span><a href="#item和item-revision模型" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ol>
<li>POM</li>
<li><p>Item</p></li>
<li><p>|tem Revision</p></li>
<li><p>动态类型</p></li>
<li><p>Relation</p></li>
<li><p>属性及属性分类</p></li>
</ol>
<p>Teamcenter对象模型由管理数据的类组成
模型可描述成两个基本关系集图</p>
<ul>
<li>继承关系</li>
<li>关联关系</li>
</ul>
<p>对象模型原理</p>
<ul>
<li>Item and Item Revision Model</li>
<li>Dataset Model</li>
<li>Form Model</li>
<li>System Administration Model</li>
<li>Product structure object Model</li>
<li>Access control Model</li>
<li>Application encapsulation M lodel</li>
</ul>
<h4 id="pom"><span class="me-2">POM</span><a href="#pom" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>persistent Object Manager</p>
<p>POM是Teamcenter的核心模块，是应用模块与系统模块的接口，是一个提供内部程序员、第三方以及客户定义他们自己业务对象(business object) 的工具。</p>
<ul>
<li><p>系统模块通常是用0DBC访问0racle关系数据库或MS SQL Server</p></li>
<li><p>POM提供应用程序与系统模块比关系数据库表更高层次的抽象(如创建文件夹)，可以创建、存取他们自己的数据以及存取简单的TC数据</p></li>
<li><p>可以通过BMIDE (Bus iness Modeler IDE) 创建业务对象，而不是直接编辑表或写代码，提供了数据的面向对象浏览器，而不是SQL 表达式。</p></li>
</ul>
<h4 id="item"><span class="me-2">Item</span><a href="#item" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Item是TC中管理信息的最基本的对象，提供了用于组织信息、审计/变更控制的物理或概念上的实体。表示真实世界中的一个产品、部件或零件对象等，例如发动机总成、支架等。</p>
<p>ltem有以下基本信息:</p>
<ul>
<li>Item ID (必须唯一,可以是流水码)</li>
<li>|tem Name</li>
<li><p>Item type</p></li>
<li><p>Unitof Measure (Optional) 。</p></li>
<li><p>Description</p></li>
<li><p>最多240个字符</p></li>
</ul>
<p>其中Bus inessOb ject是所有类的基类，再往下是两个分支:</p>
<ul>
<li>POM_ object带有存储类的业务类</li>
<li>Runt imeBusinessOb ect动态类型</li>
</ul>
<p>Item类型是选择客户化继承类的首选基类。在Item这个视图下，有:存储类、父类、版本类、表单这四项。这里主要解释的是存储类。规则为:每个业务对象，都有一个存储类与之对应。另外同时注意:不同的业务对象可以共同对应于一个存储类。</p>
<h4 id="item-revision"><span class="me-2">Item Revision</span><a href="#item-revision" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Item Revision用于记录Item的历史
|tem Revision信息</p>
<ul>
<li>ID
<ul>
<li>Item的唯一 标识</li>
</ul></li>
<li>Revision</li>
<li>Name .</li>
</ul>
<h4 id="动态类型"><span class="me-2">动态类型</span><a href="#动态类型" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>例如:
BOML ine它实际是从种存储类.上获取属性从而计算得到的。其中包括PSOccur rence,Note，Item，ItemRev等等 属性可以加载到结构管理器。</p>
<h4 id="relations"><span class="me-2">Relations</span><a href="#relations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>TC用Re | at i on来关联数据的Item和Item Revision</p>
<p>ReIation描述了数据是怎样与Item和Ite Revision关联的</p>
<p>例:一个Dataset包含了CAD模型，这个模型由某个ItemRevisi on说明
例:一个标准文档描述了一个Item所需要特定草图的填充表单和功能</p>
<p>Item和ltem Revis ion可以与其他一些对象有关，包括Datasets，Forms， Fo Iders以及其他的Item和Item
Revision .</p>
<p>每个与Item关联的对象表示了该ltem的各个方面信息</p>
<p>TC提供了基本的关系集，对象与Item、Item Revision之间的关系取决于所执行的规则</p>
<ul>
<li>master_ Form
<ul>
<li>关联Form与Item或Item Revision</li>
<li>Form是Item或Item Revis ion的属性(Attr ibutes) 集合</li>
<li>关系规则
<ul>
<li>Item或Item Revis ion必须要有对Form添加、删除master_ Form关系的权限</li>
<li>一个Form与一个Item或Item Revision只能有一个master_ Form关系</li>
<li>一个Form的master_ Form关系只能对应一个Item或Item Revision</li>
</ul></li>
</ul></li>
</ul>
<p>TC提供了基本的关系集，对象与ltem、Item Revision之间的关系取决于所执行的规则</p>
<ul>
<li><p>requirement</p>
<ul>
<li><p>关联data与Item或Item Revision (如:草图的标准、Part的技术需求)</p></li>
<li><p>关系规则</p>
<ul>
<li><p>Item或Item Revis ion必须要有对一个对象添加、删除requirement关系的权限</p></li>
<li><p>Form与Item或Item Revis ion可以有一个requi rement关系</p></li>
<li><p>只有Dataset的0版本可以与Item或Item Revis i on有requi rement关系</p></li>
<li><p>Folder、 enve | ope、 BOM vi ew或BOM Revis i on不能与Item或ItemRevision有requirement关系</p></li>
<li><p>一个Item不能另外的Item或Item Revis ion有requi rement关系</p></li>
<li><p>一个Item Revis i on可以与另外的Item或Item Revis ion有requirement关系</p></li>
<li><p>一个Item Revision不能与另外的同- -个Item的Item Revision有requi rement关系</p></li>
<li><p>manifestation关联与Item或Item Revis ion相关其他数据</p></li>
<li><p>specification关联定义Item Revis ion的数据</p></li>
<li><p>reference关联数据与Item或Item Revision</p></li>
<li><p>Revision关联Item Revis ion与相应的Item</p></li>
<li><p>BOMView关联产品结构与Item</p></li>
<li><p>BOMView Revision关联产品结构Revision与Item Revision</p></li>
</ul></li>
</ul></li>
</ul>
<h4 id="修改item-item-recision"><span class="me-2">修改Item/Item Recision</span><a href="#修改item-item-recision" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
<li><p>当Item被创建时就有了ID 只有对Item添加了数据，Item才有意义</p></li>
<li><p>数据集(Dataset)用于其他应用中创建的信息，这些数据可以与Item和Item Revision关联</p></li>
<li><p>在TC中，ItemRevision和Datasetversion都可以表示修改信息</p>
<ul>
<li>Item Revis ion表示Item的明显变化</li>
<li>Dataset vers ion表示每天的变化</li>
</ul></li>
<li><p>修改Item、 Item Revis i on的方法</p>
<ul>
<li>通过cut、paste方法添加或移除Item与Item Revision的关系</li>
<li>修改与Item和ItemRevision相关的对象的内容</li>
</ul></li>
</ul>
<h4 id="属性及属性分类"><span class="me-2">属性及属性分类</span><a href="#属性及属性分类" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
<li>类定义了对象的类型(type of object) 、属性(Attr ibutes)和方法(methods)</li>
<li>在TC中，Attr ibute可以是: Integer， Float，Boolean， String,Date，Tag,Array</li>
<li>Tag唯一标识Reference和Relation</li>
<li>Attribute具有以下特性:
<ul>
<li>Unique</li>
<li>Protected:属性只能由创建该对象的应用修改</li>
<li>NULLallowed：如果这个特性不为true的话，对象不能保存</li>
<li>Upper bound (.上边界)</li>
<li>Lower bound (下边界)</li>
<li>Default value (默认值)</li>
</ul></li>
</ul>
<p>永久</p>
<blockquote>
<p>该类型的属性会在数据库中对应一条记录上的一个字段，从而得以保存</p>
</blockquote>
<p>运行时</p>
<blockquote>
<p>一顾名思义，只是运行时动态的属性，需要配合程序计算获得。</p>
</blockquote>
<p>复合</p>
<blockquote>
<p>复合属性，如不清楚可以
查看BMI DE使用帮助</p>
</blockquote>
<p>关系</p>
<blockquote>
<p>从TC8开始关系首先需要定义为属性。
TC2007是不需要的，只用首选项配置。</p>
</blockquote>
<p>其他对象模型</p>
<h4 id="dataset-model"><span class="me-2">Dataset Model</span><a href="#dataset-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>每个产品对象均有一些具体的数据文件来描述其不同方面的详细信息，如设计模型、计算说明、设计要求等。这些数据文件是由不同的应用软件产生的( 如CAD软件、0ffice软件等)，具有不同的表现形式(如Text文件、图形文件等)。</p>
<p>Teamcenter的Dataset (数据集)提供了管理各类应用软件所产生的文件的手段。不管是技术说明文件或CAD / CAM / CAE系统产生的图形数据文件，都可以用原来的形式或点阵形式或其它任何计算机形式的文件存放在Teamcenter系统中。</p>
<p>Dataset是用来管理(存放)应用软件生成的数据(文件)的-种对象。对应于不同类型(格式)的数据(文件)，Teamcenter 提供Dataset Type与之对应。</p>
<p>业务对象是用于详细说明TC对象的行为的</p>
<p>Dataset业务对象用于对Dataset分类</p>
<p>例:当Document Dataset数据打开时， 与该对象关联的WORD处理程序打开</p>
<p>当创建数据集时，会创建0和1两个版本，Revision 0总是指向最新的版本，所以最初时它指向Revision 1。如果创建了Revision 2,Revision 0就指向2。在编程时，如果希望获得最新的版本，就用Revision 0。</p>
<p>所有Dataset的版本都有相同的所有者(owning user)、组(group) 和保护(protect ion)机制。</p>
<p>ITK functions use this convention with R evisions asfollows:</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AE_ask_dataset</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Given any dataset, returns Revision 0.</p>
<p><code>AE_ask_dataset_first_rev
</code></p>
<p>Given any dataset, returns the oldest Revision.</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AE_ask_dataset_latest_rev</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Given any dataset, returns the most recent Revision (nothe Revision 0 copy).</p>
<p>Given any dataset, returns the most recent  evision (nothe Revision 0 copy).</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AE_ask_dataset_next_rev</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Given any dataset, returns the next Revision 1n the sequence.</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AE_ask_dataset_prev_rev</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Given any dataset, returns the previous Revision in the sequence</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AE_find_dataset</span> <span class="p">(</span><span class="s">"name"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Dataset</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Finds Revision 0 of the Dataset.</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AOM_refresh</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="nb">true</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Loads the given Dataset version for modification.</p>
<div class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="C"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">AOM_save</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Creates a new, later version of the Dataset and saves a copy to Revision 0.</p>
<h4 id="form-model"><span class="me-2">Form Model</span><a href="#form-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Form能存储用户定义的属性(Attr ibute), TC提供了标准Form模型。Form是POM对象，可以使用Form |TK函数存取Attr ibute</p>
<p>所有的POM_ appl icat ion_ _ob ject类和它的子类都有所有者和保护机制，只能被系统管理员修改</p>
<p>ACL (Access control | ist)实体由对组和/或用户以及子对象授权的引用组成。</p>
<p>子对象是TC中可以被授权的对象。</p>
<p>Teamcenter软件系统版本历史如下:</p>
<blockquote>
<p>Teamcenter Enterprise 4.0</p>
<p>Teamcenter Enterprise 5.0</p>
<p>Teamcenter Engineering 9.0</p>
<p>2005年: Teamcenter Engineering 2005</p>
<p>2007年: Teamcenter 2007</p>
<p>2009年:Teamcenter 8</p>
<p>2012年: Teamcenter 9</p>
<p>201 3年: Teamcenter10</p>
<p>201 6年:Teamcenter11</p>
<p>201 8年:Teamcenter1 2</p>
</blockquote>
<h2 id="第三章"><span class="me-2">第三章</span><a href="#第三章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="3-1客户端开发技术"><span class="me-2">3.1客户端开发技术</span><a href="#3-1客户端开发技术" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Teamcenter 胖客户端基于客户端-服务器架构模式，客户端和服务器层均可以定制开发。胖客户端具有UI界面，使用Java语言进行构建与定制。服务器端使用Integration Toolkit (ITK) 和  C/C++ 编程语言进行开发。</p>
<p>因为胖客户端基于Eclipse平台，开发时可以获取所有扩展点，作为Teamcenter 开发定制技术，可以使用如下三种方式定制客户端：</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">Base</span> <span class="nc">Eclipse</span> <span class="n">extension</span> <span class="n">points</span> <span class="n">and</span> <span class="nf">services</span> <span class="o">(</span><span class="n">使用org</span><span class="o">.</span><span class="na">eclipse</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">menus</span> <span class="n">extension</span> <span class="n">point</span><span class="o">).</span>
  <span class="nc">Teamcenter</span> <span class="n">extension</span> <span class="n">points</span> <span class="n">and</span> <span class="nf">services</span> <span class="o">(</span><span class="n">使用application</span> <span class="n">extension</span> <span class="n">points</span><span class="o">).</span>
  <span class="nc">Teamcenter</span> <span class="n">customization</span> <span class="nf">mechanisms</span> <span class="o">(</span><span class="n">使用style</span> <span class="n">sheets</span><span class="o">).</span>
</pre></td></tr></tbody></table></code></div></div>
<p>    基础定制技术用于在客户端创建具有用户界面的插件，并加以显示，需要熟练掌握Eclipse。</p>
<p>Teamcenter 提供几种界面，包括：</p>
<ul>
<li><p>胖客户端界面；</p></li>
<li><p>基于Web的瘦客户端界面；</p></li>
<li><p>业务建模器；</p></li>
<li><p>Teamcenter集成Microsoft Office；</p></li>
<li><p>Teamcenter集成CAX，ERP等</p></li>
</ul>
<p>因为胖客户端与瘦客户端接口开放了定制方法，仅提供此两种开发方式。</p>
<p>随着Teamcenter软件的发展和进步，利用新技术，尽可能灵活和简单化Teamcenter扩展和定制的能力。</p>
<ul>
<li>Back and Forward buttons</li>
<li>Application banner</li>
<li>Search box</li>
<li>Navigation pane</li>
<li>Application pane</li>
<li>Getting Started application button.</li>
<li>Primary applications</li>
<li>Secondary applications</li>
<li>Clipboard button</li>
</ul>
<h4 id="3-11awt-java-swing"><span class="me-2">3.11AWT &amp; Java Swing</span><a href="#3-11awt-java-swing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Abstract Windows Toolkit（AWT）是最原始的、具有有限 GUI 组件、布局管理和函数功能的工具包。AWT的主要优点是，它在 Java 技术的每个版本上都成为了一种标准配置，包括早期的 Web 浏览器中的 Java 实现。另外它也非常稳定，可以在任何一个以Java为基础的环境中运行使用。</p>
<p>AWT中包含了许多类和接口，用于Java Application的GUI编程。通过图形用户界面用户和程序之间可以方便地进行交互。</p>
<p>ava的抽象窗口工具包AWT由Java的java.awt包提供，该包中有许多用来设计GUI的组件类，如：按钮、菜单、列表、文本框等组件类，同事它还包含窗口、面板等容器类。</p>
<p>ava Swing是Java Foundation Classes（JFC）的一部分，它是在 AWT 组件基础上构建的，所有 Swing组件实际上也是 AWT 的一部分。在Swing 中，Sun 开发了一个经过仔细设计的、灵活而强大的 GUI工具包。</p>
<p>Swing 具有内嵌于Java 技术的优点，可完全移植的。Swing 也具有高级图形应用程序所需要的优点。SWT 具有可以作为本地应用程序实现的优点，这可以提高性能，并利用基于SWT 的GUI 来实现本地兼容性。</p>
<p>在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing与结合了JFace的SWT一起构建GUI。</p>
<p>在SWT之前，Sun已经提供了跨平台GUI开发工具包AWT。AWT框架底层使用原生窗口部件(native widgets)构建，只能使用各个平台窗口部件的子集。在大部分情况中，都是使用Swing 与结合了JFace 的SWT 一起构建GUI。
    Standard Widget Toolkit (SWT)，即标准部件工具包。它是一个Java平台下开放源码的Native GUI组件库，也是Eclipse平台的UI组件之一。如果只为一种平台来开发系统，那么SWT 就具有主机兼容性方面的优点，包括与主机特性的集成，例如在Windows 上对ActiveX控件的使用。
    Teamcenter2007以上都是采用SWT与Swing结合进行客户端构建的。</p>
<p>与 AWT 的概念相比，SWT 是一个低级的 GUI 工具包。JFace是一组用来简化使用SWT构建GUI的增强组件和工具服务。SWT的创建者为了建立一个只有两者的有点而没有缺点的系统，从AWT和Swing的实践中吸取了大量的经验。从很多方面来说，他们已经成功了。SWT 的 GUI 既具有主机外观，又具有主机的性能。这样就避免了使用 AWT 和 Swing 而引起的大部分问题。特定的主机具有一些低级功能控件，因此 SWT 提供了扩充版本，从而可以产生更一致的行为。</p>
<h5 id="rcp的概念"><span class="me-2">RCP的概念</span><a href="#rcp的概念" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>    RCP是Rich Client Platform的缩写，利用Eclipse核心平台和一些有用的插件，进行应用系统的构建。只要新的代码符合插件的代码结构，将代码放入工作空间后，Eclipse平台会自动加载新代码，构成新的Eclipse平台。</p>
<p>    Eclipse RCP 提供了标准化的组件模型，包括菜单，工具栏，以及可叠加的窗口组件(编辑器和视图)、按钮、表格、树形结构的支持。</p>
<p><strong>Eclipse RCP的优点</strong></p>
<ul>
<li><p>组件化：基于Eclipse的系统设计由被称为plug-ins的插件构成，可以通过扩展点进行配置，也可以被不同应用程序共享。</p></li>
<li><p>便利性:Eclipse RCP对各个平台下的产品包装提供了强有力的支持，其开发的RCP甚至可以在嵌入式设备、掌上电脑上运行。Sun公司对Java的口号是write once，run everywhere，Eclipse也可以说是RCP run everywhere。</p></li>
<li><p>智能安装和升级：Eclipse提供了专门的Update组件，可以实现通过HTTP、Web站点、复制等多种方式进行安装和更新，避免了早期胖客户端应用、部署升级的麻烦。</p></li>
<li><p>可扩展性：Eclipse基于插件进行扩展的思想使得用户可以方便地搭建各种规模、类型和用途的应用程序。按照Eclipse官方的说法，Eclipse RCP一开始就被设计为可扩展的。</p></li>
<li><p>使用体验：Eclipse为各种操作系统提供了本地图形接口包。当RCP运行时，Eclipse首先直接调用本机窗口组件，只有没有本机所需组件时才进行模拟。无论RCP在哪种操作系统上运行，都可以保持与本机一致的外观和行为。一个设计优良的富客户端，可以提供诸如拖曳操作、剪切板、导航等 UI元素。UI设计者也可以利用各种界面工具，轻松设计出完美的用户界面。</p></li>
</ul>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200317163944826.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200317163944826.png" alt="image-20200317163944826" loading="lazy"></a></p>
<p>CP中的每个视图都对应程序中的UI界面。每个透视图对应一个应用组合，如在Teamcenter中 ：我的Teamcenter、结构管理器、分类管理等。下图是以Teamcenter系统为例展示RCP应用程序运行的界面：</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC//image-20200317164014013.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC//image-20200317164014013.png" alt="image-20200317164014013" loading="lazy"></a></p>
<h5 id="透视图-perspective"><span class="me-2">透视图 perspective</span><a href="#透视图-perspective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>一个客户端可以运行多个透视图，但每次在界面中只显示一个透视图；在一个透视图中可以添加和重新排列视图，以在透视图中同时显示多个信息集；可以保存重排的透视图，并使用当前名字，也可以为新的排列创建一个新名字。系统管理员可以使用 HiddenPerspectives 首选项来显示/隐藏各个透视图功能。</p>
<h5 id="视图-view"><span class="me-2">视图 View</span><a href="#视图-view" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>视图中相关工作改变通常会对其他视图中的选项更改；视图中数据的更改会立即保存；视图在透视图中可以便捷的加载，当前透视图中的视图排列可以存储到本透视图，或者新创建的透视图中。</p>
<h3 id="3-2teamcenter插件开发"><span class="me-2">3.2Teamcenter插件开发</span><a href="#3-2teamcenter插件开发" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Eclipse的设计思想是:一切皆插件。Eclipse核心很小，其它所有功能都以插件的形式附加于Eclipse核心之上。Eclipse基 本内核包括:图形API (SWT/Jface)，Java开 发环境插件(JDT ),插件开发环境(PDE), JDT与PDE构成了Platform run-time。
Teamcenter胖客户端宿主于Eclipse胖客户端平台框架。RCP是一个通用的应用程序框架，通过使用插件，提供了模块化和基于可扩展的组件开发的支持。</p>
<p>PDE和Java Deve lopment Tooling (JDT) IDE 是Eclipse的标准扩展。PDE提供了一些向导以帮助创建插件。
Workbench和Workspace是 Eclipse平台的两个必备的插件它们.</p>
<p>提供了大多数插件使用的扩展点。插件需要添加到扩展点才可以运行。Workbench组件包含了一些扩展点，允许插件扩展Eclipse 用户界面，使这些用户界面带有菜单选择和工具栏按钮;请求不同类型事件的通知;以及创
建新视图。Workspace 组件包含了可以与资源(包括项目和文件)交互的扩展点。</p>
<p>除了Workbench和Workspace，其它插件也可以扩展Eclipse组件。Debug组件可以让插件启动程序、与正在运行的程序交互，以及处理错误Team组件允许Eclipse 资源与版本控制系统(VCS) 交互，构建VCS的Eclipse客户机时，Team 组件就象Debug组件一样，会扩展或增强Eclipse的功能。Help组件可以提供应用程序的联机文档和与上下文的帮助。</p>
<p>一个插件(p lug- in)是Ec lipse平台中的最小功能单元，可以进行独立的开发和发布。</p>
<p>插件是用Java编写的。插件由以下内容组成:</p>
<ul>
<li>JAR中的Java代码</li>
<li>一些只读文件和其它资源(例如图片、web模板、消息资源文件、本地类库等)。</li>
<li><p>一个插件清单，用于声明它与其它插件之间的连接关系，一个插件的清单由几个文件表示:</p>
<ul>
<li>manifest,mf文件是一个OSGI bundle清单， 它描述了插件间运行时的依赖关系;</li>
<li>plugin.xml是一 -个XML文件，它描述了扩展和扩展点的信息</li>
</ul></li>
</ul>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-44-28.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-44-28.png" alt="" loading="lazy"></a></p>
<p>插件目录</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-45-47.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-45-47.png" alt="" loading="lazy"></a></p>
<p>标签的结解释，各个标签页的作用</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-46-19.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-46-19.png" alt="" loading="lazy"></a></p>
<p>扩展与扩展点</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-47-43.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_16-47-43.png" alt="" loading="lazy"></a></p>
<p>Plugin. xmI中扩展点(extens ion point) 解释</p>
<ul>
<li>org.eclipse.ui.perspectives：定义新透视图。</li>
<li>org.eclipse. ui.views ::为工作台定义额外的视图。</li>
<li>org.eclipse.ui.commands:命令定义，定义命令、命令目录以及默认快捷键。</li>
<li>org.eclipse.ui.perspectiveExtensions :扩展其他插件定义的透视图。允许添加菜单、工具栏项目、快捷键、视图等等。</li>
<li>org.eclipse.ui.menus :将命令与界面菜单或工具栏绑定。确定菜单创建的区域。用来对菜单进行扩展，可以对主菜单，工具栏，上下文菜单进行扩展。</li>
<li>org.eclipse.ui.handlers:命令实现，(command的具体行为，定义command对应的c lass。</li>
<li>org. eclipse. ui. command Images: comand的图片。</li>
</ul>
<p>注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、启动图标、本地化文本、搜索顺序和外观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter 的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。</p>
<p>在进行TC客户化时主要的配置文件可以通过修改registry完成。例如修改aif. properties文件中的修改显示信息
flashScreen. ICON=images/FlashScreen. jpg执行%TC_ _ROOT%\portal \registry\genregxml. bat文件，如果修改了. properties文件需要执行此程序。执行这个文件的作用是，将所有jar包中的. properties文件中的配置信息写入到RegistryLoader. xml. gz文件及其多国语言文件中。Teamcenter中的Regisity类，从这些文件中预先读取配置信
息。</p>
<p>也支持基本类型的注册，支持以下类型: color、 font、integer、float、 double、 char、 boolean、 string、 string array
和images。有些类型使用特殊的格式，如下所示:</p>
<p>Color</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">red</span><span class="o">,</span> <span class="n">green</span><span class="o">,</span> <span class="n">blue</span>
  <span class="mi">255</span><span class="o">,</span><span class="mi">255</span><span class="o">,</span><span class="mi">255</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Font</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">font</span><span class="o">-</span><span class="n">name</span><span class="o">,.</span> <span class="n">font</span><span class="o">-</span><span class="n">style</span><span class="o">,</span><span class="n">font</span><span class="o">-</span><span class="n">size</span>
  <span class="err">"</span><span class="nc">Times</span> <span class="nc">Roman</span><span class="o">,</span> <span class="nc">Font</span><span class="o">.</span><span class="na">ITALIC</span><span class="o">,</span> <span class="mi">12</span><span class="err">”</span>
</pre></td></tr></tbody></table></code></div></div>
<p>String array</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">one</span><span class="o">,</span><span class="n">two</span><span class="o">,</span><span class="n">three</span>
</pre></td></tr></tbody></table></code></div></div>
<p>快捷启动eclipse</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>@echo off
  rem
  setlocal
  title Teamcenter Rich Client
  <span class="nb">set </span><span class="nv">TC_JRE_HOME</span><span class="o">=</span>C:<span class="se">\P</span>rogram Files<span class="se">\J</span>ava<span class="se">\j</span>dk1.8.0_201<span class="se">\j</span>re
  <span class="nb">set </span><span class="nv">TPR</span><span class="o">=</span>D:<span class="se">\S</span>iemens<span class="se">\T</span>eamcenter10<span class="se">\p</span>ortal
  <span class="nb">set </span><span class="nv">FMS_HOME</span><span class="o">=</span>D:<span class="se">\S</span>iemens<span class="se">\T</span>eamcenter10<span class="se">\t</span>ccs
  <span class="nb">set </span><span class="nv">PATH</span><span class="o">=</span>%SYSTEMROOT%<span class="se">\s</span>ystem32<span class="p">;</span>%FMS_HOME%<span class="se">\b</span><span class="k">in</span><span class="p">;</span>%FMS_HOME%<span class="se">\l</span>ib<span class="p">;</span>%TPR%<span class="p">;</span>%AUX_PATH%
  <span class="nb">set </span><span class="nv">JAVA_HOME</span><span class="o">=</span>%TC_JRE_HOME%
  <span class="nb">set </span><span class="nv">JRE_HOME</span><span class="o">=</span>%TC_JRE_HOME%
  start <span class="s2">"TAO ImR"</span> /min cmd /c <span class="s2">"D:</span><span class="se">\S</span><span class="s2">iemens</span><span class="se">\T</span><span class="s2">eamcenter10</span><span class="se">\i</span><span class="s2">iopservers</span><span class="se">\s</span><span class="s2">tart_imr.bat"</span>
  start D:<span class="se">\e</span>clipse<span class="se">\e</span>clipse.exe <span class="nt">-vm</span> <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\J</span><span class="s2">ava</span><span class="se">\j</span><span class="s2">dk1.8.0_201</span><span class="se">\b</span><span class="s2">in</span><span class="se">\j</span><span class="s2">avaw"</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="对插件程序的注册方法"><span class="me-2">对插件程序的注册方法: .</span><a href="#对插件程序的注册方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<ol>
<li>将jar格式的文件复制到TC的plugins文件夹中<code>:D:\Siemens\Teamcenter 10\portal\plugins;</code></li>
<li>打开D:\Siemens\Teamcenter10\portal中 的register文件夹，浏览到注册文件程序genregxml.bat;</li>
<li>双击注册文件程序genregxml.bat，开始进行注册，等待注册文件程序genregxml.bat自动关闭;</li>
<li>清理TC缓存;C:\Users\Administrator\Teamcenter</li>
<li>打开TC，验证程序功能，查看注册文件。关于–&gt;安装详细信息</li>
</ol>
<p>注册程序在Rich Client中起着至关重要的作用，注册程序使用属性文件定义应用程序的实现类( classes)、 启动图标、本地化文本、搜索顺序和外:观等。许多基本的客户化任务是用注册程序完成的，同时注册程序在Teamcenter的程序组内增添程序入口，用于启动新开发的程序。不论是二次开发，还是Rich Client的原开发，都是通过这一注册机制来实现程序的调用。.</p>
<p>1）、将Jar文件com. newProcess. rac_ 1. 0. jar复制到TC Plugins文件夹;D:\Siemens\Teamcenter10\portal\plugins</p>
<p>2）、修改genregxml.bat，<code>start D:\eclipse\eclipse.exe -vm "C:\Program Files\Java\jdk1.8.0_201\bin\javaw"</code></p>
<p>3）、双击注册文件</p>
<p>4）、清理TC缓存</p>
<p>5）、打开TC验证程序功能</p>
<h3 id="3-3tc开发环境搭建"><span class="me-2">3.3TC开发环境搭建</span><a href="#3-3tc开发环境搭建" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>配置tcEc lipse集成文件</p>
<p>Teamcenter胖客户端本质是建立在Eclipse框架之上的应用程序，因此通过改造启动Teamcenter的启动脚本portal.bat，可以快速方便的构建一个可以直接启动Teamcenter的调试环境。</p>
<p>1）、复制%TC_ ROOT%\portal\portal.bat</p>
<p>2)、将脚本最后启动Teamcenter部分，修改为启动Eclipse程序。原始脚本:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nd">@echo</span> <span class="nc">Starting</span> <span class="nc">Teamcenter</span> <span class="nc">Rich</span> <span class="nc">Client</span><span class="o">.</span> <span class="err">···</span><span class="n">start</span> <span class="nc">Teamcenter</span><span class="o">.</span><span class="na">exe</span> <span class="o">%*</span> <span class="o">-</span><span class="n">vm</span> <span class="s">"%JRE_ HOME%\bin\javaw.exe"</span>
  <span class="o">-</span><span class="nc">Vmargs</span> <span class="o">-</span><span class="nc">Xmx</span><span class="o">%</span><span class="no">VM</span> <span class="no">XMX</span><span class="o">%</span> <span class="o">-</span><span class="nl">XX:</span><span class="nc">MaxPermSize</span><span class="o">=</span><span class="mi">128</span><span class="n">m</span> <span class="o">-</span><span class="nc">Xbootclasspath</span><span class="o">/</span><span class="nl">a:</span><span class="s">"%JRE_ HOME%lib\plugin.jar"</span><span class="o">;</span><span class="s">"%JRE_ HOME%\lib\deploy.jar"</span><span class="o">;</span><span class="s">"%JRE_ HOME%\lib\javaws.jar"</span>
</pre></td></tr></tbody></table></code></div></div>
<p>修改后脚本:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nd">@echo</span> <span class="nc">Starting</span> <span class="nc">Teamcenter</span> <span class="nc">Rich</span> <span class="nc">Client</span><span class="o">..</span><span class="na">start</span> <span class="n">cmd</span> <span class="o">/</span><span class="n">c</span> <span class="s">"D: leclipseleclipse.exe"</span> <span class="o">-</span><span class="n">vm</span> <span class="s">"C:\ProgramFiles\Java\jdk1.8.0_ 201\bin\javaw"</span>
</pre></td></tr></tbody></table></code></div></div>
<p>双击该脚本，启动Eclipse， 那么就具备了调试Teamcenter系统的基础环境。</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>@echo off
rem 
setlocal
rem TPR is short <span class="k">for </span>TC_PORTAL_ROOT to reduce <span class="nb">command </span>line length
title Teamcenter Rich Client
call <span class="s2">"D:</span><span class="se">\S</span><span class="s2">iemens</span><span class="se">\T</span><span class="s2">eamcenter10</span><span class="se">\i</span><span class="s2">nstall</span><span class="se">\t</span><span class="s2">em_init.bat"</span>
<span class="nb">set </span><span class="nv">TPR</span><span class="o">=</span>D:<span class="se">\S</span>iemens<span class="se">\T</span>eamcenter10<span class="se">\p</span>ortal
<span class="k">if </span>not defined FMS_HOME <span class="nb">set </span><span class="nv">FMS_HOME</span><span class="o">=</span>D:<span class="se">\S</span>iemens<span class="se">\T</span>eamcenter10<span class="se">\t</span>ccs
rem use AUX_PATH <span class="nb">env </span>var <span class="k">for </span>any additional required paths
rem save original path <span class="k">for </span>external applications
<span class="nb">set </span><span class="nv">ORIGINAL_PATH</span><span class="o">=</span>%PATH%
rem <span class="k">for </span>optimal startup performance, keep the PATH length at a minimum
<span class="nb">set </span><span class="nv">PATH</span><span class="o">=</span>%SYSTEMROOT%<span class="se">\s</span>ystem32<span class="p">;</span>%FMS_HOME%<span class="se">\b</span><span class="k">in</span><span class="p">;</span>%FMS_HOME%<span class="se">\l</span>ib<span class="p">;</span>%TPR%<span class="p">;</span>%AUX_PATH%
<span class="nb">set </span><span class="nv">JAVA_HOME</span><span class="o">=</span>%TC_JRE_HOME%
<span class="nb">set </span><span class="nv">JRE_HOME</span><span class="o">=</span>%TC_JRE_HOME%
start <span class="s2">"TAO ImR"</span> /min cmd /c <span class="s2">"D:</span><span class="se">\S</span><span class="s2">iemens</span><span class="se">\T</span><span class="s2">eamcenter10</span><span class="se">\i</span><span class="s2">iopservers</span><span class="se">\s</span><span class="s2">tart_imr.bat"</span>
:start_portal
<span class="nb">cd</span> /d %TPR%
<span class="nb">set </span><span class="nv">CLASSPATH</span><span class="o">=</span>.<span class="p">;</span>
<span class="nb">set </span><span class="nv">VM_XMX</span><span class="o">=</span>1024m
rem Set DJIPJL_VMARG environment variable
IF EXIST <span class="s2">"%TPR%</span><span class="se">\D</span><span class="s2">JIPJL</span><span class="se">\s</span><span class="s2">etenv.cmd"</span> call <span class="s2">"%TPR%</span><span class="se">\D</span><span class="s2">JIPJL</span><span class="se">\s</span><span class="s2">etenv.cmd"</span>
@echo Starting Teamcenter Rich Client...
start D:<span class="se">\e</span>clipse<span class="se">\e</span>clipse.exe <span class="nt">-vm</span> <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files</span><span class="se">\J</span><span class="s2">ava</span><span class="se">\j</span><span class="s2">dk1.8.0_201</span><span class="se">\b</span><span class="s2">in</span><span class="se">\j</span><span class="s2">avaw"</span>
</pre></td></tr></tbody></table></code></div></div>
<p>i、配置Eclipse JRE的首选项</p>
<p>1)、使用tcEclipse快捷方式启动Eclipse。
2）、单击菜单:窗口→首选项
3）、打开“安装JRE”窗口。自Preferences</p>
<p>ii、添加JRE位置和系统库</p>
<p>1）、单击添加。
2）、在Add JRE对话框中，选择Standard VM，然后单击下一步。
3）、单击目录…导航到JAVA_HOME，然后单击确定。
4）、等待作为Eclipse中填入的JRE系统库。
ii、更改Preference以使用新安装的JRE
1）、在Preferences对话框，请确认所安装的JRE被选中。
2）、取消选择默认安装的JRE。
3）、选择添加的jdk1.8.0 45的JRE。
4）、保持Preferences窗口打开。</p>
<p>iii、设置Eclipse优先目标平台Teamcenter
由于当前针对Teamcenter平台使用Eclipse进行开发，因此需要将Eclipse开发平台设置为Teamcenter。
1）、单击菜单:窗口- &gt;首选项。</p>
<p>2）、双击Plug-in Development树将其展开，选择Target Platform。</p>
<p>3）、在Target Platform对话框中，单击Add… ，打开“New Target Definition”窗口</p>
<p>4）、初始化目标定义为: Nothing: Start with an empty target definition，点击下一步。</p>
<p>5）、在位置选项卡上，单击“添加”，并使用目录选项，浏览到胖客户端位于:%TC_ ROOT%\portal。</p>
<p>6）、单击Finish。
7）、更改名称: Tc10 Rich Client, 然后单击Finish。
8）、设置“TC10 Rich client”为激活状态。</p>
<p>iiii、设置Teamcenter调试环境参数
1）、单击Run-→Run Configuration….
2）、双击Eclipse Application。
3）、名称输入“Tc10.1 Rich Client”。</p>
<p>4）、选择Arguments选项卡，在VM参数区域中，输入-Xms256m -Xmx1024m,设置JVM最大内存参数为1024m。
5）、保留值的其余部分保持不变。</p>
<h5 id="创建tc插件项目"><span class="me-2">创建TC插件项目</span><a href="#创建tc插件项目" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>i、创建新项目</p>
<p>(1)、单击文件- +新建→项目
(2)、从项目列表中选择Plug-in Project。
(3) 、单击下一步。</p>
<p>ii、输入项目信息
(1)、对于项目名称，键入c9.mycustom
(2)、清除源文件夹框。
(3)、保留值的其余部分保持不变。
(4)、单击下一步。</p>
<p>iii、添加插件信息
(1)、在Plug-in Content对话框中，在Vendor框 中输入training Class。</p>
<p>(2）、该值的其余部分应默认</p>
<p>iiii、完成创建
(1)、选择创建检查插件使用的模板“hello， world command”。</p>
<p>(2)、单击Finish。</p>
<p>iiiii、检查调试配置项
(1)、单击Run-→Run Configuration….，查看各项参数设置。</p>
<p>调试测试</p>
<p>(1)单击Eclipse的运行菜单run，运行程序;</p>
<p>调试测试</p>
<p>(2)、在TC登录界面输入账号和密码，登录TC系统;
(3)、单击TC中的菜单:帮助一-&gt;关于，弹出TC10的关于对话框;
(4)、在“安装详细信息”中可以检索到自定义的插件。
(5)、在TC中可以查看程序功能。</p>
<p>项目打包与部署</p>
<p>(1)、单击文件“导出”，弹出到处对话框，选择“导出”，选择“Deployment plug-in and fragments” ;</p>
<p>(2)、选择要导出的插件项目及路径，默认设置在%TC_ ROOT %/Portal文件夹中单击完成按钮，执行导出任务;
(3)、在TC的插件文件夹中查看导出的插件包;</p>
<p>(4)、执行插件包的注册;
(5)、打开TC，从“安装详细信息”中检索插件包。</p>
<h5 id="配置反编译环境"><span class="me-2">配置反编译环境</span><a href="#配置反编译环境" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>点击Eclipse中菜单windows- &gt; preference。</p>
<p>选中导航树上的Java &gt;JadClipse</p>
<p>编辑Path to decompiler,</p>
<p>内容为刚刚下载的jadnet158.zip所解压缩后路径,如右图所示,路径是软件环境中的具体路径。</p>
<p>设置Class文件默认查看器选中导航树上的General &gt;Editors→File Associations，</p>
<p>在右边列表里,选中*.class确保”JadClipse Class FileViewer”是默认(default)</p>
<p>这样反编译工具JAD就和Eclipse集成到一-起了,只要在Eclipse中双击Class文件就能自动进行编译并显示源代
码。不过有时候反编译会不完全。</p>
<h3 id="3-4客户化开发常用接口"><span class="me-2">3.4客户化开发常用接口</span><a href="#3-4客户化开发常用接口" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<h4 id="com-teamcenter-rac-aifrcp"><span class="me-2">com.teamcenter.rac.aifrcp</span><a href="#com-teamcenter-rac-aifrcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nc">AbstractAIFApplication</span>
  <span class="nc">AbstractAIFSession</span>
  <span class="nc">AbstractAIFDialog</span>
  <span class="nc">AbstractAIFOperation</span>
  <span class="nc">AlFDesktop</span>
  <span class="nc">AIFPortal</span>
  <span class="nc">AbstractAI</span> <span class="no">FA</span> <span class="n">ction</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">AbstractAI</span> <span class="nc">FApplication</span>
</pre></td></tr></tbody></table></code></div></div>
<p>用于创建Application Integration Frame(AIF )应用程序的基本AIFApplication类。该类包含AbstractAIFApplication的定义。它被用作所有AIF应用程序都要继承的基类。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">getSession</span><span class="o">()</span>
  <span class="n">initialize</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Map</span> <span class="n">parameters</span><span class="o">)</span>
  <span class="n">open</span><span class="o">(</span><span class="nc">InterfaceAIFComponent</span><span class="o">[]</span> <span class="n">components</span> <span class="o">)</span>
  <span class="n">refresh</span><span class="o">()</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Teamcenter基础客户化插件，在该插件中定义了主要的接口以及抽象类、出口类等，如:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">AbstractAIFSession</span>
</pre></td></tr></tbody></table></code></div></div>
<p>这个类表示抽象的AIF会话对象，应用程序集成框架要求它的注册应用程序实现这个对象。子类包括TCSession。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">getUserName</span><span class="o">()</span>
  <span class="n">login</span><span class="o">()</span>
  <span class="n">refresh</span><span class="o">()</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="com-teamcenter-rac-common"><span class="me-2">com.teamcenter.rac .common</span><a href="#com-teamcenter-rac-common" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter的一- 些动作和菜单都在该插件包中进行了定义和注册，如菜单栏，工具栏，以及右键菜单等。一般的菜单动作都在com.teamcenter.rac.common.actions中进行了定义，如新建Item，Dataset, folder.</p>
<p>1.在该包中建LNewltemAction类,并继承AbstractAIFAction类，实现public void run(方法。</p>
<p>2.在action.properties文件中进行了注册，如下所示:</p>
<p>File-&gt; New -&gt; Item</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">newItemAction</span><span class="o">=</span><span class="n">com</span><span class="o">.</span> <span class="n">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">common</span><span class="o">.</span> <span class="n">actions</span><span class="o">.</span> <span class="nc">NewItemAction</span>
  <span class="n">newItemAction</span><span class="o">.</span><span class="na">ICON</span><span class="o">=</span><span class="n">images</span><span class="o">/</span><span class="n">newitem_</span> <span class="mi">1</span> <span class="mi">6</span><span class="o">.</span><span class="na">png</span>
  <span class="n">newItemAction</span><span class="o">.</span><span class="na">COMM</span> <span class="no">AND</span><span class="o">=</span><span class="n">newItem</span><span class="o">(</span> <span class="nc">Command</span>
  <span class="n">newItem</span> <span class="nc">Action</span><span class="o">.</span><span class="na">ACCELERATOR</span><span class="o">=</span><span class="n">ctrl</span> <span class="n">pressed</span> <span class="no">T</span>
  <span class="n">newItemC</span> <span class="n">ommand</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">commands</span><span class="o">.</span> <span class="n">newitem</span><span class="o">.</span><span class="na">N</span> <span class="n">ewItemCommand</span>
</pre></td></tr></tbody></table></code></div></div>
<p>3.相应的，在该插件中对应一一个com.teamcenter.rac.commands.newitem包，创建Item 的业务逻辑都在该包中进行了实现。</p>
<h4 id="com-teamcenter-rac-external"><span class="me-2">com.teamcenter.rac.external</span><a href="#com-teamcenter-rac-external" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter插件中引用到的第三方类大部分都在该插件中进行了继承，可以说该插件为资源性插件</p>
<h4 id="com-teamcenter-rac-kernal"><span class="me-2">com.teamcenter.rac .kernal</span><a href="#com-teamcenter-rac-kernal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>对于客户端开发，都是基于Kernel API组件的，通过Kernel API，可以调用服务器端的功能，实际上Kernel API用
于Rich Client的ITK界面。进程(Session)对象是Kernel API的核心，通过-一个组件或者应用程序的getSession( )方法可以获取该对象的引用，AIFComponentManager是一个当前Session中所存组件的缓存器。二次开发工作所涉及的对象是:进程(Session)、 类型(Type)、服务( Service)、组件(Component)，在做二次开发的时候，如果要从当前的组件转到其他的组件，一般通过Session来进行。</p>
<p>Type组件存在于Teamcenter的每一类对象类型中，主要用来执行如:创建这样的任务，就面向对象来说，当一个对象还没有示例化的时候，无法调用其create方法，所以必须首先获得-一个指向Session的引用，这样即可从Session中获得Type组件。例如:创建-一个Folder的代码如下(假设当前已经获得了一个Session):</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFolderType</span> <span class="n">foldertype</span><span class="o">=</span> <span class="o">(</span>
  <span class="nc">TCComponentFolderType</span><span class="o">).</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"Folder"</span><span class="o">);</span>
  <span class="nc">TCComponentFolder</span> <span class="n">folder</span><span class="o">=</span> <span class="n">foldertypecreate</span><span class="o">(</span><span class="s">"Folder Name"</span><span class="o">,</span>
  <span class="s">"Folder Description"</span><span class="o">,</span> <span class="s">"Folder Type"</span> <span class="o">);</span> <span class="o">.</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Kernel API面向对象的本质是通过应用程序接口(API)来满足用户的需求，整个Kernel的方法模式是创建对象、查找对应的
Type组件和对对象执行操作，组件类中的方法和服务是定义好的就Kernel而言，另外一个需要注意的问题是: Rich Client中所有的组件都是基于属性(property)的，即当要获取-一个对象名称的时候不能用getName( )方法(实际上也没有这个方法)，而是通过getProperty(object_ name; )的方法来完成这个功能。</p>
<p>这主要是因为整个的Kernel是建立在属性(property)层之上的，所以组件类具备获取属性信息的能力，而新建的类是继
承自TC Component组件类的，显然具备获取属性(property)信息的能力。比如当获取-一个BOMLine的数量属性的时候，通过BOMLine.getProperty( bl_ _quantity )即可得到。.</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="nc">TCSession</span> <span class="n">session</span> <span class="o">=</span> <span class="nc">RACUIUtil</span><span class="o">.</span><span class="na">getTCSession0</span><span class="o">;</span>
  <span class="nc">AbstractAIFUIApplication</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">AIFUtility</span><span class="o">.</span><span class="na">getCurrentApplication0</span><span class="o">;</span>
  <span class="nc">AIFComponentContext</span><span class="o">[]</span> <span class="n">selectedContexts</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="na">getTargetContexts</span><span class="o">();</span>
  <span class="nc">InterfaceAIFComponent</span> <span class="n">component</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getComponent</span><span class="o">(;</span>
  <span class="nc">TCComponentItem</span> <span class="n">targetItem</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentItem</span><span class="o">)</span><span class="n">component</span><span class="o">;</span>
  <span class="nc">TCComponentItemRevision</span> <span class="n">rev</span> <span class="o">=</span> <span class="n">targetItem</span><span class="o">.</span><span class="na">getLatestItemRevision</span><span class="o">(;</span>
  <span class="nc">TCComponentForm</span> <span class="n">form</span> <span class="o">=</span>
  <span class="o">(</span><span class="nc">TCComponentForm</span> <span class="o">)</span><span class="n">rev</span><span class="o">.</span><span class="na">getRelatedComponent</span><span class="o">(</span><span class="s">"IMAN_ master_ form_ rev"</span><span class="o">);</span>
  <span class="k">if</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"user_ _data_ 1"</span><span class="o">)==</span> <span class="o">=</span><span class="s">""</span> <span class="o">||</span>
  <span class="n">form</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"user_ _data_ 2"</span><span class="o">)=</span><span class="s">""</span><span class="o">)</span>
  <span class="o">{</span>
  <span class="nc">MessageBox</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"ITEM无法取到用户数据属性! "</span><span class="o">,</span> <span class="s">"提示"</span><span class="o">,</span>
  <span class="nc">MessageBox</span><span class="o">.</span><span class="na">INFORMATION</span><span class="o">);</span>
  <span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象,该对象对应的系统类是:</p>
<p>1)、TCComponentFolder</p>
<p>该类继承了TCComponent类。扩展定义了Folder的获取以及和属性的修改方法。基本上所有的业务对象都继承于TCComponent类。相应的我们可以联想到，Item对 应的组件类为TCComponentItem; Dataset对 应的组件类为TCComponentDataset。</p>
<p>该插件对业务对象进行了组件的定义，系统中每个业务对象都在该插件中有相应的类去实现。如Folder是文件夹对象，该对象对应的系统类是:</p>
<p>2）、一个业务类对应的组件类相应的也会对应-一个业务类型类,如Folder对应的业务类型组件类为TCComponentFolderType。该类继承于TCComponentType类。相应的我们可以联想到，Item对应的组件类型类为TCComponentItemType; Dataset对应的组件类型类为TCComponentDatasetType。该类主要扩展定义了相应的业务对象的创建以及另存为等方法。</p>
<p>通过业务对象对应的类型组件类去创建业务对象，还是以Folder对象为例:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFolderType</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentFolderType</span><span class="o">)</span>
  <span class="n">session</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"Folder"</span><span class="o">);</span>
  <span class="nc">TCComponentFolder</span> <span class="n">f</span><span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"My Folder Name"</span><span class="o">,</span><span class="s">"My Folder Description"</span><span class="o">,</span> <span class="s">"My Folder Type"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="com-teamcenter-rac-tcapps"><span class="me-2">com.teamcenter.rac.tcapps</span><a href="#com-teamcenter-rac-tcapps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter中部分应用的基础实现和业务逻辑都在该类中进行了实现，该类也定义了–些公共组件等。</p>
<p>该插件是Teamcenter对大部分Swing组件进行了继承与重写。如: iTextField继承 于JTextField; iComboBox类为
Teamcenter自己定义的组件。</p>
<p>该插件中还定义了一些公共工具类，如: TcLogger日志控制类，Registry注册控制类等 。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">cme</span><span class="o">.</span><span class="na">mpp</span>			<span class="n">对MSE应用进行了实现</span>
  <span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">pse</span>				<span class="n">对结构管理器进行了实现</span>
  <span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">query</span> <span class="n">builder</span>	 <span class="n">对查询构建器进行了实现</span>
  <span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">rac</span><span class="o">.</span><span class="na">explorer</span>			<span class="n">对浏览器进行了实现</span>
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_17-51-05.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-17_17-51-05.png" alt="" loading="lazy"></a></p>
<h4 id="任务要求"><span class="me-2">任务要求:</span><a href="#任务要求" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>1)、掌握jar的解压方式;
2)、掌握使用Common包中的类，构建Jar包，实现快捷菜单添加新建零组件新建数据集的功能。</p>
<p>在EcIipse中创建一个新的插件项目，命名为com.newCreate，不使用模板;</p>
<p>新建plugin. xml文件，调用Common包中的newltem，newDataset类， 实现右键新建Item,新建数据集的功能。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
  <span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
  <span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;command</span> <span class="na">id=</span><span class="s">"CustNewItem"</span> <span class="na">name=</span><span class="s">"Create New Item"</span><span class="nt">&gt;</span>;
  <span class="nt">&lt;command</span> <span class="na">id=</span><span class="s">"CustNewDataset"</span> <span class="na">name=</span><span class="s">"Create New Dataset"</span><span class="nt">&gt;</span>;
  <span class="nt">&lt;/extension&gt;</span>
  <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;handler</span> <span class="na">commandId=</span><span class="s">"CustNewDataset"</span>   <span class="na">class=</span><span class="s">"com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions"</span> <span class="nt">&gt;</span>;
  <span class="nt">&lt;handler</span> <span class="na">commandId=</span><span class="s">"CustNewItem"</span>
  <span class="na">class=</span><span class="s">"com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions"</span> <span class="nt">&gt;</span>;
  <span class="nt">&lt;/extension&gt;</span>
  <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">"CustNewItem"</span><span class="nt">&gt;&lt;/command&gt;</span>
  <span class="nt">&lt;/menuContribution&gt;</span>
  <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">"CustNewDataset"</span><span class="nt">&gt;&lt;/command&gt;</span>
  <span class="nt">&lt;/menuContribution&gt;</span>
  <span class="nt">&lt;/extension&gt;</span>
  <span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>修改p lugin.xmI文件，调用Common包中的newltem，newDataset类， 实现右键新建Item，新建数据集的功能。</p>
<p>思考:此处设置的p lugin. xmI脚本文件中，和com. newProcess. rac_1.0解压之后的p lugin.xm |做个比较。</p>
<p>在runtime选项卡中添加导出包。</p>
<p>在Build选项卡中，勾选.上plugin. xml文件，确保生成jar包时，plugin. xml也在包中。</p>
<p>修改Minifest清单文件如下。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>Manifest-Version: 1.0
  Bundle-ManifestVersion: 2
  Bundle-Name: NewCreate
  Bundle-SymbolicName: com.newCreate;singleton:=true
  Bundle-Version: 1.0.0.qualifier
  Bundle-Activator: com.newcreate.Activator
  Bundle-Vendor: Mycom
  Require-Bundle: org.eclipse.core.runtime,
  com.teamcenter.rac.common;bundle-version="10000.1.0",
  org.eclipse.core.runtime.compatibility;bundle-version="3.2.200",
  com.teamcenter.rac.kernel;bundle-version="10000.1.0",
  com.teamcenter.rac.aifrcp;bundle-version="10000.1.0",
  org.eclipse.ui;bundle-version="3.8.0",
  com.teamcenter.rac.external;bundle-version="10000.1.0"
  Import-Package: com.teamcenter.rac.commands.newitem
  Import-Package: com.teamcenter.rac.commands.newdataset
  Bundle-RequiredExecutionEnvironment: JavaSE-1.7
  Bundle-ActivationPolicy: lazy
  Export-Package: com.newcreate
</pre></td></tr></tbody></table></code></div></div>
<p>生成结束后，打包jar包，放到p lugin文件夹中，并通过genr egxml. bat注册，清除缓存后登录TC查看功能结果。</p>
<h3 id="3-5tcsession的使用"><span class="me-2">3.5TCSession的使用</span><a href="#3-5tcsession的使用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>在进行Teamcenter客户化(二次开发)前，我们首先要了解哪些是核心API。只有掌握了核心API的使用，才能游刃有余的进行定制开发。下图展示了Teamcenter的核心API。从图中可以看到TC Session是核心API的核
心，通过TC Session沟通了应用程序AbstractAIFUIApplication、业务对象TCComponent、缓存AIFComponentManager、数据类型Type、业务服务Service。其中Type和Services是 各种相关类的集合。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-21_17-59-13.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/Snipaste_2020-03-21_17-59-13.png" alt="" loading="lazy"></a></p>
<p>TcSession类在com.teamcenter.rac.kernel包中，是com.teamcenter.rac.aif.kernel.AbstractAIFSession的子类。TC会话负责登录到TC，并记录会话信息。它扩i展了AbstractAIFSession类的功能，使用AIF会话管理器管理会话。AIF : Application Integration Framework</p>
<h4 id="获取tcsession的三种办法"><span class="me-2">获取TCSession的三种办法</span><a href="#获取tcsession的三种办法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<h5 id="从当前应用程序直接获取tc-session"><span class="me-2">从当前应用程序直接获取TC Session</span><a href="#从当前应用程序直接获取tc-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">AbstractAIFUIApplication</span> <span class="n">app</span> <span class="o">=</span><span class="nc">AIFUtility</span><span class="o">.</span><span class="na">getCurrentApplication</span><span class="o">();</span>
<span class="nc">TCSession</span> <span class="n">tcSession</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCSession</span><span class="o">)</span> <span class="n">app</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></div></div>
<p>AbstractAIFUIApplication类在com.teamcenter.rac.aif包中，是com.teamcenter.rac.aif.AbstractAIFApplication的子类。</p>
<h5 id="从tccomponent对象上获取tc-session"><span class="me-2">从TCComponent对象上获取TC Session</span><a href="#从tccomponent对象上获取tc-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nc">TCSession</span> <span class="n">tcSession</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">AbstractAIFUIApplication</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">AIFUtility</span><span class="o">.</span><span class="na">getCurrentApplication</span><span class="o">();</span>
<span class="c1">//获取选择的目标对象</span>
<span class="nc">InterfaceAIFComponent</span> <span class="n">target</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="na">getTargetComponent</span><span class="o">();</span>
<span class="k">if</span><span class="o">(</span><span class="n">target</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
    <span class="nc">TCComponent</span> <span class="n">tcComp</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponent</span><span class="o">)</span><span class="n">target</span><span class="o">;</span>
    <span class="n">tcSession</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">getSession</span><span class="o">(;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="通过isessionservice获取到tcsession"><span class="me-2">通过ISessionService获取到TCSession</span><a href="#通过isessionservice获取到tcsession" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>在启动Teamcenter后，TCSession缓存到 了AIFSessionManager中,而AIFSessionManager实现了ISessionService接口。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nc">ISessionService</span> <span class="n">iss</span> <span class="o">=</span> <span class="nc">AifrcpPlugin</span><span class="o">.</span> <span class="nf">getSessionService</span><span class="o">();</span>
<span class="nc">TCSession</span> <span class="n">tcSession</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
	<span class="n">tcSession</span> <span class="o">=(</span><span class="nc">TCSession</span><span class="o">)</span><span class="n">iss</span><span class="o">.</span><span class="na">getSession</span><span class="o">(</span> <span class="s">"com.teamcenter.rac.kernel.TCSession"</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exceptione</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="获取当前tc信息"><span class="me-2">获取当前TC信息</span><a href="#获取当前tc信息" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">tcSession</span><span class="o">.</span><span class="na">getUser</span><span class="o">();</span>
<span class="c1">//获取用户</span>
<span class="n">tcSession</span><span class="o">.</span> <span class="nf">getCurrentGroup</span><span class="o">();</span>
<span class="c1">//获取组信息</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getGroup</span><span class="o">();</span> 
<span class="n">tcSession</span><span class="o">.</span><span class="na">getCurrentOrganization</span><span class="o">();</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getLoginGroupOrganization</span><span class="o">();</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getCurrentRole</span><span class="o">);</span> <span class="c1">// 获取角色.</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getRole</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="设置当前用户"><span class="me-2">设置当前用户</span><a href="#设置当前用户" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">tcSession</span><span class="o">.</span><span class="na">setCurrentGroupMember</span><span class="o">(</span><span class="nc">TCComponentGroup</span><span class="o">,</span><span class="nc">TCComponentRole</span><span class="o">);</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">setCurrentOrganization</span><span class="o">(</span><span class="nc">TCComponentGroup</span><span class="o">);</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">setCurrentProject</span><span class="o">(</span><span class="nc">TCComponentProject</span><span class="o">);</span> 
</pre></td></tr></tbody></table></code></div></div>
<h4 id="dba用户旁路功能打开"><span class="me-2">DBA用户旁路功能打开</span><a href="#dba用户旁路功能打开" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>首选要判断是否为DBA角色。注意:实际上，非BA用户也是可以开通旁路功能的，但是实现的方式稍微复杂些。在某些业务场景下，可能存在这个超越权限的特殊处理，一般是通过代码的方式，使用完后，及时关闭。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">tcSession</span><span class="o">.</span><span class="na">enableBypass</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="获取type"><span class="me-2">获取Type</span><a href="#获取type" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>函数:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentType</span> <span class="n">type</span> <span class="o">=</span><span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"XXXType"</span><span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Type组件，存在于Teamcenter的所有数据类型对象中，比如Item、Dataset、 Folder、 Revision等。 这种Type组件主要用于执行一些.如对象的创建、对象的查找等功能。因此，当需要创建对象的时候，首先应该想到通过Type实现。</p>
<p>以下是一些常用的Type:</p>
<blockquote>
<p>表单: TCComponentFormType
Item对象: TCComponentItemType
版本对象: TCComponentItemRevisionType
数据集: TTCComponentDatasetType
文件夹: CComponentFolderType
分类对象: TCComponentICOType
项目: TCComponentProjectType
查询: TCComponentQueryType
流程: TCComponentProcessType
时间表: TCComponentScheduleType
BOM行: TCComponentBOMLineType
BOM: TCComponentBOM WindowType
工艺对象: TCComponentMEProcessType</p>
</blockquote>
<p>例如创建文件夹功能代码如下:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFolderType</span> <span class="n">type</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentFolderType</span><span class="o">)</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"Folder"</span><span class="o">);</span>
<span class="nc">TCComponentFolder</span> <span class="n">f</span><span class="o">=</span> <span class="n">type</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"My Folder Name"</span><span class="o">,</span> <span class="s">"MyFolder Description"</span><span class="err">，</span><span class="s">"My Folder Type"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>
<p>getTypeComponent函数中传递的参数，多数情况下， 就是TCComponentXXXType中的XXX。但是也有特列。更准确的说这个参数应该与对象的存储类名–致。例如:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentQueryType</span> <span class="n">queryType</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentQueryType</span><span class="o">)</span><span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"ImanQuery"</span><span class="o">);</span>
<span class="nc">TCComponentProjectType</span> <span class="n">tcComponentProjectType</span> <span class="o">=(</span><span class="nc">TCComponentProjectType</span><span class="o">)</span><span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"TC_ Project"</span><span class="o">);</span>
<span class="nc">TCComponentProcessType</span> <span class="n">processType</span> <span class="o">=(</span><span class="nc">TCComponentProcessType</span><span class="o">)</span> <span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"Job"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>
<p>对于自定义的对象类型N4MTMOPTrackingRevision，获取参数的
代码如下:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentType</span> <span class="n">tcComptype</span> <span class="o">=</span><span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"N4MTMOPTrackingRevision"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="获取service服务"><span class="me-2">获取Service服务</span><a href="#获取service服务" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>以下是在二次开发过程中常用的几个服务:
(1)首选项服务，可以操作与首选项相关的大部分操作。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCPreferenceService</span> <span class="n">preferenceService</span> <span class="o">=</span><span class="n">tcSession</span><span class="o">.</span> <span class="nf">getPreferenceService</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></div></div>
<p>(2)分类管理服务，可以完成大部分分类管理操作，包括创建
分类对象、查找分类对象、获取分类结构信息等。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCClassificationService</span> <span class="n">classi</span> <span class="n">ficationService</span> <span class="o">=</span><span class="n">tcSession</span><span class="o">.</span> <span class="nf">getClassificationService</span><span class="o">();</span>
</pre></td></tr></tbody></table></code></div></div>
<h3 id="3-6创建tc对象"><span class="me-2">3.6创建TC对象</span><a href="#3-6创建tc对象" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<h4 id="tcapi接口"><span class="me-2">TCAPI接口</span><a href="#tcapi接口" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<blockquote>
<p>TCComponent
TCComponentItem
TCComponentI temRevision .
TCComponent ItemType .
TCComponentFolderType
TCComponentUser
TCComponentPerson
TCComponentGroup
TCComponentRole
TCComponentForm
TCComponentBOMW indow
TCComponentRevi si onRule .
TCComponentiTextField
JCheckBox
JFi 1 eChooser
JButton
JPanel
JLabel
JTextArea
LOVComboBox，LOVUIComponent,TCComponentListOfValues
Jtable
JDialog
DateButton</p>
</blockquote>
<p>Teamcenter中对象的创建一般都是通过会话获取要创建
对象的类型，然后再根据类型去创建具体的数据对象。每种
对象的创建用的函数方法都不一样。下面将根据不同对象的
创建方式进行说明:
1. Folder 的创建。
2. Form的创建。
3. Item的创建。
4. Dataset 的创建。</p>
<h4 id="folder"><span class="me-2">Folder</span><a href="#folder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>文件夹的创建需要对三个参数赋值，即文件夹名称、文件夹描述、文件夹的类型，以下是系统中创建文件夹的代码。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFolderType</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentFolderType</span><span class="o">)</span>
<span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="s">"Folder"</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentFolder</span> <span class="n">f</span><span class="o">=</span><span class="n">t</span><span class="o">.</span> <span class="nf">create</span><span class="o">(</span><span class="s">" My Folder Name ”，” MyFolder Description"</span><span class="o">,</span> <span class="s">"My Folder Type"</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="form的创建"><span class="me-2">Form的创建:</span><a href="#form的创建" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Form的创建和Folder的创建类似，需要对三个参数赋值。Form名称、Form描述，以及Form类型。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFormType</span> <span class="n">tccomponentFormType</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentFormType</span><span class="o">)</span><span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="err">'</span> <span class="nc">MyForm</span><span class="err">'</span> <span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentForm</span> <span class="n">tccomponentForm</span> <span class="o">=</span><span class="n">tccomponentFormType</span><span class="o">.</span><span class="na">create</span> <span class="o">(</span><span class="err">'</span> <span class="nc">MyForm</span><span class="err">'</span><span class="o">,</span> <span class="s">"MyFormDescription"</span><span class="o">,</span><span class="s">"MyForm"</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="item的创建"><span class="me-2">Item的创建:</span><a href="#item的创建" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Item的创建相对来说比前两个都复杂点，具体原理就是先根据系统类型从系统中获取编码和版本编码，然后进行创建。</p>
<h5 id="item-id和item-revision获取方法"><span class="me-2">item _ID和item Revision获取方法:</span><a href="#item-id和item-revision获取方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p><code class="language-plaintext highlighter-rouge">java
TCComponentItemType tccomponentitemtype =(TCComponentItemType)session.getTypeComponent(itemType) ;
String itemId = tccomponentitemtype.getNewID();
String itemRev = tccomponentitemtype.getNewRev();
</code></p>
<h5 id="item单位获取方法"><span class="me-2">Item单位获取方法</span><a href="#item单位获取方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentType</span> <span class="n">uom</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="nc">UnitOfMeasure</span><span class="o">);</span>
<span class="nc">TCComponent</span><span class="o">[]</span> <span class="n">uoms</span> <span class="o">=</span> <span class="n">uom</span><span class="o">.</span><span class="na">extent</span><span class="o">()</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="item创建方法"><span class="me-2">Item创建方法</span><a href="#item创建方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentItem</span> <span class="n">item</span> <span class="o">=</span><span class="n">tccomponent</span> <span class="n">i</span> <span class="n">temtype</span><span class="o">.</span> <span class="nf">create</span> <span class="o">(</span><span class="n">i</span> <span class="n">temId</span><span class="o">,</span> <span class="n">i</span> <span class="n">temRev</span><span class="o">,</span> <span class="n">itemType</span><span class="o">,</span> <span class="n">itemName</span><span class="o">,</span> <span class="n">i</span> <span class="n">temD</span>
<span class="n">escription</span><span class="o">,</span> <span class="n">uoms</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
<span class="o">((</span><span class="nc">TCComponentFolder</span><span class="o">)</span><span class="n">target</span><span class="o">).</span><span class="na">add</span><span class="o">(</span><span class="n">contents</span><span class="o">,</span><span class="n">item</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="dataset的创建方法"><span class="me-2">Dataset的创建方法</span><a href="#dataset的创建方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>数据集的创建涉及到命名引用，创建过程:先创建某一一个类型的数据集，然后把命名引用添加上去。代码如下:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">as1</span><span class="o">[]</span> <span class="o">=</span> <span class="o">{</span><span class="n">url</span><span class="o">};</span>
<span class="nc">String</span> <span class="n">as2</span><span class="o">[]</span> <span class="o">=</span> <span class="o">{</span><span class="s">"Text"</span><span class="o">};</span>
<span class="nc">String</span> <span class="n">as3</span><span class="o">[]</span> <span class="o">=</span> <span class="o">{</span><span class="s">"Text"</span><span class="o">};</span>
<span class="nc">String</span> <span class="n">as4</span><span class="o">[]</span> <span class="o">=</span> <span class="o">{</span><span class="s">"P1ain"</span><span class="o">};</span>
<span class="nc">TCComponentDatasetType</span> <span class="n">tccomponentDatasetType</span> <span class="o">=(</span><span class="nc">TCComponentDatasetType</span><span class="o">)</span><span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span><span class="o">(</span><span class="s">"Text"</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentDataset</span> <span class="n">tccomponentDataset</span> <span class="o">=</span><span class="n">tccomponentDatasetType</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">dataFileName</span><span class="o">,</span><span class="s">"Text"</span><span class="o">,</span><span class="s">"Text"</span><span class="o">)</span> <span class="o">;</span>
<span class="n">tccomponentDataset</span><span class="o">.</span><span class="na">setFiles</span> <span class="o">(</span><span class="n">as1</span><span class="o">,</span><span class="n">as2</span><span class="o">,</span><span class="n">as3</span><span class="o">,</span><span class="n">as4</span><span class="o">,);</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="查询构建器的调用"><span class="me-2">查询构建器的调用</span><a href="#查询构建器的调用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter中有专门的查询构建器模块，我们可以通过配置查询构建器，然后通过代码对系统中的对象进行搜索，以下是调用代码:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nc">TCTextService</span> <span class="n">tcTextService</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getTextService</span><span class="o">()</span> <span class="o">;</span>
<span class="nc">String</span> <span class="n">asKey</span><span class="o">[]</span> <span class="o">=</span> <span class="n">tcTextService</span><span class="o">.</span><span class="na">getTextValue</span><span class="o">(</span><span class="n">item_id</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">String</span> <span class="n">asValues</span><span class="o">[]</span> <span class="o">=</span><span class="mo">00001</span><span class="o">;</span>
<span class="nc">InterfaceAIFComponent</span> <span class="n">interfaceAifComponent</span> <span class="o">[]</span> <span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="nc">ItemId</span><span class="o">...,</span><span class="n">asKey</span><span class="o">,</span><span class="n">asValues</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="teamcenter中bom结构的构建"><span class="me-2">Teamcenter中BOM结构的构建</span><a href="#teamcenter中bom结构的构建" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Teamcenter中的BOM结构建立，具体方法是先在系统中创建B0MWindow对象，然后再得到B0MLine对象，分别在BOMLine.上进行添加即可，实现代码如下:</p>
<h5 id="获取版本规则"><span class="me-2">获取版本规则</span><a href="#获取版本规则" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentRevisionRuleType</span> <span class="n">tcComponentRevisionRuleType</span> <span class="o">=(</span><span class="nc">TCComponentRevisionRuleType</span><span class="o">)</span><span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="s">"RevisionRule"</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentRevisionRule</span> <span class="n">tcComponentRevisionRule</span> <span class="o">=</span><span class="n">tcComponentRevisionRuleType</span><span class="o">.</span> <span class="nf">getDefaultRule</span><span class="o">()</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="创建bomwi-ndow"><span class="me-2">创建BOMWi ndow</span><a href="#创建bomwi-ndow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentBOMWindowType</span> <span class="n">tcComponentBomWindowType</span> <span class="o">=(</span><span class="nc">TCComponentBOMWindowType</span><span class="o">)</span> <span class="n">session</span><span class="o">.</span><span class="na">getTypeComponent</span> <span class="o">(</span><span class="s">"BOMWindow"</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentBOMWi</span> <span class="n">ndow</span> <span class="n">tcComponentBomWindow</span> <span class="o">=</span><span class="n">tcComponentBomWindowType</span><span class="o">.</span> <span class="nf">create</span><span class="o">(</span><span class="n">tcComponentRevisionRule</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="获取bomline的两种方法"><span class="me-2">获取BOMLine的两种方法</span><a href="#获取bomline的两种方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentB0MLine</span> <span class="n">line</span><span class="o">=</span> <span class="o">((</span><span class="nc">AbstractPSEApplication</span><span class="o">)</span><span class="n">app</span><span class="o">).</span><span class="na">getTopBOMLine</span><span class="o">()</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentBOMLine</span> <span class="o">[]</span><span class="nc">Lines</span><span class="o">=</span> <span class="o">(</span> <span class="o">(</span><span class="nc">AbstractPSEApplication</span><span class="o">)</span> <span class="n">app</span><span class="o">).</span><span class="na">getSelectedBOMLines</span><span class="o">()</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="添加对象到bomline"><span class="me-2">添加对象到BOMLine</span><a href="#添加对象到bomline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentBOMLine</span> <span class="n">tcComponentBomLine1</span> <span class="o">=</span><span class="n">tcomponentBomWindow</span><span class="o">.</span><span class="na">setWindowTopLine</span> <span class="o">(</span><span class="n">tcComponentItem</span><span class="o">,</span><span class="n">tcComponentI</span> <span class="n">temRevision1</span><span class="err">，</span><span class="n">tcComponent</span><span class="o">,</span><span class="n">tcComponent1</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="java调用c的方法"><span class="me-2">Java调用c的方法</span><a href="#java调用c的方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>有时候某些功能需要Java程序和C语言程序同时去处理，以下是Java程序调用C语言程序的方法，以调用C语言程序来创建I tem为例:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nc">TCUserService</span> <span class="n">userServ</span> <span class="o">=</span> <span class="n">sessionObj</span><span class="o">.</span><span class="na">getUserService</span><span class="o">()</span> <span class="o">;</span>
<span class="nc">Object</span> <span class="n">objs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
<span class="nc">String</span> <span class="n">itemId</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span> <span class="s">"1234"</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">itemRev</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span> <span class="o">(</span><span class="s">"A"</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">itemName</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span> <span class="o">(</span><span class="s">"Nameof1234"</span> <span class="o">);</span>
<span class="n">objs</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">itemId</span><span class="o">;</span>
<span class="n">objs</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">itemRev</span><span class="o">;</span>
<span class="n">objs</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="n">itemName</span><span class="o">;</span>
<span class="nc">TCComponent</span> <span class="n">itemComp</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponent</span><span class="o">)</span> <span class="n">userServ</span><span class="o">.</span><span class="na">call</span> <span class="o">(</span> <span class="s">"createItem"</span><span class="o">,</span><span class="n">objs</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>通过以下的方式，可以取得目前的session user所属的newstuff folder, 并将objects贴附在这个folder下</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentFolder</span> <span class="n">newStuffFolder</span><span class="o">=</span><span class="n">tcfolder</span><span class="o">.</span> <span class="nf">getNewStuffFolder</span> <span class="o">(</span><span class="n">session</span><span class="o">)</span> <span class="o">;</span>
<span class="n">newStuffFolder</span><span class="o">.</span><span class="na">add</span> <span class="o">(</span><span class="s">"contents"</span><span class="o">,</span><span class="n">tcComponentItem</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>通过以下的方式，建立一个已经存在的workflow template, 并将i tem贴附到target中:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentProcessType</span> <span class="n">tcComponentProcessType</span><span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentProcessType</span><span class="o">)</span> <span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span><span class="o">(</span><span class="s">"Job' ) ;
TCComponentProcess newProcess:s= (TCComponentProcess) tcComponentProcessType.create (PROCESS NAME， PROCESS DESC ，WORKFLOW TEMPLATE NAME，TCComponent[], Target : 1) ;
TCComponentTaskTemplateType tcComponentTaskTemplateType
=(TCComponentTaskTemplateType) session. getTypeComponent ( "</span><span class="nc">EPMTaskTemplate</span><span class="err">"</span><span class="o">);</span>
<span class="n">tcComponentTaskTemplate</span><span class="o">=</span><span class="n">tcComponentTaskTemplateType</span><span class="o">.</span><span class="na">extentReadyTemplates</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<h2 id="第四章"><span class="me-2">第四章</span><a href="#第四章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>菜单定制是各种软件及其开发平台都会提供的必备功能。Teamcenter平台继承自Eclipse平台，其菜单功能与Eclipse平台是一脉相承的，因此Teamcenter平 台也提供了丰富的菜单功能项。如何实现Teamcenter的菜单功能，是Teamcenter二次 开发者必须掌握的重要技能。本章节将重点介绍Teamcenter中菜单的定制方法，并且以示例的方式引导读者深入了解Teamcenter的菜单定制功能。</p>
<h3 id="菜单定制"><span class="me-2">菜单定制</span><a href="#菜单定制" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Teamcenter Rich Client客户端本身是一个RCP程序，Teamcenter菜单的扩展遵循Ecl ipse菜单扩展的规则，给开发
人员提供了很好的用户体验。
Teamcenter菜单种类包括:</p>
<ul>
<li>主菜单.</li>
<li>上下文菜单</li>
<li>视图/编辑器菜单</li>
<li>工具栏按钮</li>
<li>发送到菜单</li>
<li>切换菜单项Toggle menu Item</li>
</ul>
<h4 id="teamcenter主菜单"><span class="me-2"><strong>Teamcenter主菜单</strong></span><a href="#teamcenter主菜单" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>主菜单一般位于软件的最顶层。下 图中的Sample Menu， 就是二次开发定制的主菜单，我们称这类菜单为一级主菜单。点开一-级主菜单“编辑”后，展开的一般是二级主菜单。Teamcenter平台即支持定制一 级菜单，也支持在OOTB平台.上定制二级菜单。主菜单在哪些应用程序显示，在什么情况下显示，也是可以定制的。</p>
<h4 id="上下文菜单"><span class="me-2">上下文菜单</span><a href="#上下文菜单" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>上下文菜单(Context Menu)，也称为快捷菜单(Shortcut Menu) ,右键点击时才会出现，出现频率较高的菜单项才会出现在上下文菜单中。上下文菜单具有很强的灵活项，随着点击对象的不同，弹出的菜单也会有相应的变化。</p>
<h4 id="视图-编辑器菜单"><span class="me-2">视图/编辑器菜单</span><a href="#视图-编辑器菜单" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>视图/编辑器菜单(ViewPart/EditorPartMenu)，最右侧弹出的就是“详细信息”视图的菜单。这部分区域的菜单，也是可定制的。</p>
<h4 id="工具栏按钮"><span class="me-2">工具栏按钮</span><a href="#工具栏按钮" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>工具栏(Toolbar) 是显示位图式按钮行的控制条，使用位图式按钮用来执行命令。按工具栏按钮相当于选择菜单项;如果某个菜单项具有和工具栏按钮相同的ID，那么使用工具栏按钮将会调用映射到该菜单项的同一个处理程序。可以配置按钮，使其在外观和行为上表现为普通按钮、单选按钮或复选框。</p>
<h3 id="菜单扩展点"><span class="me-2">菜单扩展点</span><a href="#菜单扩展点" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>按照RCP开发方式，菜单配置信息位于plugin. xml文件中,Teamcenter提供了两种扩展点供用户添加菜单到相应的位置:</p>
<blockquote>
<p>org.eclipse.ui.actionSets,简称为Actions方式;</p>
<p>org.eclipse.ui.commands，简称为Commands方式。</p>
</blockquote>
<p>Actions,方式为界面上不同区域的表现方式提供了相应的扩展点，并且没有分离其界面表现和内在实现。主要在Teamcenter2007及以前的版本使用，后续版本使用Commands方式扩展。因此，课程仅讲解Commands方式的菜单项扩展。</p>
<p>Commands;方式通过三步设置，有效的达到界面表现和内部实现的分离:</p>
<ol>
<li>通过org. eclipse. ui. commands 扩展点创建命令和类别(Category)，并且可以把某些命令放在- 一个类别(Category) 中;</li>
<li>通过org. eclipse. ui. menus指定命令出现在界面的哪个区域(视图菜单/主菜单/上下文菜单) ;</li>
<li>通过org. eclipse. ui. handlers指定命令的实现。</li>
</ol>
<p>针对上下文菜单，除了Actions方式和Comnands方式均可创建外，Eclipse还提供了另外一●种创建上下文菜单的扩展点
org. ecl ipse. ui. popupMenus,简称为popupMenus方 式。</p>
<p>采用Commands方 式创建视图菜单，需要引入org. ecl ipse. ui. menus扩展点、org. eclipse. ui. handlers扩
展点和org. eclipse. ui. bindings扩展点。相关知识点包括:</p>
<ol>
<li>菜单项扩展点</li>
<li>locationURI语法规则</li>
<li>菜单显示/隐藏控制方法</li>
</ol>
<h4 id="菜单项扩展点"><span class="me-2">菜单项扩展点</span><a href="#菜单项扩展点" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>在具体介绍各菜单扩展点时，我们使用3.3节“hello,world command” 工程中自动创建的菜单，这份配置主要包括
四个扩展点:
第一个扩展点，定义了命令ID:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">com</span><span class="o">.</span><span class="na">teamcenter</span><span class="o">.</span><span class="na">helloworld</span><span class="o">.</span><span class="na">commands</span><span class="o">.</span><span class="na">sampleCommnand</span>
</pre></td></tr></tbody></table></code></div></div>
<p>在这个扩展点中，主要定义command id。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">name=</span><span class="s">"Sample Category"</span> <span class="na">id=</span><span class="s">"com.teamcenter.helloworld.commands.category"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/category&gt;</span>
    <span class="nt">&lt;command</span> <span class="na">name=</span> <span class="s">='</span> <span class="err">Sample</span> <span class="err">Command"</span>
    <span class="na">categoryId=</span><span class="s">" com.teamcenter.helloworld.commands.category"</span> <span class="na">id=</span><span class="s">" com.teamcenter.helloworld.commands.sampleCommand"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>第三个扩展点，是给COMMANID增加快捷键的绑定。这个
扩展点主要用于增强用户体验。M1+6代表了当按下快捷键.
Ctr1+6时也会执行相应的命令，M2代表Shift。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">" org. eclipse. ui. bindings' &gt;
    &lt;key commandId="</span> <span class="err">com.teamcenter.helloworld.commands.sampleCommand"</span> <span class="na">contextId=</span><span class="s">”org.eclipse.ui.contexts.window"</span> <span class="na">sequence=</span><span class="s">“M1+6"schemeId="</span> <span class="err">org.</span> <span class="err">eclipse.</span> <span class="err">ui.</span> <span class="err">defaul</span> <span class="err">tAcce</span> <span class="err">leratorConf</span> <span class="err">iguration"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>第四个扩展点，完成了采单的定义。这个扩展点需要重
点掌握，我们大部分的菜单配置项，都在这个扩展点中实现。.</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">" org.eclipse.ui.menus"</span> <span class="nt">&gt;</span>
	<span class="nt">&lt;menuContribution</span> <span class="err">locat</span> <span class="na">ionURI=</span><span class="s">' menu:org. eclipse. ui. main. menu?after additions'</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;menu</span> <span class="err">1</span><span class="na">abe1=</span><span class="s">"Sample Menu"</span> <span class="na">mnemonic=</span><span class="s">"M"</span> <span class="na">id=</span> <span class="s">'com.teamcenter.helloworld.menus.sampleMenu'</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span> <span class="na">commandId=</span> <span class="s">="</span> <span class="err">com.</span> <span class="err">teamcenter.</span> <span class="err">hellowor</span> <span class="err">ld.</span> <span class="err">commands.</span> <span class="err">sampleCommand"</span> <span class="na">mnemonic=</span><span class="s">"S"</span>
            <span class="na">id=</span><span class="s">" com. teamcenter. hel lowor ld. menus. sampl eCommand”&gt;
            &lt;/command&gt;
        &lt;/menu&gt;
	&lt;/menuContribution&gt;
    &lt;menuContribution locationURI= toolbar:org.eclipse.ui.main.toolbar?after=additions' &gt;
        &lt;toolbar id= "</span><span class="err">com.teamcenter.helloworld.toolbars.sampleToolbar"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">" com. teamcenter. hel loworld. commands. sampl eCommand"</span>
            <span class="err">icon</span> <span class="err">:"icons/sample.gif"</span> <span class="na">tooltip=</span><span class="s">"Say hello world"</span> <span class="na">id=</span><span class="s">"</span> <span class="err">com.teamcenter.helloworld.toolbars.sampleCommand^</span> <span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/toolbar&gt;</span>
    <span class="nt">&lt;/menuContribution&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h3 id="locationuri语法规则"><span class="me-2">locationURI语法规则</span><a href="#locationuri语法规则" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>在定义菜单在Teamcenter出现的位置，需要设置locationURI的参数值。locationURI属性格式如 下:</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"[Scheme]:[id] ? [argument-list] "</span><span class="nt">&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>其中:</p>
<ul>
<li>Scheme 为该菜单项出现的区域，为menu、popup、toolbar中 的任何一个。</li>
<li>id为菜单区域ID,即现在已经存在的菜单ID、视图ID。</li>
<li>argument-list为该菜单项出现在指定菜单的位置。</li>
</ul>
<h4 id="主菜单定义"><span class="me-2">主菜单定义</span><a href="#主菜单定义" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>通过Commands 方式把菜单项添加到主菜单及其工具栏上，和视图菜单一样，也是通过扩 展点org. eclipse. ui. menus
;实现，需要设定其menuContribution的locationURI。</p>
<p>例如，添加一个菜单(菜单可以包含若干个菜单项)到主菜单栏中的某一个位置，其locationURI 为:</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>menu:org.eclipse.ui.main.menu?before=Edit
</pre></td></tr></tbody></table></code></div></div>
<p>例如，把菜单项添加到已经存在的菜单当中。例如，添加-一个菜单项到File主菜单当中，其locationURI为:</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>menu:File?after=addition
</pre></td></tr></tbody></table></code></div></div>
<p>例如，在DetailsView的 下拉菜单加一一个 菜单项，其MenuContribution的locationURI 应为:</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>menu: org.eclipse.ui.views.DetailsView?after=additions
</pre></td></tr></tbody></table></code></div></div>
<p>快捷键参数</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nl">D:</span><span class="err">\</span><span class="nc">Siemens</span><span class="err">\</span><span class="nc">Teamcenter10</span><span class="err">\</span><span class="n">portal</span><span class="err">\</span><span class="n">portal</span><span class="o">.</span><span class="na">bat</span> <span class="o">-</span><span class="n">nl</span> <span class="n">zh_CN</span>
<span class="nl">D:</span><span class="err">\</span><span class="nc">Siemens</span><span class="err">\</span><span class="nc">Teamcenter10</span><span class="err">\</span><span class="n">portal</span><span class="err">\</span><span class="n">portal</span><span class="o">.</span><span class="na">bat</span> <span class="o">-</span><span class="n">nl</span> <span class="n">en_US</span>
</pre></td></tr></tbody></table></code></div></div>
<p>plugin.xml文件中定义的脚本程序：</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
   <span class="nt">&lt;extension</span>
         <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;category</span>
            <span class="na">name=</span><span class="s">"Sample Category"</span>
            <span class="na">id=</span><span class="s">"c9.mycustom.commands.category"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/category&gt;</span>
      <span class="nt">&lt;command</span>
            <span class="na">name=</span><span class="s">"Sample Command"</span>
            <span class="na">categoryId=</span><span class="s">"c9.mycustom.commands.category"</span>
            <span class="na">id=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/command&gt;</span>
   <span class="nt">&lt;/extension&gt;</span>
   <span class="nt">&lt;extension</span>
         <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;handler</span>
            <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
            <span class="na">class=</span><span class="s">"c9.mycustom.handlers.SampleHandler"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/handler&gt;</span>
   <span class="nt">&lt;/extension&gt;</span>
   <span class="nt">&lt;extension</span>
         <span class="na">point=</span><span class="s">"org.eclipse.ui.bindings"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;key</span>
            <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
            <span class="na">contextId=</span><span class="s">"org.eclipse.ui.contexts.window"</span>
            <span class="na">sequence=</span><span class="s">"M1+6"</span>
            <span class="na">schemeId=</span><span class="s">"org.eclipse.ui.defaultAcceleratorConfiguration"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/key&gt;</span>
   <span class="nt">&lt;/extension&gt;</span>
   <span class="nt">&lt;extension</span>
         <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;menuContribution</span>
           <span class="na">locationURI=</span><span class="s">"menu:org.eclipse.ui.main.menu?before=Edit"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menu</span>
              <span class="na">label=</span><span class="s">"Sample Menu"</span>
              <span class="na">mnemonic=</span><span class="s">"M"</span>
              <span class="na">id=</span><span class="s">"c9.mycustom.menus.sampleMenu"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;command</span>  <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
                 <span class="na">mnemonic=</span><span class="s">"S"</span>
                 <span class="na">id=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;/command&gt;</span>         
           <span class="nt">&lt;visibleWhen&gt;</span>
            <span class="nt">&lt;or&gt;</span>
             <span class="nt">&lt;reference</span> <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>; 
             <span class="nt">&lt;reference</span> <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.cme.mpp.inMainView"</span> <span class="nt">&gt;</span>;
            <span class="nt">&lt;/or&gt;</span>
           <span class="nt">&lt;/visibleWhen&gt;</span>  
        <span class="nt">&lt;/menu&gt;</span>
     <span class="nt">&lt;/menuContribution&gt;</span>
       <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"menu:file?after=additions"</span><span class="nt">&gt;</span>
			 <span class="nt">&lt;command</span>
                  <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
                  <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                   <span class="na">mnemonic=</span><span class="s">"S"</span>
                  <span class="na">id=</span><span class="s">"c9.mycustom.commands.sampleCommand3"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
		<span class="nt">&lt;/menuContribution&gt;</span>
      <span class="nt">&lt;menuContribution</span>
            <span class="na">locationURI=</span><span class="s">"toolbar:org.eclipse.ui.main.toolbar?after=additions"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;toolbar</span>
               <span class="na">id=</span><span class="s">"c9.mycustom.toolbars.sampleToolbar"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                  <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
                  <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                  <span class="na">tooltip=</span><span class="s">"Say hello world"</span>
                  <span class="na">id=</span><span class="s">"c9.mycustom.toolbars.sampleCommand"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
         <span class="nt">&lt;/toolbar&gt;</span>
      <span class="nt">&lt;/menuContribution&gt;</span>
      <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"menu:com.teamcenter.rac.ui.views.DetailsView?after=additions"</span><span class="nt">&gt;</span>
			 <span class="nt">&lt;command</span>
                  <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
                  <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                  <span class="na">mnemonic=</span><span class="s">"S"</span>
                  <span class="na">id=</span><span class="s">"c9.mycustom.commands.sampleCommand2"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
		<span class="nt">&lt;/menuContribution&gt;</span>
		      <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"toolbar:com.teamcenter.rac.ui.views.DetailsView?after=additions"</span><span class="nt">&gt;</span>
			 <span class="nt">&lt;command</span>
                  <span class="na">commandId=</span><span class="s">"c9.mycustom.commands.sampleCommand"</span>
                  <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                  <span class="na">mnemonic=</span><span class="s">"S"</span>
                  <span class="na">id=</span><span class="s">"c9.mycustom.commands.sampleCommand22"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
		<span class="nt">&lt;/menuContribution&gt;</span>
   <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="上下文菜单-1"><span class="me-2">上下文菜单</span><a href="#上下文菜单-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Commands;方式与添加视图菜单和主菜单的方式-样，通过设定其menuContribution的locationURI 来实现。
例如，添加一个上下文菜单到快捷菜单中，其locat ionURI为:
<code>popup:org.eclipse.ui.popup.any?after=additions</code></p>
<h4 id="菜单显示-隐藏控制方法"><span class="me-2">菜单显示/隐藏控制方法</span><a href="#菜单显示-隐藏控制方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>菜单控制是-一个常见的功能。例如，随着选定的内容或当前窗口的不同，菜单中的菜单项会有相应的变化(显示/隐藏或启用/禁用菜单项)。如何控制菜单是插件开发必须掌握的知识。Eclipse为菜单控制提供了两种方法，一种是通过扩展点;另一种是通过API的方式编写程序控制。通过Command方式创建的菜单，可以通过org. eclipse. ui. commands的visibleWhen 属性控制菜单的显示和隐藏。visibleWhen是用于控制菜单显示的核心表达式。该标签即可位于menu标签之下，也可位于command标签之前。尽管从官方的语法说明来看，可以作用于toobar标签下，但是经过测试toolbar 下的visibl eWhen标签不生效。通过org. eclipse. ui. handlers的activewhen 或enabledWhen 控制菜单的启用或禁用。</p>
<p>visibleWhen可以用在command、menu子节点下在menu标签下，添加如下代码，可以让该菜单及其子菜单，仅仅显示在“我的Teamcenter”、“制造工艺规划器中”和“分类”。“or.”标签用于在多个应用程序中显示。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;visibleWhen&gt;</span>
    <span class="nt">&lt;or&gt;</span>
    <span class="nt">&lt;reference</span> <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective”&gt;;
    &lt;reference definitionId="</span> <span class="err">com.</span> <span class="err">teamcenter.</span> <span class="err">rac.</span> <span class="err">cme.</span> <span class="err">mpp.</span> <span class="err">inMainView'</span><span class="nt">&gt;</span>;
    <span class="nt">&lt;reference</span>
    <span class="na">definitionId=</span><span class="s">" com. teamcenter. rac. classification. icm. inMainView"</span> <span class="nt">&gt;</span>;
    <span class="nt">&lt;/or&gt;</span>
<span class="nt">&lt;/visibleWhen&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Teamcenter中常见的应用程序ID如下:</p>
<blockquote>
<p>“我的Teamcenter”: com.teamcenter. rac. ui.inMainPerspective
“制造工艺规划器”: com.teamcenter. rac. cme. mpp. inMainView
“结构管理器”: com. teamcenter. rac. pse. inMainView .
“分类管理”: com. teamcenter. rac. classification. icadmin. inMainView
“分类”:com. teamcenter. rac. classification. icm. inMainView
“入门”: com. teamcenter. rac. gettingstarted. inMainView
“项目”: com. teamcenter. rac. project. inMainView</p>
</blockquote>
<h4 id="实践练习一"><span class="me-2">实践练习一：</span><a href="#实践练习一" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>加载项目c9. mycustom，查看其扩展的设置方式，并修改:</p>
<ul>
<li>自定义菜单sampl eCommand在Main menu中 出现的位置,出现在windows菜单中;</li>
<li>自定义菜单sampleCommand出现在上下文菜单中。</li>
</ul>
<h4 id="实践练习二"><span class="me-2">实践练习二：</span><a href="#实践练习二" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>定义两个主菜单报表输出、功能</p>
<p>报表输出含有：产品报表导出</p>
<p>功能：创建项目文件夹、创建数据文件夹、修改技术文档ID</p>
<h3 id="实例"><span class="me-2">实例</span><a href="#实例" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<h4 id="工具栏toolbar"><span class="me-2">工具栏toolbar</span><a href="#工具栏toolbar" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.6"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"Sample Command"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span>
                 <span class="na">class=</span><span class="s">"com.mycom.addbutton.handlers.SampleHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"toolbar:navigator_Toolbar?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span>
                     <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                     <span class="na">tooltip=</span><span class="s">"Say hello world"</span>
                     <span class="na">id=</span><span class="s">"com.mycom.addbutton.toolbars.sampleCommand"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;visibleWhen&gt;</span>
                    <span class="nt">&lt;reference</span>
                               <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;/reference&gt;</span>
                <span class="nt">&lt;/visibleWhen&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="菜单栏中添加一个新的菜单"><span class="me-2">菜单栏中添加一个新的菜单</span><a href="#菜单栏中添加一个新的菜单" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.6"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"Sample Command"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.addmenuitem.commands.sampleCommand"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.mycom.addmenuitem.commands.sampleCommand"</span>
                 <span class="na">class=</span><span class="s">"com.mycom.addmenuitem.handlers.SampleHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"menu:tools?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.mycom.addmenuitem.commands.sampleCommand"</span>
                     <span class="na">mnemonic=</span><span class="s">"S"</span>
                     <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                     <span class="na">id=</span><span class="s">"com.mycom.addmenuitem.menus.sampleCommand"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;visibleWhen&gt;</span>
                    <span class="nt">&lt;reference</span>
                               <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;/reference&gt;</span>
                <span class="nt">&lt;/visibleWhen&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.mycom.addmenuitem.handlers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.core.commands.AbstractHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.core.commands.ExecutionEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.core.commands.ExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.ui.IWorkbenchWindow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.ui.handlers.HandlerUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.eclipse.jface.dialogs.MessageDialog</span><span class="o">;</span>
<span class="cm">/**
 * Our sample handler extends AbstractHandler, an IHandler base class.
 * @see org.eclipse.core.commands.IHandler
 * @see org.eclipse.core.commands.AbstractHandler
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleHandler</span> <span class="kd">extends</span> <span class="nc">AbstractHandler</span> <span class="o">{</span>
	<span class="cm">/**
	 * The constructor.
	 */</span>
	<span class="kd">public</span> <span class="nf">SampleHandler</span><span class="o">()</span> <span class="o">{</span>
	<span class="o">}</span>
	<span class="cm">/**
	 * the command has been executed, so extract extract the needed information
	 * from the application context.
	 */</span>
	<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">ExecutionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ExecutionException</span> <span class="o">{</span>
		<span class="nc">IWorkbenchWindow</span> <span class="n">window</span> <span class="o">=</span> <span class="nc">HandlerUtil</span><span class="o">.</span><span class="na">getActiveWorkbenchWindowChecked</span><span class="o">(</span><span class="n">event</span><span class="o">);</span>
		<span class="nc">MessageDialog</span><span class="o">.</span><span class="na">openInformation</span><span class="o">(</span>
				<span class="n">window</span><span class="o">.</span><span class="na">getShell</span><span class="o">(),</span>
				<span class="s">"Addmenuitem"</span><span class="o">,</span>
				<span class="s">"demo"</span><span class="o">);</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>菜单栏选项</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;category</span>
                  <span class="na">name=</span><span class="s">"Sample Category"</span>
                  <span class="na">id=</span><span class="s">"com.teamcenter.rac.toggleexample.commands.category"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/category&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">categoryId=</span><span class="s">"com.mycom.toggle.commands.category"</span>
                 <span class="na">defaultHandler=</span><span class="s">"com.mycom.toggle.handlers.ToggleInfoHandler"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.toggle.commands.infoCommand"</span>
                 <span class="na">name=</span><span class="s">"Info"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;state</span>
                   <span class="na">class=</span><span class="s">"org.eclipse.ui.handlers.RegistryToggleState:true"</span>
                   <span class="na">id=</span><span class="s">"org.eclipse.ui.commands.toggleState"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/state&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">categoryId=</span><span class="s">"com.mycom.toggle.commands.category"</span>
                 <span class="na">defaultHandler=</span><span class="s">"com.mycom.toggle.handlers.ToggleWarnHandler"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.toggle.commands.warnCommand"</span>
                 <span class="na">name=</span><span class="s">"Warn"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;state</span>
                   <span class="na">class=</span><span class="s">"org.eclipse.ui.handlers.RegistryToggleState:false"</span>
                   <span class="na">id=</span><span class="s">"org.eclipse.ui.commands.toggleState"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/state&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">categoryId=</span><span class="s">"com.mycom.toggle.commands.category"</span>
                 <span class="na">defaultHandler=</span><span class="s">"com.mycom.toggle.handlers.ToggleErrorHandler"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.toggle.commands.errorCommand"</span>
                 <span class="na">name=</span><span class="s">"Error"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;state</span>
                   <span class="na">class=</span><span class="s">"org.eclipse.ui.handlers.RegistryToggleState:false"</span>
                   <span class="na">id=</span><span class="s">"org.eclipse.ui.commands.toggleState"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/state&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"menu:org.eclipse.ui.main.menu?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;menu</span>
                  <span class="na">id=</span><span class="s">"com.mycom.toggle.menus.sampleMenu"</span>
                  <span class="na">label=</span><span class="s">"Error Level"</span>
                  <span class="na">mnemonic=</span><span class="s">"L"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.mycom.toggle.commands.infoCommand"</span>
                         <span class="na">label=</span><span class="s">"Info"</span>
                         <span class="na">mnemonic=</span><span class="s">"I"</span>
                         <span class="na">style=</span><span class="s">"toggle"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;visibleWhen&gt;</span>
                        <span class="nt">&lt;reference</span>
                                   <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/reference&gt;</span>
                    <span class="nt">&lt;/visibleWhen&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.mycom.toggle.commands.warnCommand"</span>
                         <span class="na">label=</span><span class="s">"Warn"</span>
                         <span class="na">mnemonic=</span><span class="s">"W"</span>
                         <span class="na">style=</span><span class="s">"toggle"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;visibleWhen&gt;</span>
                        <span class="nt">&lt;reference</span>
                                   <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/reference&gt;</span>
                    <span class="nt">&lt;/visibleWhen&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.mycom.toggle.commands.errorCommand"</span>
                         <span class="na">label=</span><span class="s">"Error"</span>
                         <span class="na">mnemonic=</span><span class="s">"E"</span>
                         <span class="na">style=</span><span class="s">"toggle"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;visibleWhen&gt;</span>
                        <span class="nt">&lt;reference</span>
                                   <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/reference&gt;</span>
                    <span class="nt">&lt;/visibleWhen&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;/menu&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621220623531.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621220623531.png" alt="image-20200621220623531" loading="lazy"></a></p>
<h4 id="在右键上添加"><span class="me-2">在右键上添加</span><a href="#在右键上添加" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.6"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"Sample Command"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.addshortcut.commands.sampleCommand"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.mycom.addshortcut.commands.sampleCommand"</span>
                 <span class="na">class=</span><span class="s">"com.mycom.addshortcut.handlers.SampleHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.mycom.addshortcut.commands.sampleCommand"</span>
                     <span class="na">mnemonic=</span><span class="s">"S"</span>
                     <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                     <span class="na">id=</span><span class="s">"com.mycom.addshortcut.menus.sampleCommand"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;visibleWhen&gt;</span>
                    <span class="nt">&lt;reference</span>
                               <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;/reference&gt;</span>
                <span class="nt">&lt;/visibleWhen&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
	<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;command</span> <span class="na">id=</span><span class="s">"CustNewItem"</span> <span class="na">name=</span><span class="s">"Create New Item"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;command</span> <span class="na">id=</span><span class="s">"CustNewDataset"</span> <span class="na">name=</span><span class="s">"Create New Dataset"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/extension&gt;</span>
	<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;handler</span> <span class="na">commandId=</span><span class="s">"CustNewDataset"</span> 
		<span class="na">class=</span><span class="s">"com.teamcenter.rac.handlers.LegacyHandler:newDatasetAction:com.teamcenter.rac.common.actions.actions"</span> <span class="nt">&gt;</span>;
        <span class="nt">&lt;handler</span> <span class="na">commandId=</span><span class="s">"CustNewItem"</span> 
        <span class="na">class=</span><span class="s">"com.teamcenter.rac.handlers.LegacyHandler:newItemAction:com.teamcenter.rac.common.actions.actions"</span> <span class="nt">&gt;</span>;
	<span class="nt">&lt;/extension&gt;</span>
	<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">"CustNewItem"</span><span class="nt">&gt;&lt;/command&gt;</span>
		<span class="nt">&lt;/menuContribution&gt;</span>
        <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">"CustNewDataset"</span><span class="nt">&gt;&lt;/command&gt;</span>
		<span class="nt">&lt;/menuContribution&gt;</span>
	<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="视图"><span class="me-2">视图</span><a href="#视图" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.6"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;command</span>
	<span class="na">name=</span><span class="s">"Sample Command"</span>
	<span class="na">id=</span><span class="s">"com.mycom.customview.commands.sampleCommand"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;handler</span>
	    <span class="na">commandId=</span><span class="s">"com.mycom.customview.commands.sampleCommand"</span>
	    <span class="na">class=</span><span class="s">"com.mycom.customview.handlers.SampleHandler"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/handler&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;menuContribution</span>
	<span class="na">locationURI=</span><span class="s">"menu:org.eclipse.ui.main.menu?after=additions"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;menu</span>
			<span class="na">label=</span><span class="s">"Sample Menu"</span>
			<span class="na">mnemonic=</span><span class="s">"M"</span>
			<span class="na">id=</span><span class="s">"com.mycom.customview.menus.sampleMenu"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;command</span>
			<span class="na">commandId=</span><span class="s">"com.mycom.customview.commands.sampleCommand"</span>
			<span class="na">mnemonic=</span><span class="s">"S"</span>
			<span class="na">id=</span><span class="s">"com.mycom.customview.menus.sampleCommand"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;visibleWhen&gt;</span>
					<span class="nt">&lt;reference</span>
					<span class="na">definitionId=</span><span class="s">"com.mycom.customview.inMainView"</span> <span class="nt">&gt;</span>;
				<span class="nt">&lt;/visibleWhen&gt;</span>
			<span class="nt">&lt;/command&gt;</span>
		<span class="nt">&lt;/menu&gt;</span>
	<span class="nt">&lt;/menuContribution&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.views"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;view</span>
		<span class="na">name=</span><span class="s">"MyCom Custom View"</span>
		<span class="na">class=</span><span class="s">"com.mycom.customview.views.CustomView"</span>
		<span class="na">id=</span><span class="s">"com.mycom.customview.views.CustomView"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/view&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.core.expressions.definitions"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;definition</span> <span class="na">id=</span><span class="s">"com.mycom.customview.inMainView"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;with</span> <span class="na">variable=</span><span class="s">"activePartId"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;equals</span> <span class="na">value=</span><span class="s">"com.mycom.customview.views.CustomView"</span> <span class="nt">&gt;</span>;
		<span class="nt">&lt;/with&gt;</span>
	<span class="nt">&lt;/definition&gt;</span>
<span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="退出"><span class="me-2">退出</span><a href="#退出" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;category</span>
                  <span class="na">name=</span><span class="s">"Sample Category"</span>
                  <span class="na">id=</span><span class="s">"com.teamcenter.rac.exit.commands.category"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/category&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"Sample Command"</span>
                 <span class="na">categoryId=</span><span class="s">"com.mycom.exitcommand.commands.category"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.exitcommand.commands.sampleCommand"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">defaultHandler=</span><span class="s">"com.mycom.exitcommand.handlers.SampleHandler"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.exitcommand.command1.Exit"</span>
                 <span class="na">name=</span><span class="s">"Exit"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.mycom.exitcommand.commands.sampleCommand"</span>
                 <span class="na">class=</span><span class="s">"com.mycom.exitcommand.handlers.SampleHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.bindings"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;key</span>
             <span class="na">commandId=</span><span class="s">"com.mycom.exitcommand.commands.sampleCommand"</span>
             <span class="na">contextId=</span><span class="s">"org.eclipse.ui.contexts.window"</span>
             <span class="na">sequence=</span><span class="s">"M1+6"</span>
             <span class="na">schemeId=</span><span class="s">"org.eclipse.ui.defaultAcceleratorConfiguration"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span>
               <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"menu:com.teamcenter.rac.ui.views.DetailsView?after=group4"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;menu</span>
                  <span class="na">id=</span><span class="s">"closeMenu"</span>
                  <span class="na">label=</span><span class="s">"Close"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.mycom.exitcommand.command1.Exit"</span>
                         <span class="na">label=</span><span class="s">"Exit"</span>
                         <span class="na">style=</span><span class="s">"push"</span>
                         <span class="na">tooltip=</span><span class="s">"Exit the application"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;/menu&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"toolbar:com.teamcenter.rac.ui.views.DetailsView"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;toolbar</span>
                     <span class="na">id=</span><span class="s">"com.mycom.exitcommand.toolbar1"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.mycom.exitcommand.command1.Exit"</span>
                         <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                         <span class="na">label=</span><span class="s">"Exit"</span>
                         <span class="na">style=</span><span class="s">"push"</span>
                         <span class="na">tooltip=</span><span class="s">"Exit the application"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;/toolbar&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.mycom.exitcommand.command1.Exit"</span>
                     <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                     <span class="na">label=</span><span class="s">"Exit"</span>
                     <span class="na">style=</span><span class="s">"push"</span>
                     <span class="na">tooltip=</span><span class="s">"Exit the application"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="综合"><span class="me-2">综合</span><a href="#综合" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.4"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"新建文件夹"</span>
                 <span class="na">id=</span><span class="s">"com.origin.custom.handler.newFolderHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.origin.custom.handler.newFolderHandler"</span>
                 <span class="na">class=</span><span class="s">"com.origin.custom.handler.NewFolderHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span>  <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span> <span class="na">locationURI=</span><span class="s">"menu:org.eclipse.ui.main.menu?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;menu</span> <span class="na">label=</span><span class="s">"客户化菜单(M)"</span> <span class="na">mnemonic=</span><span class="s">"M"</span> <span class="na">id=</span><span class="s">"customMenus"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.origin.custom.handler.newFolderHandler"</span>
                         <span class="na">mnemonic=</span><span class="s">"S"</span>
                         <span class="na">icon=</span><span class="s">"icons/newfolder_16.png"</span>
                         <span class="na">id=</span><span class="s">"customMenus"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;visibleWhen&gt;</span>
                        <span class="nt">&lt;reference</span>
                                   <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;/reference&gt;</span>
                    <span class="nt">&lt;/visibleWhen&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;/menu&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"toolbar:org.eclipse.ui.main.toolbar?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;toolbar</span> <span class="na">id=</span><span class="s">"customToolbar"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span>
                         <span class="na">commandId=</span><span class="s">"com.origin.custom.handler.newFolderHandler"</span>
                         <span class="na">icon=</span><span class="s">"icons/newfolder_16.png"</span>
                         <span class="na">tooltip=</span><span class="s">"新建文件夹"</span>
                         <span class="na">id=</span><span class="s">"customToolbar"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;/toolbar&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"popup:org.eclipse.ui.popup.any?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.origin.custom.handler.newFolderHandler"</span>
                     <span class="na">mnemonic=</span><span class="s">"S"</span>
                     <span class="na">icon=</span><span class="s">"icons/newfolder_16.png"</span>
                     <span class="na">id=</span><span class="s">"customPopup"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;visibleWhen&gt;</span>
                    <span class="nt">&lt;reference</span>
                               <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;/reference&gt;</span>
                <span class="nt">&lt;/visibleWhen&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span> <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<h2 id="第五章"><span class="me-2">第五章</span><a href="#第五章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>五代码化定制任务</p>
<h3 id="5-1-1无代码化定制"><span class="me-2">5.1.1无代码化定制</span><a href="#5-1-1无代码化定制" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>实例:定制Teamcenter 胖客户端logon window.通过定制com.teamcenter.rac.kernel version.jar文件， 当登录TC时，可以改变加载的登录界面。</p>
<p>1、自定义登录窗口(logon window)</p>
<p>使用解压缩包工具打开%TC _RO0T%\portal\plugins\com.teamcenter.rac.kernel_10000.1. 0.jar文件，替换\icons’下的background. png文件。</p>
<p>注意:修改原始文件前，先做好备份，并去掉. jar后缀名。</p>
<p>2、按照清理TC缓存的方法，删除C: \Documents andSettings \Admini strator \Teamcenter*目录，重新打开TC验证功能。</p>
<p>1、修改Views,Dial og boxes,Forms，Wizards的布局和内容</p>
<p>可以使用渲染文件Style sheets来改变Teamcenter views, dialogboxes, forms,和wizards using的布局与内容。Style sheets是一种数据集类型，使用Style sheets可以按照实际需求加载定制的数据属性。可供修改的数据对象包括Views，Dialog boxes，Forms的窗口信息。使用渲染文件进行定制的步骤如下</p>
<p>(1)在TC的Newstuff文件夹中新建XMLRenderingStylesheet数据集。例如，要修改汇总(Summary)视图的布局和加载属性，可以命名数据集为myItemSummary。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621222406300.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621222406300.png" alt="image-20200621222406300" loading="lazy"></a></p>
<p>(2)使用“数据集…..”查询，检索系统中现有的XMLRenderingStylesheet,找到Itemsummary数据集。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621222416976.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621222416976.png" alt="image-20200621222416976" loading="lazy"></a></p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="c">&lt;!--
=======================================================================
Copyright 2012.
Siemens Product Lifecycle Management Software Inc.
All Rights Reserved.
=======================================================================
     Filename: ItemSummary.xml
    Style sheet rendering for Item summary.
=======================================================================
--&gt;</span>
<span class="nt">&lt;rendering</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"XMLRenderingStylesheet_Schema.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;header&gt;</span>
        <span class="nt">&lt;image</span> <span class="na">source=</span><span class="s">"thumbnail"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;classificationTrace&gt;</span>;
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"owning_user"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"release_status_list"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_type"</span><span class="nt">&gt;</span>;
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;page</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_Overview"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;column&gt;</span>
            <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_AvailableRevisions"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"revision_list.ItemRevision"</span> <span class="na">defaultdisplay=</span><span class="s">"listDisplay"</span> <span class="na">sortdirection=</span><span class="s">"descending"</span> <span class="na">sortby=</span><span class="s">"item_revision_id"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;tableDisplay&gt;</span>
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_string"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"item_revision_id"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"release_status_list"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;/tableDisplay&gt;</span>
                    <span class="nt">&lt;thumbnailDisplay&gt;</span>;
                    <span class="nt">&lt;treeDisplay&gt;</span>
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_string"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"item_revision_id"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"release_status_list"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;/treeDisplay&gt;</span>
                    <span class="nt">&lt;listDisplay&gt;</span>;
                <span class="nt">&lt;/objectSet&gt;</span>
            <span class="nt">&lt;/section&gt;</span>
            <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_ItemProperties"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_desc"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;separator&gt;</span>;<span class="c">&lt;!--分隔符--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"owning_user"</span> <span class="na">renderingHint=</span><span class="s">"objectlink"</span> <span class="na">modifiable=</span><span class="s">"false"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"owning_group"</span> <span class="na">renderingHint=</span><span class="s">"objectlink"</span> <span class="na">modifiable=</span><span class="s">"false"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;separator&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;separator&gt;</span>;
                <span class="nt">&lt;command</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.properties"</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_moreProperties"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/section&gt;</span>
            <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_ClassificationProperties"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;classificationProperties&gt;</span>;
            <span class="nt">&lt;/section&gt;</span>
        <span class="nt">&lt;/column&gt;</span>
        <span class="nt">&lt;column&gt;</span>
            <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_Preview"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;image</span> <span class="na">source=</span><span class="s">"preview"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/section&gt;</span>
            <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_actions"</span> <span class="na">commandLayout=</span><span class="s">"vertical"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"copyAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.copy"</span> <span class="nt">&gt;</span>;
                <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"saveAsAction"</span> <span class="na">commandId=</span><span class="s">"org.eclipse.ui.file.saveAs"</span> <span class="nt">&gt;</span>;
                <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"newProcessAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.newProcess"</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_newProc"</span> <span class="nt">&gt;</span>;
            <span class="nt">&lt;/section&gt;</span>
        <span class="nt">&lt;/column&gt;</span>
    <span class="nt">&lt;/page&gt;</span>
    <span class="nt">&lt;page</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_AttachedFiles"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"IMAN_reference.Dataset,IMAN_manifestation.Dataset,IMAN_Rendering.Dataset"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"object_string"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tableDisplay&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_string"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"release_status_list"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"relation"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;thumbnailDisplay&gt;</span>;
            <span class="nt">&lt;treeDisplay&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_string"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"release_status_list"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"relation"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/treeDisplay&gt;</span>
            <span class="nt">&lt;listDisplay&gt;</span>;
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"newBusinessObjectContextualAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.common.AddNew"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"pasteAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.viewer.pastewithContext"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"cutAction"</span> <span class="na">commandId=</span><span class="s">"org.eclipse.ui.edit.cut"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">"localSelection"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/objectSet&gt;</span>
    <span class="nt">&lt;/page&gt;</span>
    <span class="nt">&lt;page</span> <span class="na">title=</span><span class="s">"Related Links"</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_RelatedLinks"</span> <span class="na">visibleWhen=</span><span class="s">"{pref:LIS_RelatedLinkTabVisible}==true"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"IMAN_specification.Lis0Link,IMAN_reference.Lis0Link"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"object_string"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;tableDisplay&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_string"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"lis0site"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"lis0serviceProvider"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"relation"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_date"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"last_mod_user"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"checked_out_user"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"newBusinessObjectContextualAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.lisfmwrk.newRelatedLink"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"copyAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.copy"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">"localSelection"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/command&gt;</span>
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"pasteAction"</span> <span class="na">commandId=</span><span class="s">"com.teamcenter.rac.viewer.pastewithContext"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;command</span> <span class="na">actionKey=</span><span class="s">"cutAction"</span> <span class="na">commandId=</span><span class="s">"org.eclipse.ui.edit.cut"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">"localSelection"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/objectSet&gt;</span>
    <span class="nt">&lt;/page&gt;</span>
    <span class="nt">&lt;page</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_AuditLogs"</span> <span class="na">visibleWhen=</span><span class="s">"{pref:TC_audit_manager_version}==3"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_ExportToExcel"</span>  <span class="na">actionKey=</span><span class="s">"exportExcelAction"</span> <span class="na">commandId =</span> <span class="s">"com.teamcenter.rac.exportAuditSummaryToExcel"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;command</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_ExportToCSV"</span> <span class="na">actionKey=</span><span class="s">"exportCSVAction"</span> <span class="na">commandId =</span> <span class="s">"com.teamcenter.rac.exportAuditSummaryToCSV"</span> <span class="na">renderingHint=</span><span class="s">"commandbutton"</span><span class="nt">&gt;</span>;
        <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_WorkflowLogs"</span> <span class="na">initialstate=</span><span class="s">"collapsed"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;customPanel</span> <span class="na">java=</span><span class="s">"com.teamcenter.rac.auditmanager.WorkflowLegacyAuditLinkPanel"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"fnd0WorkflowAuditLogs.Fnd0WorkflowAudit"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"fnd0LoggedDate"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;tableDisplay&gt;</span>
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0LoggedDate"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_type"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0EventTypeName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_name"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"job_name"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"process_templateDisp"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0UserId"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SponsoringUserID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"task_state"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"task_result"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0Comments"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"responsible_party"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SignoffUserID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SignoffGroupName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SignoffRoleName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectType"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjDispName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjQualifier"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;/objectSet&gt;</span>
            <span class="nt">&lt;customPanel</span> <span class="na">java=</span><span class="s">"com.teamcenter.rac.auditmanager.WorkflowSecondaryAuditPanel"</span> <span class="na">js=</span><span class="s">"displayWorkflowCustomPanel"</span> <span class="nt">&gt;</span>;
        <span class="nt">&lt;/section&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_GeneralLogs"</span> <span class="na">initialstate=</span><span class="s">"collapsed"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;customPanel</span> <span class="na">java=</span><span class="s">"com.teamcenter.rac.auditmanager.CheckoutHistoyLinkPanel"</span><span class="nt">&gt;</span>;
            <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"fnd0GeneralAuditLogs.Fnd0GeneralAudit"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"fnd0LoggedDate"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;tableDisplay&gt;</span>
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0LoggedDate"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_type"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0EventTypeName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_name"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0PrimaryObjectID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0PrimaryObjectRevID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0UserId"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SponsoringUserID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0GroupName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0RoleName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"sequence_id"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0ChangeID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0Reason"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectType"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjDispName"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;/objectSet&gt;</span>
        <span class="nt">&lt;/section&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_LicenseExportLogs"</span> <span class="na">initialstate=</span><span class="s">"collapsed"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"fnd0LicenseExportAuditLogs.Fnd0LicenseExportAudit"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"fnd0LoggedDate"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;tableDisplay&gt;</span>
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0LoggedDate"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_type"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0EventTypeName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_name"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0UserId"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SponsoringUserID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0GroupName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0RoleName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"id"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectRevID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectType"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjDispName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectSeqID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"ead_paragraph"</span><span class="nt">&gt;</span>;
                <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;/objectSet&gt;</span>
            <span class="nt">&lt;customPanel</span> <span class="na">java=</span><span class="s">"com.teamcenter.rac.auditmanager.LicenseExportSecondaryAuditPanel"</span> <span class="na">js=</span><span class="s">"displayLicenseExportCustomPanel"</span> <span class="nt">&gt;</span>;
        <span class="nt">&lt;/section&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">titleKey=</span><span class="s">"tc_xrt_StructureLogs"</span> <span class="na">initialstate=</span><span class="s">"collapsed"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;objectSet</span> <span class="na">source=</span><span class="s">"fnd0StructureAuditLogs.Fnd0StructureAudit"</span> <span class="na">defaultdisplay=</span><span class="s">"tableDisplay"</span> <span class="na">sortby=</span><span class="s">"fnd0LoggedDate"</span> <span class="na">sortdirection=</span><span class="s">"ascending"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;tableDisplay&gt;</span>
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0LoggedDate"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_type"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0EventTypeName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"object_name"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0UserId"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SponsoringUserID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0GroupName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0RoleName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"item_id"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"item_revision_id"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"sequence_id"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectRevID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectType"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjDispName"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"fnd0SecondaryObjectSeqID"</span><span class="nt">&gt;</span>;
                    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"comp_position"</span><span class="nt">&gt;</span>;                  
                <span class="nt">&lt;/tableDisplay&gt;</span>
            <span class="nt">&lt;/objectSet&gt;</span>
            <span class="nt">&lt;customPanel</span> <span class="na">java=</span><span class="s">"com.teamcenter.rac.auditmanager.StructureSecondaryAuditPanel"</span> <span class="na">js=</span><span class="s">"displayStructureCustomPanel"</span> <span class="nt">&gt;</span>;
        <span class="nt">&lt;/section&gt;</span>

<span class="nt">&lt;/page&gt;</span>
<span class="nt">&lt;/rendering&gt;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>(3)将Itemsummary数据集中的XML脚本语句复制到新建的数据集myItemSummary中。可以通过修改XML脚本，增添属
性、修改布局，单击工具栏中的保存按钮进行保存。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621222429260.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621222429260.png" alt="image-20200621222429260" loading="lazy"></a></p>
<p>(4)从查看器中“注册类型”的下拉列表框中选择C9_ myItem，“样式表类型” 的下拉列表框选择“汇总”，单击“应用按钮”，进行配置。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621222441988.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621222441988.png" alt="image-20200621222441988" loading="lazy"></a></p>
<p>(5)在新建的C9 myItem业务对象中，在汇总视图中查看配置后的效果。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621222450202.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621222450202.png" alt="image-20200621222450202" loading="lazy"></a></p>
<p>2、增加或修改对象图标
1)可以修改BMIDE中现有的业务对象图标，或者为新创建的业务对象指定图标。从BIMIE中导入图标的素材，然后将对
应的图标添加到零组件的属性中，通过部署项目完成图标的设置。实例:业务建模器中添加图标</p>
<p>2)可以使用属性文件来修改各类图标。将替代的图标添加到创建的属性文件中，然后将属性文件拖拽到.jar包中。修改属
性文件的图标格式是:business- object.ICON=image-directory/image-file-name实例:使用“自定义发布流程”发布C9_myItem版本对象，实现将发布后的系统默认状态图标变为自定义的图标。</p>
<p>(3)使用普通用户登录Teamcenter,新建C9_ myItem零组 件使用自定义发布流程发布C9_ myItem零组件的A版本数据。此时，发布后的状态图标还是黑色的旗子。</p>
<p>(4)创建configuration_ 10000.1.0文件夹，在此文件夹中新建customer.properties属性文件。在customer.properties 属性文件中添加脚本文件如下，完成对自定义发布状态的图标定制:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">release_</span> <span class="n">status_</span> <span class="n">list</span><span class="o">.</span> <span class="no">I_</span> <span class="nc">Released</span><span class="o">.</span><span class="na">ICON</span><span class="o">=</span><span class="n">images</span><span class="o">/</span><span class="no">C9_</span> <span class="nc">IReleased</span><span class="o">.</span><span class="na">png</span>
<span class="n">release_</span> <span class="n">statuses</span><span class="o">.</span> <span class="no">I_</span> <span class="nc">Released</span><span class="o">.</span><span class="na">ICON</span><span class="o">=</span><span class="n">images</span><span class="o">/</span> <span class="no">C9_</span> <span class="nc">IReleased</span><span class="o">.</span><span class="na">png</span>
</pre></td></tr></tbody></table></code></div></div>
<p>image文件夹中放置C9_ IReleased.png的1 6位像素图标。</p>
<p>image文件夹中放置C9_ IReleased.png的1 6位像素图标。</p>
<p>(5)将configuration_ 10000.1 .0文件夹复制到%TC_ ROOT%\portal\plugins文件家中， 和系统中已有的configuration_ 10000.1 .0文件夹进行合并。</p>
<p>(6)使用genregxml.bat文件注册配置文件，注册完成后清除TC缓存。再使用普通用户登录Teamcenter,查看刚才发布的数据，此时发布状态字变为自定义的图标。</p>
<h3 id="5-2-无代码化定制应用"><span class="me-2">5.2 无代码化定制应用</span><a href="#5-2-无代码化定制应用" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621163511952.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621163511952.png" alt="image-20200621163511952" loading="lazy"></a></p>
<p>授权，针对于组织中的组和子组的用户，开放或收回特定的应用模块。例如，针对工程组的用户，可以开放组织和工作流设计器的功能，由工程组的人员进行组织和流程的设计。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621163546735.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621163546735.png" alt="image-20200621163546735" loading="lazy"></a></p>
<h3 id="5-2-2-首选项"><span class="me-2">5.2.2 首选项</span><a href="#5-2-2-首选项" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p><strong>1、首选项概念</strong></p>
<p>首选项是存储在TC数据库中的环境变量。当设置和修改的时候都要读取。例如可以设置登陆的名称和属性表显示的列，一些权限等都与这些首选项有关。站点（Site）首选项：站点的首选项影响到Teamcenter的整个站点。只有管理员可以创建和修改；用户（User）首选项：用户首选项是针对特定用户的，这个用户可设置和创建，具有最高的优先级，dba组的人员也可创建和修改；组（Group）首选项和 角色（Role）首选项：组和角色的首选项是针对特定的组和角色的，组管理员有权限设置，dba组的人员也可创建和修改</p>
<p><strong>2、首选项的分级规则</strong></p>
<p>首选项分两种，系统首选项和分级首选项：</p>
<p>（1）系统首选项：适用于整个站点；</p>
<p>（2）分级首选项有保护范围：用户，角色，组，站点，级别从用户到站点依次递增。</p>
<p>首选项位置优先顺序是：用户&gt;角色&gt;组&gt;站点。系统根据级别搜索首选项值，开始于当前定义的首选项保护范围，然后根据当前用户-&gt;当前角色-&gt;当前组-&gt;当前站点的顺序读取</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621163722189.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621163722189.png" alt="image-20200621163722189" loading="lazy"></a></p>
<p>首选项保护范围：定义保护范围，确定了可创建首选项实例的最低级别，按从高到低的级别顺序依次为站点和系统&gt;组&gt;角色&gt;用户。</p>
<p>比如系统读取一个保护范围为角色的首选项：</p>
<p>（1）如果当前角色有一个值，就使用这个值；</p>
<p>（2）如果当前角色没有值，但是当前组有值，使用组的值；</p>
<p>（3）如果当前角色和组都没有值，但是站点有值，就用站点的值；</p>
<p>（4）如果当前角色、组、站点都没有值，则没有值使用。</p>
<p>根据保护范围创建首选项：</p>
<p>（1）管理员可以创建所有保护级别的首选项实例，包括站点、组、角色、用户的首选项。站点的首选项，影响到Teamcenter的整个站点，只有管理员可以创建和修改；</p>
<p>（2）组管理员可以创建保护范围为组、角色和用户的实例；</p>
<p>（3）普通用户只能创建保护范围是用户的实例。</p>
<p>站点的首选项，影响到Teamcenter的整个站点。 只有管理员可以创建和修改</p>
<p>例如：TC_show_open_in_nx_button，此首选项用于设置用户是否可以使用NX按钮，即控制用户是否可以在TC客户端中打开NX集成的选项。当值设置为false后，用户不能通过首选项界面添加NX按钮。</p>
<p><strong>3、首选项的使用界面</strong></p>
<p>打开菜单“编辑”，找到“选项”来进行首选项的使用。可以使用典型的首选项，搜索首选项，设置首选项的值，创建新的首选项，删除</p>
<p>已经存在的首选项</p>
<p>可以打开首选项的帮助文档，查看各类首选项的使用方法。</p>
<p><strong>preferences_manager工具</strong></p>
<p>作用：</p>
<p>在新安装TC的时候合并首选项到数据库中，也可以用于TC升级的时候把历史的首选项转换为XML格式，从数据库中导出首选项，检查</p>
<p>TC_DATA目录下的gpfiles/rpfiles/upfiles是否有数据，把这些首选项导入到数据库中，在%TC_ROOT%\bin下：</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nc">Syntax</span><span class="err">：</span>
<span class="n">preferences_manager</span>
<span class="o">-</span><span class="n">u</span><span class="o">=</span><span class="n">user</span><span class="o">-</span><span class="n">name</span>
<span class="o">{-</span><span class="n">p</span><span class="o">=</span><span class="n">password</span> <span class="o">|</span> <span class="o">-</span><span class="n">pf</span><span class="o">=</span><span class="n">password</span><span class="o">-</span><span class="n">file</span><span class="o">}</span>
<span class="o">-</span><span class="n">g</span><span class="o">=</span><span class="n">group</span><span class="o">-</span><span class="n">name</span>
<span class="o">-</span><span class="n">mode</span><span class="o">=</span> <span class="o">{</span><span class="n">append</span> <span class="o">|</span> <span class="n">category</span> <span class="o">|</span> <span class="n">cleanup</span> <span class="o">|</span> <span class="n">cleanup_definitions</span> <span class="o">|</span> <span class="n">clear</span> <span class="o">|</span> <span class="n">export</span> <span class="o">|</span>
<span class="n">generatexml</span> <span class="o">|</span> <span class="kn">import</span> <span class="err">|</span> <span class="nn">migrate</span> <span class="o">|</span> <span class="n">delete</span> <span class="o">|</span> <span class="n">remove</span> <span class="o">|</span> <span class="n">upgradexml</span><span class="o">}</span>
<span class="o">[-</span><span class="n">h</span><span class="o">]</span>
</pre></td></tr></tbody></table></code></div></div>
<p><strong>4、 首选项的相关操作</strong></p>
<p>（1）创建首选项，填写首选项的名称、保护范围、描述、值，选择类别、</p>
<p>环境变量、类型、是否多个值，填写好后单击“保存”按钮</p>
<p>（2）修改首选项，查找到某个首选项后，单击“编辑”按钮，可以对首选项</p>
<p>的相关属性值进行修改。</p>
<p>（3）删除首选项，选择某一个待删除的首选项，单击删除按钮，删除此首</p>
<p>选项</p>
<p><strong>5、 常用首选项举例</strong></p>
<p>下表是在TC系统中设置的常用首选项，通过系统配置，可实现对应的功能，构建站点级别的参数设置。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164050278.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164050278.png" alt="image-20200621164050278" loading="lazy"></a></p>
<p>HiddenPerspectives–隐藏功能模块</p>
<p><strong>AE_dataset_default_keep_limit</strong>数据集保存的版本数量。当超过这</p>
<p>个数值以后，老的版本即被删除。</p>
<h3 id="5-2-3访问权限管理"><span class="me-2">5.2.3访问权限管理</span><a href="#5-2-3访问权限管理" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>1、访问权限
在分布式计算机环境中，对象保护和所有权管理非常重要，对象代表了数据库中的产品信息，TC可执行两个层次的数据保护:基于规则的保护:作为-一个管理员，你可以定义多种条件或规则来控制对对象的访问，这些规则影响TC的整个节点，用访问控制器来定义。</p>
<p>基于对象的保护:可更改对象访问控制权限的任何TC用户都可以设置基于对象的保护ACL (访问控制列表)，来创建基于规则保护外的保护。当需要对具体的对象设置较宽松或较有限的访问权限时，对象的ACL非常有用，访问控制列表ACL显示了当前对一个对象的保护，并允许用户更改这些保护。初始的保护决定于规则树。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164235383.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164235383.png" alt="image-20200621164235383" loading="lazy"></a></p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164245452.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164245452.png" alt="image-20200621164245452" loading="lazy"></a></p>
<p><strong>2、访问管理器</strong>
在访问管理器规则树中来组织规则，并按照该规则在树结构中的位置起作用。TC安装时包括的默认规则树假定只要权限没被显示地拒绝，用户就拥有该访问权限。当应用于所选对象的条件满足时，在ACL中定义的权限将被使用。注意:在规则树中的子分支总是优先于父结构。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164330705.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164330705.png" alt="image-20200621164330705" loading="lazy"></a></p>
<p><strong>创建和管理命名的ACL</strong></p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164343069.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164343069.png" alt="image-20200621164343069" loading="lazy"></a></p>
<p><strong>4、ACL 的优先级控制</strong>
对某一对象有效的ACL是在规则树中适用于该对象的所有命名的ACL的累积组合。ACL的优先级顺序:当判断规则树中的优先级顺序时,
遵守下列方针:</p>
<ul>
<li>子级优先于父级</li>
<li>同级中上层高于下层.</li>
</ul>
<p>评价哪个权限最终被授予取决于两个标准,最终的结果是</p>
<ul>
<li>一个有效的ACL ,控制者对对象的访问。， 规则树中条件声明的优先级别</li>
<li>命名的ACL中的访问者优先级别</li>
</ul>
<p><strong>5、ACL指导方针</strong></p>
<ul>
<li>不要删除或修改规则树中. 上面部分分支的顺序。这可能会导致不可预知的后果或丢失数据。</li>
<li>在Working分支下为工作数据添加规则,这是为工作数据类型添加新规则的最合适的地方。
不要直接修改COTS规则(系统内置设置的规则) , 但是可以创建一个新的规则来代替它。</li>
<li>在作修改前或后需要导出规则树备份。</li>
</ul>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621164534006.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621164534006.png" alt="image-20200621164534006" loading="lazy"></a></p>
<h2 id="第六章"><span class="me-2">第六章</span><a href="#第六章" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>BOM管理是PLM系统管理的核心之一。在产品生命的各个阶段,都有BOM的身影，因此我们必须掌握BOM的二次开发技能，以及对应的业务场景。本教程系列主要用于探讨BOM管理的基本业务，以及围绕BOM管理，可能涉及的开发知识点。
TC报表开发技术</p>
<ul>
<li><p>BOM的概念及类型</p></li>
<li><p>BOM转换方式</p></li>
<li><p>TC报表生成方式</p></li>
<li><p>BOM开发过程</p></li>
<li><p>BOM开发关键技术</p></li>
<li><p>BOM开发技术比较</p></li>
</ul>
<p>BOM的英文全称是Bill Of Material,中文名称是物料清单。BOM是一个比较宽泛的概念，根据不同的场景、用途，BOM又衍生出许多的种类。比如需求BOM、工程BOM、设计BOM、工艺BOM、制造BOM、装配BOM、客户BOM、销售BOM、维修BOM、采购BOM、成本BOM等等，因此BOM是无处不在的。从广义的角度上来说，BOM已经远远超出了物料清单的概念范畴，任何以父子结构呈现的树状数据结构，我们都认为是BOM的- -种表现形式。下图展示的是需求BOM，在Teamcenter 系统中，所有类型的BOM数据,大体上都是这种层级的表现形式。</p>
<p>下面是几种常见的BOM类型，以及他们之间的基本转换进行初步的探讨，不一定适合 所有的行业或业务。
设计BOM:又称工程BOM,主要以产品结构、功能的角度组织数据,通常描述产品的设计指标，零件和零件之间的设计关系。设计BOM-般较少考虑加工工艺、装配工艺等。在设计员的眼中，它是- -件完美的艺术品，至于如何实现，能否实现考虑得较少。同时设计BOM一般会关联三维装配模型。</p>
<p>工艺BOM:在设计BOM的基础之.上，由工艺设计部门根据企业生产工艺的要求，补充相关工艺特性后形成的。工艺BOM除了添加工艺路线、工艺定额等信息外，还可能涉及对设计BOM的结构进行调整，不过这种调整一~般是局部的。但是对于BOM而言，一旦调整结构，那么从调整零部件开始，其所有父级节点，都需要创建新的零部件对象，并重新装配。比如:某些零部件受限于工艺能力，不能完整加工，需要进行拆分加工，然后通过焊接工艺连接在一起，这类业务涉及的自制件，在企业中通常叫”拆件”’;另外有些零部件，从经济性，可加工性的角度考虑，可能需要多个零部件在-起生产，最后通过切割的方式得到设计零部件，这种业务涉及的自制件在企业中通常叫”合件”;工艺BOM大概率会新增原材料、辅料等，这些也会导致BOM结构的调整。</p>
<p>装配BOM:在装配工艺的编制过程中，形成的产品、部组件的装配关系，反应的是装配顺序。比如，在设计上，部组件结构可能是多层BOM组成，但是装配工艺要求在-个装配工位，一次安装完成，这个时候需要将多层设计BOM，调整为单层的装配BOM，部分部组件对象就不体现在装配BOM中。</p>
<p>制造BOM: -般来源于工艺部门编制的工艺卡片上的内容。主要包括零件加工工艺、部组件装配工艺、生产加工中零部件流转路线、以及每个BOM节点上关联的工装、设备、工时等信息。其主要作用是为ERP等软件生产计划等模块提供基础数据。目前大部分的Teamcenter软件并没有直接生成制造BOM，企业主要通过开发与ERP、MES等系统的集成接口，实现按需构建制造BOM，通过中间件的方式，向ERP、MES等系统传递制造BOM数据。因此ERP接口开发、MES接口开发是目前Teamcenter二次开发的重要内容。</p>
<p>在讨论设计BOM、工艺BOM、装配BOM、制造BOM的过程中，BOM转换是客户关注的焦点。不同的行业、不同的企业，由于业务不一样、运营模式不一样、研发体系不-样等等，会导致BOM转换的需求和要求不一样,自然解决方案也不- -样。OOTB系统提供的BOM转换功能，无法满足企业需求，因此需要通过定制开发的方式实现。在探讨BOM开发之前，我们需要简单的了解，为什么需要进行BOM转换。有没有可能一个BOM通吃?如果产品特别简单，或许还是存在这种可能的。但是随着产品复杂度的增加，分工的增加，-套BOM打天下的局面是不可想象的。</p>
<p>BOM转换中，除了拆件、合件，大部分的零部件对象，是不需要转换的。由于绝大部分部组件是新建对象，因此如果需要完整的三维装配模型，需要重新在三维软件中装配。设计BOM转装配BOM-般存在对三维模型的重新装配问题，用于指导三维装配工艺的编制。设计BOM转工艺BOM, - -般不会涉及对三维模型的操作，可以是-一个纯粹的不带三维信息的BOM。主要需要处理拆件、合件，添加原材料、辅料等对象。制造BOM一般由装配BOM、工艺BOM、工艺规程等组合而成，通过集成接口按一定的规则往 下游传递，-般不在Teamcenter系统中创建新的BOM数据。</p>
<p>BOM报表系统既要统计出符合要求的数据，又要使生成的报表符合规定的格式，并且要嵌入Teamcenter系统运行，实现无缝集成。</p>
<h3 id="6-1-3-为什么需要报表开发"><span class="me-2">6.1.3 为什么需要报表开发</span><a href="#6-1-3-为什么需要报表开发" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>每个企业都有自己的特定需求，Teamcenter中有自带的报表的导出方式和模板，TC中自带的报表导出已经不能满足企业的需求。这也是西门子提供二次开发的目的。报表的自动化、个性化生成对企业成功实施PDM系统有着重要意义。尽管TC中程序处理BOM方面功能非常强大，但由于企业内部各类报表都有固定的模版和格式，因此需要掌握BOM报表开发相关知识。.</p>
<h3 id="6-1-4-tc报表生成方式"><span class="me-2">6.1.4 TC报表生成方式</span><a href="#6-1-4-tc报表生成方式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621194046940.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621194046940.png" alt="image-20200621194046940" loading="lazy"></a></p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621194136136.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621194136136.png" alt="image-20200621194136136" loading="lazy"></a></p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621194155240.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621194155240.png" alt="image-20200621194155240" loading="lazy"></a></p>
<p>TC系统为我们提供了两种方式的报表:HTML、XSL
每种报表都有对多国语言支持版本，所以下面对话框中有4个选项，我们选第一个。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621194235529.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621194235529.png" alt="image-20200621194235529" loading="lazy"></a></p>
<p>通过开发生成报表的方法.
在现行的报表开发中，主要有以下三种开发方式:</p>
<ul>
<li>一、Java开发报表导出</li>
<li>二、Java+VBA
<ul>
<li>①导入到特殊格式时,需要打印</li>
<li>②数据量很大的时候，执行效率高</li>
<li>③需要电子签名</li>
</ul></li>
<li>三、C语言编程，EXE文件执行</li>
</ul>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621200117704.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621200117704.png" alt="image-20200621200117704" loading="lazy"></a></p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621200127979.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621200127979.png" alt="image-20200621200127979" loading="lazy"></a></p>
<p><strong>1、POI技术</strong>
POI用法:</p>
<p>Apache POI是用Java编写的免费开源的跨平台的Java API,Apache POI提供API给 Java程式对Mi crosoft 0ffice格式档案读
和写的功能。
Apache POI 是创建和维护操作各种符合Office Open XML(00XML)标准和微软的0LE 2复合文档格式(OLE2) 的Java API,用它可以使用Java读取和创建，修改Microsoft Excel 文件。</p>
<p>POI用法:</p>
<p>Apache POI可以到www. apache. org下载到。实际运行时，需要有POI包即可，Horrible SpreadSheet Format (HSSF) 提供给用户使用的对象在org. apache. poi. hssf. usermode1包中，主要部分包括Exce1对象，样式和格式，还有辅助操作。Excel文件的组织形式: 一个Excel文件对应于-一个workbook (HSSF Workbook) 一 个workbook可以有多个sheet(HSSF Sheet)组成，一个sheet是由多个row (HSSF Row)组成,一个row是由多个cell (HSSF Cell) 组成。</p>
<p>POI用法:
创建一个Excel文件代码解析</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nc">HSSFWorkbook</span> <span class="n">wb</span><span class="o">=</span> <span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//创建WorkBook</span>
<span class="nc">HSSFSheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span> <span class="nf">createSheet</span><span class="o">(</span><span class="err">'</span> <span class="k">new</span> <span class="n">sheet</span><span class="err">'</span> <span class="o">);</span> <span class="c1">//创建Sheet</span>
<span class="nc">HSSFRow</span> <span class="n">row</span><span class="o">=</span> <span class="n">sheet</span><span class="o">.</span> <span class="nf">createRow</span><span class="o">(</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//创建Row</span>
<span class="nc">HSSFCell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span> <span class="nf">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//创建Cell</span>
<span class="n">cell</span><span class="o">.</span> <span class="nf">setCellValue</span><span class="o">(</span><span class="s">"hello Excel"</span><span class="o">);</span> <span class="c1">//写入数据</span>
<span class="nc">File0utputStream</span> <span class="n">file0ut</span><span class="o">=</span><span class="k">new</span>
<span class="nc">File0utputStream</span><span class="o">(</span><span class="err">“</span><span class="nl">c:</span><span class="err">\\</span><span class="n">workbook</span><span class="o">.</span> <span class="n">xls</span><span class="err">"</span> <span class="o">);</span> <span class="c1">//在C盘下建立文件</span>
<span class="n">wb</span><span class="o">.</span> <span class="nf">write</span><span class="o">(</span><span class="n">file0ut</span><span class="o">);</span> <span class="c1">//将信息流写入文件</span>
<span class="n">file0ut</span><span class="o">.</span> <span class="nf">close</span><span class="o">();</span> <span class="c1">//关闭流</span>
</pre></td></tr></tbody></table></code></div></div>
<p>POI用法:
读取一个Excel文件代码解析</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nc">FileInputStream</span> <span class="n">inputStream</span><span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span> <span class="o">(</span><span class="s">" c: \\workbook. xls"</span><span class="o">);</span>
<span class="nc">HSSFWorkbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HSSFWorkbook</span> <span class="o">(</span><span class="n">inputStream</span><span class="o">)</span> <span class="o">;</span><span class="c1">//创建WorkBook</span>
<span class="nc">HSSFSheet</span> <span class="n">sheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span> <span class="nf">getSheet</span><span class="o">(</span><span class="err">'</span> <span class="k">new</span> <span class="n">sheet</span><span class="err">"</span> <span class="o">);</span> <span class="c1">//获取Sheet</span>
<span class="nc">HSSFRow</span> <span class="n">row1</span> <span class="o">=</span> <span class="n">sheet1</span><span class="o">.</span> <span class="nf">getRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//获取Row .</span>
<span class="nc">HSSFCell</span> <span class="n">cel11</span> <span class="o">=</span> <span class="n">row1</span><span class="o">.</span> <span class="nf">getCe11</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//获取第-一个单元格</span>
<span class="nc">String</span> <span class="n">cellValue1</span> <span class="o">=</span> <span class="n">ce111</span><span class="o">.</span> <span class="nf">getStringCel1Value</span><span class="o">(</span> <span class="o">);</span> <span class="c1">//获取单元格的值有关POI</span>
</pre></td></tr></tbody></table></code></div></div>
<p>的详细用法，请登录到以下网址:
<a href="http://poi. apache. org/">http://poi. apache. org/</a></p>
<p>2.使用BOM类创建BOM结构</p>
<p>我们主要使用以下几个类读取BOM结构:</p>
<p>TCComponentBOMWindowType、TCComponentBOM Window、TCComponentRevisionRule、TCComponentBOMLine。</p>
<p>(1)创建BomWindow对象</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentBOMWindowType</span> <span class="n">type</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentBOMWindowType</span><span class="o">)</span>
<span class="n">tcSession</span><span class="o">.</span><span class="na">getTypeComponent</span><span class="o">(</span><span class="s">"BOMWindow"</span><span class="o">);</span>
<span class="n">bomWindow</span> <span class="o">=</span> <span class="n">type</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span> <span class="c1">//使用默认的版本规则</span>
</pre></td></tr></tbody></table></code></div></div>
<p>(2)设置版本规则
如果不使用默认的版本规则，需要替换其他版本规则的话，比如以下就是使用”Latest Working”版本规则。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>    <span class="nc">TCComponentRevisionRuleType</span> <span class="n">ruleType</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentRevisionRuleType</span><span class="o">)</span>
    <span class="n">tcSession</span><span class="o">.</span> <span class="nf">getTypeComponent</span><span class="o">(</span><span class="s">"RevisionRule"</span><span class="o">);</span>
    <span class="nc">TCComponent</span><span class="o">[]</span> <span class="n">rules</span> <span class="o">=</span> <span class="n">ruleType</span><span class="o">.</span><span class="na">extent</span><span class="o">();</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">inti</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span> <span class="n">rules</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span> <span class="o">{</span> <span class="o">.</span>
    <span class="nc">String</span> <span class="n">ruleName</span> <span class="o">=</span> <span class="n">rules</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"object name"</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="s">"Latest Working"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">ruleName</span><span class="o">)){</span>
    <span class="nc">TCComponentRevisionRule</span> <span class="n">rule</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentRevisionRule</span><span class="o">)</span> <span class="n">rules</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="n">bomWindow</span><span class="o">.</span> <span class="nf">setRevisionRule</span><span class="o">(</span><span class="n">rule</span><span class="o">);</span>
    <span class="k">break</span><span class="o">;</span> <span class="o">}</span>
    <span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>(3)加载顶层BOM行</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">topBomline</span> <span class="o">=</span> <span class="n">bomWindow</span><span class="o">.</span><span class="na">setWindowTopLine</span><span class="o">(</span><span class="n">topRevision</span><span class="o">.</span><span class="na">getItem</span><span class="o">(),</span><span class="n">topRevision</span><span class="o">,</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
<span class="n">topBomline</span><span class="o">.</span><span class="na">pack</span><span class="o">();</span> <span class="o">.</span>
</pre></td></tr></tbody></table></code></div></div>
<p><strong>BOM数据来源</strong>
TC BOM表中需要提取的信息可分为三部分:</p>
<p>第一类信息是在PSE的BOMLine属性中的，这是BOMLine的固有属性，如bl_ item_ object_ name表明当前BOMLine的Item
的名称，bl_ _quantity表明当前BOMLine的数量属性等，这些在PSE中可以进行添加或者修改;
第二部分信息是BOMLine所对应的零/部件版本( Item、ItemRevision)本身的属性，如Owning User、date等，这些信息可以通过getProperty( )函数获得其值。</p>
<p>第三部分信息存在于BOMLine所对应的Item Revision的Master Form表中，当用缺省的Item类型创建-一个零部件时，在查看器中显示的项目id、系列号等就属于Master Form表的信息,可以在浏览器中查看或者修改。要提取Master Form中包含的信息，首先必须通过BOML ine获取对应的Item Revision,然后通过Item Revision获取Master Form,最后通过此Form的getProperty( )方法来获得其Master Form的属性。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nc">TCComponentBOMLine</span> <span class="n">bomline</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentBOMLine</span><span class="o">)</span>
<span class="n">bomlineelement</span><span class="o">(</span> <span class="o">);</span>
<span class="nc">TCComponentItemRevision</span> <span class="n">irev</span> <span class="o">=</span> <span class="o">(</span> <span class="nc">TCComponentItemRevision</span><span class="o">)</span>
<span class="nc">Bomline</span><span class="o">.</span><span class="na">getItemRevision</span><span class="o">(</span> <span class="o">);</span>
<span class="o">/</span> <span class="o">/</span><span class="n">通过BOMLine获取对应的Item</span> <span class="nc">Revision</span>
<span class="nc">AIFComponentContext</span> <span class="o">[</span> <span class="o">]</span> <span class="n">irm</span><span class="o">=</span> <span class="n">irev</span><span class="o">.</span><span class="na">getChildren</span><span class="o">(</span> <span class="no">IMAN</span> <span class="n">master</span> <span class="n">form_</span> <span class="n">rev</span><span class="o">);</span>
<span class="o">/</span> <span class="o">/</span><span class="n">通过Item</span> <span class="nc">Revision获取Master</span> <span class="nc">Form</span>
<span class="nc">TCComponentForm</span> <span class="n">mf</span> <span class="o">=</span> <span class="o">(</span> <span class="nc">TCComponentForm</span><span class="o">)</span> <span class="n">irm</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">getComponent</span><span class="o">(</span> <span class="o">);</span>
<span class="nc">String</span> <span class="n">serial_</span> <span class="n">number</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"user_ data_ 1"</span><span class="o">).</span><span class="na">toString</span><span class="o">(</span> <span class="o">);</span>
<span class="mi">1</span> <span class="o">/</span><span class="n">getProperty</span><span class="o">(</span> <span class="o">)</span><span class="n">方法来获得其Master</span> <span class="nc">Form的属性</span>
</pre></td></tr></tbody></table></code></div></div>
<p>要进行BOM汇总必须对PSE中的产品结构进行遍历，遍历BOM有两种递归方式:深度优先遍历算法(BFS)和广度优先遍历算法（DFS）</p>
<p>深度优先遍历算法(BFS)以产品结构树中的零/部件是否有子件为递归条件，充分展现了零/部件间的层次关系和BOM树的结构。该算法的优点是程序简单，但由于是递归调用，涉及到堆栈的操作，在进行深层次遍历时，系统消耗的资源会很大。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nl">程序代码逻辑:</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">BomBFS</span><span class="o">(</span><span class="nc">TCComponentBOMLine</span>
<span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
<span class="c1">//优先遍历</span>
<span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">hasChildren</span><span class="o">()</span> <span class="o">{</span>
<span class="nc">AlFComponentContext</span><span class="o">[</span> <span class="n">children</span> <span class="o">=</span>
<span class="n">parent</span><span class="o">.</span><span class="na">getChildren</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="n">inti</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">children</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
<span class="nc">InterfaceAlFComponent</span> <span class="n">tcComp</span> <span class="o">=</span>
<span class="n">children</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getComponent</span><span class="o">();</span>
<span class="nc">TCComponentBOML</span> <span class="n">ine</span> <span class="n">childBomline</span> <span class="o">=</span>
<span class="o">(</span><span class="nc">TCComponentBOML</span> <span class="n">ine</span><span class="o">)</span> <span class="n">tcComp</span><span class="o">;</span>
<span class="nc">BomBFS</span><span class="o">(</span><span class="n">childBomline</span><span class="o">)</span>
<span class="o">}</span>
<span class="o">}</span> <span class="c1">// 处理业务逻辑</span>
<span class="o">}..</span>
</pre></td></tr></tbody></table></code></div></div>
<p>广度优先遍历算法(DFS)首先访问层次数为0的根节点，然后访问层次数为1的所有节点，依次逐层往下遍历直到访问完最后一层的所有节点。</p>
<p>程序代码逻辑:</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="kd">private</span> <span class="kt">void</span> <span class="nf">BomDFS</span><span class="o">(</span><span class="nc">TCComponentBOMLine</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
<span class="nc">AIFComponentContext0</span> <span class="n">children</span> <span class="o">=</span>
<span class="n">parent</span><span class="o">.</span><span class="na">getChildren</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">children</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span> <span class="c1">// 优先处理单层BOM业务逻辑</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">children</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="nc">InterfaceAlFComponent</span> <span class="n">tcComp</span> <span class="o">=</span>
<span class="n">children</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getComponent</span><span class="o">();</span>
<span class="nc">TCComponentBOMLine</span> <span class="n">childBomline</span> <span class="o">=</span>
<span class="o">(</span><span class="nc">TCComponentBOMLine</span><span class="o">)</span> <span class="n">tcComp</span><span class="o">;</span>
<span class="o">}</span> <span class="c1">//下面开始遍历</span>
<span class="k">for</span> <span class="o">(</span><span class="n">inti</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">children</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
<span class="nc">InterfaceAlFComponent</span> <span class="n">tcComp</span> <span class="o">=</span>
<span class="n">children</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getComponent</span><span class="o">();</span>
<span class="nc">TCComponentBOML</span> <span class="n">ine</span> <span class="n">childBomline</span> <span class="o">=</span>
<span class="o">(</span><span class="nc">TCComponentBOMLine</span><span class="o">)</span> <span class="n">tcComp</span><span class="o">;</span>
<span class="nc">BomDFS</span><span class="o">(</span><span class="n">childBomline</span><span class="o">)</span>
<span class="o">}</span>
<span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p><strong>BOM遍历算法</strong>
鉴于BOM汇总是由各项目下的子类逐层向父类归并的情况，同时考虑到企业的BOM汇总中明细表项目较多、层次较浅(- -般为3~ 4层)的特点，本文BOM开发采用深度优先遍历算法，由( TCComponentBOMLine )aifcomponentcontexts[0].getComponent( )获取选定的根节点，利用getChildren( )的方法获取根的子节点，对于每-一个子节点重复利用函数getChildren( )的方法获得其子组件，如此循环下去直到没有子节点，完成BOM的遍历。</p>
<p>由于事先无法预知BOM汇总中零/部件的具体数量，所以可以用数组来容纳所汇总的零/部件信息是不现实的，而且数组-般只能存放-种类型的数据，而在产品信息中数据类型显然不能是单一的，因此采用Vector类来解决汇总过程中的数据存放问题。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621200906710.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621200906710.png" alt="image-20200621200906710" loading="lazy"></a></p>
<p>操作步骤:
获取Teamcenter数据，以获取Teamcenter中 Item的属性为例。
Step1.获取Item，</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">TCComponent</span><span class="o">[</span> <span class="o">]</span> <span class="n">getItem</span> <span class="o">(</span><span class="nc">String</span><span class="o">[</span> <span class="o">]</span><span class="n">names</span><span class="o">,</span> <span class="nc">String</span> <span class="o">[</span> <span class="o">]</span><span class="n">values</span><span class="err">，</span> <span class="nc">String</span>
<span class="n">queryname</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">TCException</span>
<span class="nc">TCSession</span> <span class="n">session</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCSession</span><span class="o">)</span> <span class="nc">AIFUtility</span><span class="o">.</span> <span class="nf">getDefaultSession</span><span class="o">()</span> <span class="o">;</span>
<span class="nc">TCComponentQueryType</span> <span class="n">querytype</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentQueryType</span><span class="o">)</span>
<span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="err">"</span> <span class="nc">ImanQuery</span><span class="err">'</span> <span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentQuery</span> <span class="n">query</span> <span class="o">=(</span><span class="nc">TCComponentQuery</span><span class="o">)</span> <span class="n">querytype</span><span class="o">.</span> <span class="nf">find</span> <span class="o">(</span><span class="n">queryname</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCQueryClause</span><span class="o">[]</span> <span class="nc">Clause</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span> <span class="nf">describe</span><span class="o">()</span> <span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">names</span><span class="o">.</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="nc">Clause</span><span class="o">.</span> <span class="n">length</span><span class="o">;</span> <span class="n">m</span><span class="o">++)</span> <span class="o">{</span>
<span class="k">if</span> <span class="o">(</span><span class="n">names</span> <span class="o">[</span><span class="n">i</span><span class="o">].</span> <span class="nf">equals</span> <span class="o">(</span><span class="nc">Clause</span> <span class="o">[</span><span class="n">m</span><span class="o">].</span> <span class="nf">getUserEntryName</span> <span class="o">())</span> <span class="o">{</span>
<span class="n">names</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="nc">Clause</span> <span class="o">[</span><span class="n">m</span><span class="o">].</span> <span class="n">getUserEntryNameDisplay</span>
<span class="k">break</span><span class="o">;</span>
<span class="o">}</span>
<span class="o">}</span>
<span class="k">return</span> <span class="n">query</span><span class="o">.</span> <span class="nf">execute</span> <span class="o">(</span><span class="n">names</span><span class="err">，</span><span class="n">values</span><span class="o">)</span> <span class="o">;</span>
</pre></td></tr></tbody></table></code></div></div>
<p>2-获取Item的属性。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span><span class="o">[</span> <span class="o">]</span> <span class="n">getProperties</span> <span class="o">(</span><span class="nc">TCComponentItem</span> <span class="n">item</span><span class="o">,</span> <span class="nc">String</span> <span class="o">[</span> <span class="o">]</span> <span class="n">properties</span><span class="o">)</span> <span class="o">{</span>
<span class="nc">String</span> <span class="o">[</span> <span class="o">]</span> <span class="n">values</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
<span class="n">values</span><span class="o">=</span><span class="n">i</span> <span class="n">tem</span><span class="o">.</span> <span class="nf">getProperties</span> <span class="o">(</span><span class="n">properties</span><span class="o">)</span> <span class="o">;</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
<span class="n">e</span><span class="o">.</span> <span class="nf">printStackTrace</span> <span class="o">()</span> <span class="o">;</span>
<span class="k">return</span> <span class="n">values</span> <span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>3.在Teamcenter NewStuff下新建文件夹用于存放文件。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">TCComponentFolder</span> <span class="nf">getFolder</span> <span class="o">(</span><span class="nc">String</span> <span class="n">foldername</span><span class="o">)</span> <span class="o">{</span>
<span class="nc">TCSession</span>
<span class="n">session</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TCSession</span><span class="o">)</span> <span class="nc">AIFUtility</span><span class="o">.</span> <span class="nf">getDefaultSession</span><span class="o">()</span> <span class="o">;</span>
<span class="nc">TCComponentFolder</span> <span class="n">newStuff</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="nc">TCComponentFolder</span> <span class="n">newFolder</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">newStuff</span><span class="o">=</span><span class="nc">TCComponentFolder</span><span class="o">.</span> <span class="nf">getNewStuffFolder</span> <span class="o">(</span><span class="n">session</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">TCComponentFolderType</span> <span class="n">createFolderType</span>
<span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentFol</span> <span class="n">derType</span><span class="o">)</span> <span class="n">session</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="s">" Folder"</span><span class="o">)</span> <span class="o">;</span>
<span class="n">newFolder</span><span class="o">=</span><span class="n">createFolderType</span><span class="o">.</span> <span class="nf">create</span> <span class="o">(</span><span class="n">foldername</span><span class="err">，</span><span class="s">""</span><span class="err">，</span> <span class="err">”</span> <span class="nc">Folder</span><span class="s">") ;
newStuff. add("</span> <span class="n">contents</span><span class="err">"，</span><span class="n">newFolder</span><span class="o">)</span> <span class="o">;</span>
<span class="k">return</span> <span class="n">newFolder</span> <span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Step4:把i tem属性写入C:\temp路径下的temp. xls中。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">writeToExcel</span><span class="o">(</span><span class="nc">String</span><span class="o">[</span> <span class="n">properties</span><span class="o">){</span>
<span class="nc">FileOutputStream</span> <span class="n">fos</span><span class="o">=</span> <span class="o">=</span><span class="kc">null</span><span class="o">;</span>
<span class="nc">HSSFWorkbook</span> <span class="n">xlss</span> <span class="o">=</span><span class="k">new</span> <span class="no">HSS</span> <span class="no">FW</span> <span class="nf">orkbook</span><span class="o">(;</span>
<span class="nc">HSSFSheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">xlss</span><span class="o">.</span><span class="na">createSheet0</span><span class="o">;</span>
<span class="no">HSS</span> <span class="nc">FRow</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">setCellValuet</span><span class="o">(</span><span class="s">"item_ id"</span><span class="o">);</span>
<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span> <span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"object_ name"</span><span class="o">);</span>
<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCelIValue</span><span class="o">(</span><span class="s">"creation_ date"</span><span class="o">);</span>
<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span> <span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"current_ id"</span><span class="o">);</span>
<span class="nc">HSSFRow</span> <span class="n">row1</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">row1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">properties</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
<span class="n">row</span> <span class="mi">1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">properties</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
<span class="n">row</span> <span class="mi">1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">properties</span><span class="o">[</span><span class="mi">2</span><span class="o">]);</span>
<span class="n">row</span> <span class="mi">1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">properties</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
<span class="nc">File</span> <span class="n">xls_</span> <span class="n">file</span><span class="o">=</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">tempfile</span><span class="o">);</span> <span class="mi">1</span><span class="o">/</span><span class="n">指定写</span> <span class="n">入路径</span>
<span class="n">fos</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">xls_</span> <span class="n">file</span><span class="o">);</span>
<span class="n">xlss</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fos</span><span class="o">);</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Step5:将建立的临时excel文件导入到TC中。</p>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">TCComponentDataset</span> <span class="nf">createDataset</span> <span class="o">(</span><span class="nc">TCSession</span> <span class="n">session</span><span class="o">,</span> <span class="nc">String</span> <span class="n">path</span><span class="o">,</span>
<span class="nc">String</span> <span class="n">dType</span><span class="err">，</span> <span class="nc">String</span> <span class="n">dRef</span><span class="err">，</span><span class="nc">String</span> <span class="n">dName</span><span class="err">，</span><span class="nc">TCComponentFolder</span> <span class="n">folder</span><span class="o">,</span> <span class="kt">boolean</span>
<span class="n">replaceA1ert</span><span class="o">)</span>
<span class="o">{</span>
<span class="nc">TCComponentDataset</span> <span class="n">datasetcomponent</span> <span class="n">nul1</span> <span class="o">;</span>
<span class="nc">TCComponentDatasetType</span> <span class="nc">TCDatasetType</span><span class="o">=</span> <span class="o">(</span><span class="nc">TCComponentDatasetType</span><span class="o">)</span>
<span class="n">typeService</span><span class="o">.</span> <span class="nf">getTypeComponent</span> <span class="o">(</span><span class="n">datasetType</span><span class="o">)</span> <span class="o">;</span>
<span class="nc">String</span> <span class="n">filepathnames</span><span class="o">[]=</span> <span class="o">{</span><span class="n">path</span><span class="o">}</span> <span class="o">;</span>
<span class="nc">String</span> <span class="n">nameRefs</span> <span class="o">[]=</span> <span class="o">{</span><span class="n">dRef</span><span class="o">};</span>
<span class="n">datasetcomponent</span><span class="o">=</span><span class="nc">TCDatasetType</span><span class="o">.</span> <span class="nf">setFiles</span> <span class="o">(</span><span class="n">dName</span><span class="err">，</span><span class="kc">null</span><span class="err">，</span> <span class="n">dType</span><span class="o">,</span> <span class="n">filepathnames</span><span class="o">,</span>
<span class="n">nameRefs</span><span class="o">)</span> <span class="o">;</span>
<span class="n">folder</span><span class="o">.</span> <span class="nf">add</span><span class="o">(</span><span class="err">"</span> <span class="n">contents</span><span class="err">'，</span><span class="n">datasetcomponent</span><span class="o">)</span> <span class="o">;</span>
<span class="k">return</span> <span class="n">datasetcomponent</span> <span class="o">;</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Step6: 创建报表的界面。</p>
<p><a href="/assets/杂七杂八/杂七杂八/TC/image-20200621201516481.png" class="popup img-link  shimmer"><img src="/assets/杂七杂八/杂七杂八/TC/image-20200621201516481.png" alt="image-20200621201516481" loading="lazy"></a></p>
<p>Step7: 生成的临时文件。
Step8: TC中创建的报表。</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;?eclipse version="3.6"?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.commands"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;command</span>
                 <span class="na">name=</span><span class="s">"Sample Command"</span>
                 <span class="na">id=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/command&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.handlers"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;handler</span>
                 <span class="na">commandId=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span>
                 <span class="na">class=</span><span class="s">"com.mycom.addbutton.handlers.SampleHandler"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/handler&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
    <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">"org.eclipse.ui.menus"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;menuContribution</span>
                          <span class="na">locationURI=</span><span class="s">"toolbar:navigator_Toolbar?after=additions"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;command</span>
                     <span class="na">commandId=</span><span class="s">"com.mycom.addbutton.commands.sampleCommand"</span>
                     <span class="na">icon=</span><span class="s">"icons/sample.gif"</span>
                     <span class="na">tooltip=</span><span class="s">"Say hello world"</span>
                     <span class="na">id=</span><span class="s">"com.mycom.addbutton.toolbars.sampleCommand"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;visibleWhen&gt;</span>
                    <span class="nt">&lt;reference</span>
                               <span class="na">definitionId=</span><span class="s">"com.teamcenter.rac.ui.inMainPerspective"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;/reference&gt;</span>
                <span class="nt">&lt;/visibleWhen&gt;</span>
            <span class="nt">&lt;/command&gt;</span>
        <span class="nt">&lt;/menuContribution&gt;</span>
    <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Teamcenter%E5%AD%A6%E4%B9%A0%20-%20Allen&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fteamcenter%25E5%25AD%25A6%25E4%25B9%25A0%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Teamcenter%E5%AD%A6%E4%B9%A0%20-%20Allen&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fteamcenter%25E5%25AD%25A6%25E4%25B9%25A0%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fteamcenter%25E5%25AD%25A6%25E4%25B9%25A0%2F&text=Teamcenter%E5%AD%A6%E4%B9%A0%20-%20Allen" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/teamcenter%E5%AD%A6%E4%B9%A0/">Teamcenter学习</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">JEKYLL</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->

























            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/jEKYLL%E4%BD%BF%E7%94%A8/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Jekyll::Compose</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2023</time>
    <a href="https://twitter.com/username">AllenXDong</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">JEKYLL</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/zh.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

